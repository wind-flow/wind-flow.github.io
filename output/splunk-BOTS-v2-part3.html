<!DOCTYPE html>
<html>
<head>

    <!-- Document Settings -->
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <!-- Base Meta -->
    <!-- dynamically fixing the title for tag/author pages -->



    <title>splunk-bots-v2 write up(3)</title>
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- Styles'n'Scripts -->
    <link rel="stylesheet" type="text/css" href="/assets/built/screen.css" />
    <link rel="stylesheet" type="text/css" href="/assets/built/screen.edited.css" />
    <link rel="stylesheet" type="text/css" href="/assets/built/syntax.css" />

    <!-- custom.css -->
    <link rel="stylesheet" type="text/css" href="/assets/built/custom.css" />

    <!-- 웹 폰트 설정 -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/earlyaccess/nanumgothic.css">

    <!-- awesome icon -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

    <!-- syntax.css -->
    <link rel="stylesheet" href="/assets/built/syntax.css">

    <!-- highlight.js -->
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css">
    <style>.hljs { background: none; }</style>

    <!--[if IE]>
        <style>
            p, ol, ul{
                width: 100%;
            }
            blockquote{
                width: 100%;
            }
        </style>
    <![endif]-->
    
    <!-- This tag outputs SEO meta+structured data and other important settings -->
    <meta name="description" content="wind-flow Tech Blog" />
    <link rel="shortcut icon" href="https://wind-flow.github.io/assets/built/images/wind-flow.png" type="image/png" />
    <link rel="canonical" href="https://wind-flow.github.io/splunk-BOTS-v2-part3" />
    <meta name="referrer" content="no-referrer-when-downgrade" />

     <!--title below is coming from _includes/dynamic_title-->
    <meta property="og:site_name" content="wind-flow Tech Blog" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="splunk-bots-v2 write up(3)" />
    <meta property="og:description" content="Splunk BOTS의 데이터셋은 3개입니다. BOTS란? BOTS v1 Write up(1) BOTS v1 Write up(2) - END BOTS v2 Write up(1) BOTS v2 Write up(2) BOTS v2 Write up(3) BOTS v2 Write up(4) BOTS v2 Write up(5) - END BOTS v3 Write up(1) BOTS v3 Write up(2) BOTS v3 Write up(3) BOTS" />
    <meta property="og:url" content="https://wind-flow.github.io/splunk-BOTS-v2-part3" />
    <meta property="og:image" content="https://wind-flow.github.io/assets/built/images/splunk/bots/v2/bots-v2.jpg" />
    <meta property="article:publisher" content="https://www.facebook.com/" />
    <meta property="article:author" content="https://www.facebook.com/" />
    <meta property="article:published_time" content="2021-10-04T20:04:36+09:00" />
    <meta property="article:modified_time" content="2021-10-04T20:04:36+09:00" />
    <meta property="article:tag" content="Splunk" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="splunk-bots-v2 write up(3)" />
    <meta name="twitter:description" content="Splunk BOTS의 데이터셋은 3개입니다. BOTS란? BOTS v1 Write up(1) BOTS v1 Write up(2) - END BOTS v2 Write up(1) BOTS v2 Write up(2) BOTS v2 Write up(3) BOTS v2 Write up(4) BOTS v2 Write up(5) - END BOTS v3 Write up(1) BOTS v3 Write up(2) BOTS v3 Write up(3) BOTS" />
    <meta name="twitter:url" content="https://wind-flow.github.io/" />
    <meta name="twitter:image" content="https://wind-flow.github.io/assets/built/images/splunk/bots/v2/bots-v2.jpg" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="wind-flow Tech Blog" />
    <meta name="twitter:label2" content="Filed under" />
    <meta name="twitter:data2" content="Splunk" />
    <meta name="twitter:site" content="@" />
    <meta name="twitter:creator" content="@" />
    <meta property="og:image:width" content="1400" />
    <meta property="og:image:height" content="933" />

    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Website",
    "publisher": {
        "@type": "Organization",
        "name": "wind-flow Tech Blog",
        "logo": "https://wind-flow.github.io/"
    },
    "url": "https://wind-flow.github.io/splunk-BOTS-v2-part3",
    "image": {
        "@type": "ImageObject",
        "url": "https://wind-flow.github.io/assets/built/images/splunk/bots/v2/bots-v2.jpg",
        "width": 2000,
        "height": 666
    },
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://wind-flow.github.io/splunk-BOTS-v2-part3"
    },
    "description": "Splunk BOTS의 데이터셋은 3개입니다. BOTS란? BOTS v1 Write up(1) BOTS v1 Write up(2) - END BOTS v2 Write up(1) BOTS v2 Write up(2) BOTS v2 Write up(3) BOTS v2 Write up(4) BOTS v2 Write up(5) - END BOTS v3 Write up(1) BOTS v3 Write up(2) BOTS v3 Write up(3) BOTS"
}
    </script>

    <!-- <script type="text/javascript" src="https://demo.ghost.io/public/ghost-sdk.min.js?v=724281a32e"></script>
    <script type="text/javascript">
    ghost.init({
    	clientId: "ghost-frontend",
    	clientSecret: "f84a07a72b17"
    });
    </script> -->

    <meta name="generator" content="Jekyll 3.6.2" />
    <link rel="alternate" type="application/rss+xml" title="splunk-bots-v2 write up(3)" href="/feed.xml" />


</head>
<body class="post-template">

    <div class="site-wrapper">
        <!-- All the main content gets inserted here, index.hbs, post.hbs, etc -->
        <!-- default -->

<!-- The tag above means: insert everything in this file
into the {body} of the default.hbs template -->

<header class="site-header outer">
    <div class="inner">
        <nav class="site-nav">
    <div class="site-nav-left">
        
            
                <a class="site-nav-logo" href="https://wind-flow.github.io/">wind-flow Tech Blog</a>
            
        
        
            <ul class="nav" role="menu">
  <li class="nav-home" role="menuitem"><a href="/">Home</a></li>
  <li class="nav-about" role="menuitem">
    <a href="/about/">About</a>
  </li>
  <li class="nav-splunk" role="menuitem">
    <a href="/tag/splunk/">splunk</a>
  </li>
  <!-- <li class="nav-python" role="menuitem"><a href="/tag/python/">Python</a></li> -->
  <li class="nav-archive" role="menuitem">
    <a href="/archive.html">All Posts</a>
  </li>
  <li class="nav-archive" role="menuitem">
    <a href="/author_archive.html">Tag별 Posts</a>
  </li>
</ul>

        
    </div>
    <div class="site-nav-right">
        <div class="social-links">
            
            
        </div>
        
            <a class="subscribe-button" href="#subscribe">search</a>
        
    </div>
</nav>

    </div>
</header>

<!-- Everything inside the #post tags pulls data from the post -->
<!-- #post -->

<main id="site-main" class="site-main outer" role="main">
    <div class="inner">

        <article class="post-full  tag-splunk post tag-splunk ">

            <header class="post-full-header">
                <section class="post-full-meta">
                    <time class="post-full-meta-date" datetime=" 4 October 2021"> 4 October 2021</time>
                    
                        <span class="date-divider">/</span>
                        
                            
                               <a href='/tag/splunk/'>SPLUNK</a>
                            
                        
                    
                </section>
                <h1 class="post-full-title">splunk-bots-v2 write up(3)</h1>
            </header>

            <!-- 
            <figure class="post-full-image" style="background-image: url(/assets/built/images/splunk/bots/v2/bots-v2.jpg)">
            </figure>
             -->

            <section class="post-full-content">
                <div class="kg-card-markdown">
                    <p><span class="table-of-contents-list">Splunk BOTS의 데이터셋은 3개입니다.</span></p>
<ul class="table-of-contents-list">
  <li><a href="./splunk-BOTS-overview">BOTS란? </a></li>
  <li><a href="./splunk-BOTS-v1-part1">BOTS v1 Write up(1)</a></li>
  <li><a href="./splunk-BOTS-v1-part2">BOTS v1 Write up(2) - END</a></li>
  <li><a href="./splunk-BOTS-v2-part1">BOTS v2 Write up(1) </a></li>
  <li><a href="./splunk-BOTS-v2-part2">BOTS v2 Write up(2) </a></li>
  <li><a href="./splunk-BOTS-v2-part3">BOTS v2 Write up(3) </a></li>
  <li><a href="./splunk-BOTS-v2-part4">BOTS v2 Write up(4) </a></li>
  <li><a href="./splunk-BOTS-v2-part5">BOTS v2 Write up(5) - END</a></li>
  <li><a href="./splunk-BOTS-v3-part1">BOTS v3 Write up(1)</a></li>
  <li><a href="./splunk-BOTS-v3-part2">BOTS v3 Write up(2)</a></li>
  <li><a href="./splunk-BOTS-v3-part3">BOTS v3 Write up(3)</a></li>
  <li><a href="./splunk-BOTS-v3-part4">BOTS v3 Write up(4) - END</a></li>
  <li><a href="./splunk-2021-BOTS-END">BOTS v4 결과</a></li>
</ul>

<p>APT Scenarios:</p>

<p>In this hands-on exercise, you assume the persona of Alice Bluebird, the analyst who successfully assisted Wayne Enterprises and was recommended to Grace Hoppy at Frothly to assist them with their recent issues.<br />
이 실습에서는 Wayne Enterprises를 성공적으로 지원하고 Frothly의 Grace Hoppy에게 최근 문제를 지원하도록 추천된 분석가 Alice Bluebird의 페르소나를 가정합니다.</p>

<p>Hunting Scenarios:</p>

<p>PowerShell: Adversaries will use PowerShell Empire to establish a foothold and carry out attacks.<br />
PowerShell: 적들은 PowerShell Empire를 사용하여 거점을 구축하고 공격을 수행합니다.<br />
Exfiltration Over Alternative Protocol - FTP: Data Exfiltration may occur using common network protocols, principally FTP<br />
Exfiltration Over Alternative Protocol - FTP: 데이터 유출은 주로 FTP와 같은 일반적인 네트워크 프로토콜을 사용하여 발생할 수 있습니다.<br />
Exfiltration Over Alternative Protocol - DNS: Data Exfiltration may occur using common network protocols, specifically DNS<br />
Exfiltration Over Alternative Protocol - DNS: 데이터 유출은 일반적인 네트워크 프로토콜, 특히 DNS를 사용하여 발생할 수 있습니다.<br />
Adversary Infrastructure: The adversary has established multiple components of infrastructure beyond what we have already uncovered.<br />
Adversary Infrastructure: 적군은 우리가 이미 밝혀낸 것 이상의 기반 시설의 여러 구성 요소를 구축했습니다.<br />
Spearphishing Attachment: Adversaries will attempt to establish a foothold within Froth.ly using Phishing.<br />
Spearphishing Attachment: 적들은 피싱을 사용하여 Froth.ly 내에 거점을 구축하려고 시도합니다.<br />
User Execution: Adversaries will attempt to establish a foothold within Froth.ly by enticing a user to execute an action on a file.<br />
User Execution: 공격자는 사용자가 파일에 대해 작업을 실행하도록 유인하여 Froth.ly 내에서 거점을 설정하려고 시도합니다.<br />
Persistence - Create Account: An adversary will look to maintain persistence across an enterprise by creating user accounts.<br />
Persistence - Create Account: 공격자는 사용자 계정을 생성하여 기업 전체에서 지속성을 유지하려고 합니다.<br />
Persistence - Scheduled Task: An adversary will look to maintain persistence across reboots by using a task scheduler.<br />
Persistence - Scheduled Task: 공격자는 작업 스케줄러를 사용하여 재부팅 시 지속성을 유지하려고 합니다.<br />
Indicator Removal On Host: Clearing of audit / event logs could indicate an adversary attempting to cover their tracks.<br />
Indicator Removal On Host: 감사/이벤트 로그를 지우면 공격자가 자신의 흔적을 덮으려는 것을 나타낼 수 있습니다.<br />
Reconaissance: User Agent Strings may provide insight into an adversary that they may not have intended to show.<br />
Reconaissance: 사용자 에이전트 문자열은 의도하지 않은 적에 대한 통찰력을 제공할 수 있습니다.
OSINT: Identifying publicly available company information and who is accessing it may provide insight into the adversary.<br />
OSINT: 공개적으로 사용 가능한 회사 정보와 해당 정보에 액세스하는 사람을 식별하면 적에 대한 통찰력을 제공할 수 있습니다.<br />
Lateral Movement: Adversaries will look to move laterally to other systems using Windows Management Instrumentation (WMI).<br />
Lateral Movement: 공격자는 WMI(Windows Management Instrumentation)를 사용하여 측면으로 다른 시스템으로 이동합니다.<br />
Data Staging: Adversaries will stage data prior to exfiltration to make it easier to extract data at a time of their choosing as well as have a central place to place information as it is identified.<br />
Data Staging: 공격자는 데이터 유출 전에 데이터를 준비하여 원하는 시간에 데이터를 쉽게 추출할 수 있을 뿐만 아니라 식별된 정보를 배치할 중앙 위치를 확보합니다.</p>

<p><img src="https://wind-flow.github.io/assets/built/images/splunk/bots/v2/b21.jpg" alt="Scenario 1" /></p>

<p>The data included in this app was generated in August of 2017 by members of Splunk’s Security Specialist team - Dave Herrald, Ryan Kovar, Steve Brant, Jim Apger, John Stoner, Ken Westin, David Veuve and James Brodsky. They stood up a few lab environments connected to the Internet. Within the environment they had a few Windows endpoints instrumented with the Splunk Universal Forwarder and Splunk Stream. The forwarders were configured with best practices for Windows endpoint monitoring, including a full Microsoft Sysmon deployment and best practices for Windows Event logging. The environment included a Palo Alto Networks next-generation firewall to capture traffic and provide web proxy services, and Suricata to provide network-based IDS. This resulted in the dataset below.<br />
이 앱에 포함된 데이터는 2017년 8월 Splunk의 보안 전문가 팀(Dave Herrald, Ryan Kovar, Steve Brant, Jim Apger, John Stoner, Ken Westin, David Veuve 및 James Brodsky)이 생성한 것입니다. 그들은 인터넷에 연결된 몇 개의 실험 환경을 구축했습니다. 환경 내에는 Splunk Universal Forwarder 및 Splunk Stream으로 계측된 몇 개의 Windows 엔드포인트가 있었습니다. Forwarder는 전체 Microsoft Sysmon 배포 및 Windows 이벤트 로깅을 위한 모범 사례를 포함하여 Windows endpoint 모니터링을 위한 모범 사례로 구성되었습니다. 이 데이터셋은 트래픽을 캡처하고 웹 프록시 서비스를 제공하는 Palo Alto Networks 차세대 방화벽과 네트워크 기반 IDS를 제공하는 Suricata가 포함되었습니다. 그 결과 아래 데이터세트가 생성되었습니다.</p>

<p><img src="https://wind-flow.github.io/assets/built/images/splunk/bots/v2/b22.jpg" alt="Scenario 2" /></p>

<p>300	According to Frothly’s records, what is the likely MAC address of Mallory’s corporate MacBook? Answer guidance: Her corporate MacBook has the hostname MACLORY-AIR13.<br />
Frothly의 기록에 따르면 Mallory의 회사 MacBook의 MAC 주소는 무엇입니까? 답변 안내: 그녀의 회사 MacBook의 호스트 이름은 MACLORY-AIR13입니다.</p>

<details>
  <summary>hint#1</summary>
    Use Asset Center in ES.<br />
</details>

<p>해당 문제는 현 실습 환경에서 제공되지 않는 Splunk ES에서 확인할 수 있는것으로 문제풀이는 하지않겠습니다.</p>

<p>301	What episode of Game of Thrones is Mallory excited to watch? Answer guidance: Submit the HBO title of the episode.
말로리는 왕좌의 게임의 어떤 에피소드를 보고 싶어 할까요? 답변 안내: 에피소드의 HBO 제목을 제출하세요.</p>

<details>
  <summary>hint#1</summary>
    Look for video files downloaded to MACLORY-AIR13.<br />
    MACLORY-AIR13에 다운로드된 비디오 파일을 찾습니다.
</details>

<p>host가 MACLORY-AIR13인 데이터 중에서 game of thrones, got 등의 키워드로 찾아봅시다.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>host=MACLORY-AIR13 "*game of thrones*" OR "got"
</code></pre></div></div>

<ul>
  <li>결과<br />
<img src="https://wind-flow.github.io/assets/built/images/splunk/bots/v2/2021-10-26-15-24-33.png" alt="" /></li>
</ul>

<p>target_path필드 값은 다음과 같습니다.<br />
<strong>/Users/mallorykraeusen/Downloads/GoT.S7E2.BOTS.BOTS.BOTS.mkv.torrent.</strong></p>

<p>시즌7의 2화의 제목은 Stormborn입니다.</p>

<p><img src="https://wind-flow.github.io/assets/built/images/splunk/bots/v2/2021-10-26-15-27-50.png" alt="" /></p>

<p>답 : Stormborn</p>

<p>302	What is Mallory Krauesen’s phone number? Answer guidance: ddd-ddd-dddd where d=[0-9]. No country code.<br />
Mallory Krauesen의 전화번호는 무엇입니까? 답변 안내: ddd-ddd-dddd 여기서 d=[0-9]. 국가 코드가 없습니다.</p>

<details>
  <summary>hint#1</summary>
    Use Identity Center in ES.  
</details>

<p>해당 문제는 현 실습 환경에서 제공되지 않는 Splunk ES에서 확인할 수 있는것으로 문제풀이는 하지않겠습니다.</p>

<p>303	Enterprise Security contains a threat list notable event for MACLORY-AIR13 and suspect IP address 5.39.93.112. What is the name of the threatlist (i.e. Threat Group) that is triggering the notable?<br />
Enterprise Security에는 MACLORY-AIR13 및 의심되는 IP 주소 5.39.93.112에 대한 주요 이벤트 목록이 포함되어 있습니다. 주목할 만한 것을 유발하는 위협 목록(예: 위협 그룹)의 이름은 무엇입니까?</p>

<details>
  <summary>hint#1</summary>
    Look for threat activity from Mallory's MacBook in the Incident Review dashboard.<br />
    Incident Review 대시보드에서 Mallory의 MacBook에서 위협 활동을 찾습니다.
</details>

<p>해당 문제는 현 실습 환경에서 제공되지 않는 Splunk ES에서 확인할 수 있는것으로 문제풀이는 하지않겠습니다.</p>

<p>304	Considering the threatlist you found in the question above, and related data, what protocol often used for file transfer is actually responsible for the generated traffic?<br />
위의 질문에서 찾은 위협 목록과 관련 데이터를 고려할 때 파일 전송에 자주 사용되는 프로토콜이 실제로 생성된 트래픽을 담당합니까?</p>

<details>
  <summary>hint#1</summary>
    Do you see MACLORY-AIR13 communicating with known Tor addresses? That's misleading.<br />
    알려진 Tor 주소와 통신하는 MACLORY-AIR13이 보입니까? 오해의 소지가 있습니다.
</details>

<p>위 IP에서 특이한 로그가 있는지 살펴봅시다.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>5.39.93.112
</code></pre></div></div>

<p>sourcetype은 <a href="https://docs.paloaltonetworks.com/pan-os/8-1/pan-os-admin/monitoring/use-syslog-for-monitoring/syslog-field-descriptions/traffic-log-fields">pan:traffic</a> 한가지만 있고,
app field에 bittorrent를 찾을 수 있습니다.</p>

<p>답 : bittorrent</p>

<p>305	Mallory’s critical PowerPoint presentation on her MacBook gets encrypted by ransomware on August 18. At what hour, minute, and second does this actually happen? Answer guidance: Provide the time in PDT. Use the 24h format HH:MM:SS, using leading zeroes if needed. Do not use Splunk’s _time (index time).<br />
Mallory Macbook에 있는 중요한 PowerPoint파일이 8월 18일 랜섬웨어에 의해 암호화되었습니다. 몇 시, 분, 초에 발생했습니까 ? 답변 안내: PDT로 시간을 제공합니다. 필요한 경우 선행 0을 사용하여 24시간 형식 HH:MM:SS를 사용합니다. Splunk의 _time(index time)을 사용하지 마십시오.</p>

<details>
  <summary>hint#1</summary>
    People that work on PowerPoint presentations generally save them in their Documents folder.<br />
    PowerPoint 작업을 하는 사람들은 일반적으로 문서 폴더에 프레젠테이션을 저장합니다.
</details>

<details>
  <summary>hint#2</summary>
    The time that Splunk indexed this information might not be the time the file was modified.<br />
    Splunk가 이 정보를 인덱싱한 시간은 파일이 수정된 시간이 아닐 수 있습니다.
</details>

<p>splunk의 _time을 사용하지말라고했으니 해당 로그에 시간과 관련된 필드가 있을것입니다.</p>

<p>우선 탐색 시간을 2017/08/18 00 ~ 2018/08/19 00시로 설정하고, 키워드를 다음과 같이 설정하고 조사해봅니다.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>*mallory* (*.ppt OR *.pptx)
</code></pre></div></div>

<p><img src="https://wind-flow.github.io/assets/built/images/splunk/bots/v2/2021-10-26-16-48-38.png" alt="" /></p>

<p>target_path 필드에 crypt된 파일이 보입니다. 원본 파일 경로와 이름은 /Users/mallorykraeusen/Documents/Frothly_marketing_campaign_Q317.pptx이므로, 해당 키워드로 검색해봅시다.
또, 시간을 알아봐야하니 mac time 관련 데이터를 table 명령어를 사용해 파악해봅시다.
<a href="https://itwiki.kr/w/MAC_Time">MAC TIME이란?</a></p>

<p>- Mtime(modified time) : 파일을 생성한 시간, 또는 가장 최근에 파일 내용을 바꾼 시간<br />
- Atime(accessed time) : 가장 최근에 파일을 읽거나(Read) 실행(Execution)시킨 시간<br />
- Ctime(changed time) : 가장 최근에 파일의 소유권, 그룹, 퍼미션 등 파일의 속성(inode 정보)이 변경된 시간</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sourcetype=osquery_results columns.target_path="/Users/mallorykraeusen/Documents/Frothly_marketing_campaign_Q317.pptx*"
| table _time columns.target_path columns.mtime columns.atime columns.ctime columns.time unixTime
</code></pre></div></div>

<p><a href="https://www.timeanddate.com/time/zones/pdt">PDT(Pacific Daylight Time)란?#1</a><br />
<a href="https://luran.me/339">PDT(Pacific Daylight Time)란?#2</a></p>

<table>
  <thead>
    <tr>
      <th>_time</th>
      <th>columns.target_path</th>
      <th>columns.mtime</th>
      <th>columns.atime</th>
      <th>columns.ctime</th>
      <th>columns.time</th>
      <th>unixTime</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2017/08/18 21:50:43</td>
      <td>/Users/mallorykraeusen/Documents/Frothly_marketing_campaign_Q317.pptx.crypt</td>
      <td>1266652800</td>
      <td>1503093023</td>
      <td>1503093022</td>
      <td>1503093023</td>
      <td>1503093043</td>
    </tr>
    <tr>
      <td>2017/08/18 21:50:43</td>
      <td>/Users/mallorykraeusen/Documents/Frothly_marketing_campaign_Q317.pptx.crypt</td>
      <td>1266652800</td>
      <td>1503093023</td>
      <td>1503093022</td>
      <td>1503093023</td>
      <td>1503093043</td>
    </tr>
    <tr>
      <td>2017/08/18 21:50:43</td>
      <td>/Users/mallorykraeusen/Documents/Frothly_marketing_campaign_Q317.pptx.crypt</td>
      <td>1266652800</td>
      <td>1503093023</td>
      <td>1503093022</td>
      <td>1503093023</td>
      <td>1503093043</td>
    </tr>
    <tr>
      <td>2017/08/18 21:50:43</td>
      <td>/Users/mallorykraeusen/Documents/Frothly_marketing_campaign_Q317.pptx.crypt</td>
      <td>1266652800</td>
      <td>1503093023</td>
      <td>1503093022</td>
      <td>1503093023</td>
      <td>1503093043</td>
    </tr>
    <tr>
      <td>2017/08/18 21:50:43</td>
      <td>/Users/mallorykraeusen/Documents/Frothly_marketing_campaign_Q317.pptx.crypt</td>
      <td>1266652800</td>
      <td>1503093022</td>
      <td>1503093022</td>
      <td>1503093023</td>
      <td>1503093043</td>
    </tr>
    <tr>
      <td>2017/08/18 21:50:43</td>
      <td>/Users/mallorykraeusen/Documents/Frothly_marketing_campaign_Q317.pptx</td>
      <td>-</td>
      <td>-</td>
      <td>-</td>
      <td>1503093023</td>
      <td>1503093043</td>
    </tr>
  </tbody>
</table>

<p>랜섬웨어로 파일이 변경되었으면 권한이 바뀌었으므로 ctime을 기준으로 보면 될것입니다.
ctime : 1503093022</p>

<p><a href="https://time.is/ko/Unix_time_converter">유닉스 타임변환 사이트</a>
<img src="https://wind-flow.github.io/assets/built/images/splunk/bots/v2/2021-10-26-17-28-03.png" alt="" /></p>

<p>PDT는 UTC-7과 같다고 설명되어있습니다.
<img src="https://wind-flow.github.io/assets/built/images/splunk/bots/v2/2021-10-26-17-44-48.png" alt="PDT Time 설명" /></p>

<p>Sat Aug 19 2017 06:50:22 UTC+0900에서 UTC-7로 환산해보면(-16시간)
Sat Aug 18 2017 14:50:22 입니다.</p>

<p>답 : 14:50:22</p>

<p>306	How many seconds elapsed between the time the ransomware executable was written to disk on MACLORY-AIR13 and the first local file encryption? Answer guidance: Use the index times (_time) instead of other timestamps in the events.<br />
MACLORY-AIR13의 디스크에 랜섬웨어 실행 파일이 작성된 시간과 첫 번째 로컬 파일 암호화 사이에 몇 초가 걸렸습니까? 답변 안내: 이벤트의 다른 타임스탬프 대신 인덱스 시간(_time)을 사용하세요.</p>

<details>
  <summary>hint#1</summary>
    What time did the 'Office 2016 Patcher.app' get added to MACLORY-AIR13's filesystem?<br />
    MACLORY-AIR13의 파일 시스템에 'Office 2016 Patcher.app'이 몇시에 추가되었나요?
</details>

<details>
  <summary>hint#2</summary>
    What time was the first file with *.crypt added to MACLORY-AIR13's filesystem?<br />
    MACLORY-AIR13의 파일 시스템에 *.crypt가 추가된 첫 번째 파일은 언제였습니까?
</details>

<p>.crypt가 처음붙은 파일과 MAC의 실행파일 확장자인 .app간 _time의 차를 구해봅시다.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sourcetype=osquery_results host=MACLORY-AIR13 columns.target_path=*.app
| reverse
| table _time columns.target_path
| head 1 ```로컬실행파일
| append 
    [ search sourcetype=osquery_results host=MACLORY-AIR13 columns.target_path=*.crypt
| reverse
| table _time columns.target_path
| head 1```첫 암호화된 로컬 파일]
| transaction maxevents=2
| table columns.target_path duration eventcount
</code></pre></div></div>
<p>※ <a href="https://docs.splunk.com/Documentation/Splunk/8.2.2/SearchReference/Transaction">transaction</a>함수는 이벤트간 시간차이를 duration이라는 변수를 통해 계산해주는 함수입니다.</p>

<table>
  <thead>
    <tr>
      <th>columns.target_path</th>
      <th style="text-align: center">duration</th>
      <th style="text-align: center">eventcount</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>/Users/mallorykraeusen/Desktop/.DS_Store.crypt<br />/Users/mallorykraeusen/Downloads/Office 2016 Patcher.app</td>
      <td style="text-align: center">132</td>
      <td style="text-align: center">2</td>
    </tr>
  </tbody>
</table>

<p>답 : 132</p>

<p>307	Kevin Lagerfield used a USB drive to move malware onto kutekitten, Mallory’s personal MacBook. She ran the malware, which obfuscates itself during execution. Provide the vendor name of the USB drive Kevin likely used. Answer Guidance: Use time correlation to identify the USB drive.<br />
Kevin Lagerfield는 USB 드라이브를 사용하여 Mallory의 개인 MacBook인 kutekitten에 멀웨어를 옮겼습니다. 그녀는 실행 중에 스스로를 난독화하는 맬웨어를 실행했습니다. Kevin이 사용했을 가능성이 있는 USB 드라이브의 공급업체 이름을 제공합니다. 답변 지침: 시간 상관 관계를 사용하여 USB 드라이브를 식별합니다.</p>
<details>
  <summary>hint#1</summary>
    osquery_results is a great sourcetype to review.<br />
    osquery_results에서 찾아보세요.
</details>
<details>
  <summary>hint#2</summary>
    Look for unusual files in a place that Mallory would come across them.<br />
    Mallory가 발견할 수 있는 장소에서 특이한 파일을 찾으십시오.
</details>
<details>
  <summary>hint#3</summary>
    If you can figure out what kind of malware this is, do some open source intelligence research to determine how it behaves. Find an online database of USB vendors.<br />이것이 어떤 종류의 맬웨어인지 알아낼 수 있다면 오픈 소스 인텔리전스 연구를 수행하여 작동 방식을 확인하십시오. USB 공급업체의 온라인 데이터베이스를 찾으십시오.
</details>
<details>
  <summary>hint#4</summary>
    Various sourcetypes can tell you how things look when the run. Look at 'ps' and look at 'osquery_results' from kutekitten.<br />
    다양한 소스 유형은 실행될 때 상황이 어떻게 보이는지 알려줄 수 있습니다. kutekitten의 'ps'와 'osquery_results'를 보세요.    
</details>

<p>해당 정보는 osquery관련 sourcetype에 있을것으로 추측됩니다. <a href="https://github.com/osquery/osquery">osquery</a>는 실행중인 프로세스, 네트워크, 하드웨어 이벤트 등을 포함한 OS의 정보를 쿼리형식으로 질의하여 얻은 값을 갖고 있습니다.</p>

<p>MACBook의 이름인 kutekitten, 그리고 usb를 키워드로 두고, osquery_result에서 조사해봅시다.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sourcetype=osquery_results *kutekitten* *usb*
</code></pre></div></div>

<p>columns.vendor_id라는 필드를 보면 058f, 13fe라는 값이 있습니다.
columns.vendor_id이 있고, USB를 삽입한 데이터만 보도록 합시다.
<img src="https://wind-flow.github.io/assets/built/images/splunk/bots/v2/2021-10-27-13-49-54.png" alt="" /></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sourcetype=osquery_results *kutekitten* *usb* columns.vendor_id=* action=added
</code></pre></div></div>

<p>이벤트 2개가 있습니다. 각 이벤트에 대해 탐색기간을 ±60초로 설정해두고, 어떤 파일을 반입했는지 확인해봅시다.
첫번째로 vendor_id가 058f인 이벤트의 ±60초로 두고 반입된 파일의 hash값을 찾아봅시다.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sourcetype=osquery_results *kutekitten*
</code></pre></div></div>

<p><img src="https://wind-flow.github.io/assets/built/images/splunk/bots/v2/2021-10-27-14-34-51.png" alt="" /></p>

<p>columns.sha256의 hash값을 virustotal에서 조회해봅시다.
<img src="https://wind-flow.github.io/assets/built/images/splunk/bots/v2/2021-10-27-14-34-11.png" alt="sha256" />
sha256 : befa9bfe488244c64db096522b4fad73fc01ea8c4cd0323f1cbdee81ba008271</p>

<p>MAC BackDoor 악성코드입니다.
<img src="https://wind-flow.github.io/assets/built/images/splunk/bots/v2/2021-10-27-14-40-12.png" alt="" /></p>

<p>제조사 13fe의 이벤트도 추가 조사해봅니다.</p>

<p>columns.device의 값이 devfs인것을 보아하니, 파일이 아닌 드라이브임을 알 수 있습니다.
<img src="https://wind-flow.github.io/assets/built/images/splunk/bots/v2/2021-10-27-14-47-18.png" alt="" /></p>

<p>악성코드를 반입한 USB의 제조사의 ID는 058f입니다. 구글에 해당 제조사의 ID를 검색해봅니다.</p>

<p><img src="https://wind-flow.github.io/assets/built/images/splunk/bots/v2/2021-10-27-14-47-46.png" alt="" />
vendorid 058f는 <strong>Alcor Micro Corp.</strong> 입니다.</p>

<p>답 : Alcor</p>

<p>308	What programming language is at least part of the malware from the question above written in?<br />
위의 질문에서 악성 코드의 일부인 프로그래밍 언어는 무엇입니까?</p>

<details>
  <summary>hint#1</summary>
    Review the hints for question 307.<br />
    문제 307에 대한 힌트를 검토하세요.
</details>

<p>문제 307번에서 발견한 악성코드의 sha256 해쉬값은 <strong>befa9bfe488244c64db096522b4fad73fc01ea8c4cd0323f1cbdee81ba008271</strong>입니다.
해당 hash값으로 virustotal에서  자세한 정보를 파악해봅시다.</p>

<p><img src="https://wind-flow.github.io/assets/built/images/splunk/bots/v2/2021-10-27-15-39-44.png" alt="" />
Virustotal의 Detail탭의 FileType을 보면 Perl로 작성된 언어임을 알 수 있습니다.</p>

<p>답 : Perl</p>

<p>309	The malware from the two questions above appears as a specific process name in the process table when it is running. What is it?<br />
위의 두 질문에 대한 맬웨어는 실행 중일 때 프로세스 테이블에 특정 프로세스 이름으로 나타납니다. 그것은 무엇입니까?</p>

<details>
  <summary>hint#1</summary>
    Review the hints for question 307.
</details>

<p>접근방식을 모르겠으니, 아시는분은 제보바랍니다.
답 : java</p>

<p>310	The malware infecting kutekitten uses dynamic DNS destinations to communicate with two C&amp;C servers shortly after installation. What is the fully-qualified domain name (FQDN) of the first (alphabetically) of these destinations?<br />
kutekitten을 감염시키는 악성코드는 설치 직후 2개의 C&amp;C 서버와 통신하기 위해 동적 DNS 대상을 사용합니다. 이러한 대상 중 첫 번째(알파벳 순)의 정규화된 도메인 이름(FQDN)은 무엇입니까?</p>

<details>
  <summary>hint#1</summary>
    Have a look at the stream:dns sourcetype and observe queries from kutekitten.<br />
    stream:dns와 kutekitten이 요청한 쿼리를 보세요.
</details>
<details>
  <summary>hint#2</summary>
    You need a lookup. Find one, and also review this: https://www.splunk.com/blog/2015/08/04/detecting-dynamic-dns-domains-in-splunk.html<br />
    lookup이 필요합니다. https://www.splunk.com/blog/2015/08/04/detecting-dynamic-dns-domains-in-splunk.html를 참고하세요
</details>

<p>virustotal의 Realtions 탭을 보면, <strong>eidk.duckdns.org, eidk.hopto.org</strong> 두개 url이 악성으로 발견되어있습니다.
<img src="https://wind-flow.github.io/assets/built/images/splunk/bots/v2/2021-10-27-16-55-36.png" alt="" /></p>

<p>철자 순서에 의해 답은 eidk.duckdns.org입니다.</p>

<p>답 : eidk.duckdns.org</p>

<p>311	From the question above, what is the fully-qualified domain name (FQDN) of the second (alphabetically) contacted C&amp;C server?<br />
위의 질문에서 두 번째(알파벳순)로 연결된 C&amp;C 서버의 FQDN(정규화된 도메인 이름)은 무엇입니까?</p>

<details>
  <summary>hint#1</summary>
    Review the hints for question 310.
    문제 310에 대한 힌트를 검토하세요.
</details>

<p>답은 eidk.hopto.org 입니다.</p>

<p>답 :  eidk.hopto.org</p>

<p>312	What is the average Alexa 1M rank of the domains between August 18 and August 19 that MACLORY-AIR13 tries to resolve while connected via VPN to the corporate network? Answer guidance: Round to two decimal places. Remember to include domains with no rank in your average! Answer example: 3.23 or 223234.91<br />
8월 18일부터 8월 19일 사이에 MACLORY-AIR13이 VPN을 통해 기업 네트워크에 연결되어 있는 동안 해결하려고 하는 도메인의 평균 Alexa 1M 순위는 얼마입니까? 답변 안내: 소수점 이하 두 자리까지 반올림합니다. 평균에 순위가 없는 도메인을 포함하는 것을 잊지 마십시오! 답변 예: 3.23 또는 223234.91</p>

<details>
  <summary>hint#1</summary>
    You're going to need a lookup. Are there any loaded in the system that might help you?<br />
    조회가 필요합니다. 당신을 도울 수 있는 시스템에 로드된 것이 있습니까?
</details>
<details>
  <summary>hint#2</summary>
    We want the average of ranks. Not the average of hits to the domains.<br />
    우리는 순위의 평균을 원합니다. 도메인에 대한 평균 조회수가 아닙니다.
</details>
<details>
  <summary>hint#3</summary>
    https://www.splunk.com/blog/2016/03/22/splunking-1-million-urls.html
</details>

<p>313	Two .jpg-formatted photos of Mallory exist in Kevin Lagerfield’s server home directory that have eight-character file names, not counting the .jpg extension. Both photos were encrypted by the ransomware. One of the photos can be downloaded at the following link, replacing 8CHARACTERS with the eight characters from the file name. https://splunk.box.com/v/8CHARACTERS After you download the file to your computer, decrypt the file using the encryption key used by the ransomware. What is the complete line of text in the photo, including any punctuation? Answer guidance: The encryption key can be found in Splunk.<br />
.jpg 형식의 Mallory 사진 두 장이 Kevin Lagerfield의 서버 홈 디렉토리에 있으며 .jpg 확장자는 제외하고 파일 이름이 8자로 되어 있습니다. 두 사진 모두 랜섬웨어에 의해 암호화되었습니다. 사진 중 하나는 다음 링크에서 다운로드할 수 있으며 8CHARACTERS를 파일 이름의 8자로 대체합니다. https://splunk.box.com/v/8CHARACTERS 파일을 컴퓨터에 다운로드한 후 랜섬웨어에서 사용하는 암호화 키를 사용하여 파일을 해독합니다. 문장부호를 포함하여 사진의 전체 텍스트 줄은 무엇입니까? 답변 안내: 암호화 키는 Splunk에서 찾을 수 있습니다.</p>

<details>
  <summary>hint#1</summary>
    Understanding from OSINT how this ransomware behaves is key to the answer.<br />
    OSINT에서 이 랜섬웨어가 어떻게 작동하는지 이해하는 것이 답의 핵심입니다.
</details>
<details>
  <summary>hint#2</summary>
    This ransomware is called 'Patcher' and it is terribly written and uses *NIX command line tools to wreak havoc.<br />
    이 랜섬웨어는 '패처'라고 불리며 끔찍하게 작성되었으며 *NIX 명령줄 도구를 사용하여 혼란을 일으키고 있습니다.
</details>
<details>
  <summary>hint#3</summary>
    Patcher uses the UNIX zip utility.<br />
    Patcher는 UNIX zip 유틸리티를 사용합니다.
</details>


                </div>
            </section>

            <!-- Email subscribe form at the bottom of the page -->
            <!-- 
                <section class="subscribe-form">
                    <h3 class="subscribe-form-title">Subscribe to wind-flow Tech Blog</h3>
                    <p>Get the latest posts delivered right to your inbox</p>
                    <span id="searchform" method="post" action="/subscribe/" class="">
    <input class="confirm" type="hidden" name="confirm"  />
    <input class="location" type="hidden" name="location"  />
    <input class="referrer" type="hidden" name="referrer"  />

    <div class="form-group">
        <input class="subscribe-email" onkeyup="myFunc()" 
               id="searchtext" type="text" name="searchtext"  
               placeholder="Search..." />
    </div>
    <script type="text/javascript">
        function myFunc() {
            if(event.keyCode == 13) {
                var url = encodeURIComponent($("#searchtext").val());
                location.href = "/search.html?query=" + url;
            }
        }
    </script>
</span>
                </section>
             -->

            <footer class="post-full-footer">
                <!-- Everything inside the #author tags pulls data from the author -->
                <!-- #author-->
                
                    
                        <section class="author-card">
                            
                                <img class="author-profile-image" src="/assets/images/profile.png" alt="wind-flow" />
                            
                            <section class="author-card-content">
                                <h4 class="author-card-name"><a href="/author/wind-flow">Kim-Gunwoo</a></h4>
                                
                                    <p>Finance Security IT Analyst</p>
                                
                            </section>
                        </section>
                        <div class="post-full-footer-right">
                            <a class="author-card-button" href="/author/wind-flow">Read More</a>
                        </div>
                    
                
                <!-- /author  -->
            </footer>

            <!-- If you use Disqus comments, just uncomment this block.
            The only thing you need to change is "test-apkdzgmqhj" - which
            should be replaced with your own Disqus site-id. -->
            
                <section class="post-full-comments">
                    <div id="disqus_thread"></div>
                    <script>
                        var disqus_config = function () {
                            var this_page_url = 'https://wind-flow.github.io/splunk-BOTS-v2-part3';
                            var this_page_identifier = '/splunk-BOTS-v2-part3';
                            var this_page_title = 'splunk-bots-v2 write up(3)';
                        };
                        (function() {
                            var d = document, s = d.createElement('script');
                            s.src = 'https://xxxxxxxx.disqus.com/embed.js';
                            s.setAttribute('data-timestamp', +new Date());
                            (d.head || d.body).appendChild(s);
                        })();
                    </script>
                </section>
            

        </article>

    </div>
</main>

<!-- Links to Previous/Next posts -->
<aside class="read-next outer">
    <div class="inner">
        <div class="read-next-feed">
            
                
                
                
                
                    <article class="read-next-card"
                        
                            style="background-image: url(/assets/images/sevenpuzzle.jpg)"
                        
                    >
                        <header class="read-next-card-header">
                            <small class="read-next-card-header-sitetitle">&mdash; wind-flow Tech Blog &mdash;</small>
                            
                                <h3 class="read-next-card-header-title"><a href="/tag/splunk/">Splunk</a></h3>
                            
                        </header>
                        <div class="read-next-divider"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 14.5s2 3 5 3 5.5-2.463 5.5-5.5S21 6.5 18 6.5c-5 0-7 11-12 11C2.962 17.5.5 15.037.5 12S3 6.5 6 6.5s4.5 3.5 4.5 3.5"/></svg>
</div>
                        <div class="read-next-card-content">
                            <ul>
                                
                                
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                            <li><a href="/splunk-2021-BOTS-END">splunk 2021 bots 결과</a></li>
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                            <li><a href="/splunk-BOTS-v3-part4">splunk-bots-v3 write up(4) - END</a></li>
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                            <li><a href="/splunk-BOTS-v3-part3">splunk-bots-v3 write up(3)</a></li>
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                            </ul>
                        </div>
                        <footer class="read-next-card-footer">
                            <a href="/tag/splunk/">
                                
                                    See all 12 posts  →
                                
                            </a>
                        </footer>
                    </article>
                
            

            <!-- If there's a next post, display it using the same markup included from - partials/post-card.hbs -->
            
                

    <article class="post-card post-template">
        
            <a class="post-card-image-link" href="/splunk-BOTS-v2-part4">
                <div class="post-card-image" style="background-image: url(/assets/built/images/splunk/bots/v2/bots-v2.jpg)"></div>
            </a>
        
        <div class="post-card-content">
            <a class="post-card-content-link" href="/splunk-BOTS-v2-part4">
                <header class="post-card-header">
                    
                        
                            
                                <span class="post-card-tags">Splunk</span>
                            
                        
                    

                    <h2 class="post-card-title">splunk-bots-v2 write up(4)</h2>
                </header>
                <section class="post-card-excerpt">
                    
                        <p>Splunk BOTS의 데이터셋은 3개입니다. BOTS란? BOTS v1 Write up(1) BOTS v1 Write up(2) - END BOTS v2 Write up(1) BOTS v2 Write up(2) BOTS v2 Write up(3) BOTS v2 Write up(4) BOTS v2</p>
                    
                </section>
            </a>
            <footer class="post-card-meta">
                
                    
                        
                        <img class="author-profile-image" src="/assets/images/profile.png" alt="Kim-Gunwoo" />
                        
                        <span class="post-card-author">
                            <a href="/author/wind-flow/">Kim-Gunwoo</a>
                        </span>
                    
                
                <span class="reading-time">
                    
                    
                      16 min read
                    
                </span>
            </footer>
        </div>
    </article>

            

            <!-- If there's a previous post, display it using the same markup included from - partials/post-card.hbs -->
            
                

    <article class="post-card post-template">
        
            <a class="post-card-image-link" href="/splunk-BOTS-v2-part2">
                <div class="post-card-image" style="background-image: url(/assets/built/images/splunk/bots/v2/bots-v2.jpg)"></div>
            </a>
        
        <div class="post-card-content">
            <a class="post-card-content-link" href="/splunk-BOTS-v2-part2">
                <header class="post-card-header">
                    
                        
                            
                                <span class="post-card-tags">Splunk</span>
                            
                        
                    

                    <h2 class="post-card-title">splunk-bots-v2 write up(2)</h2>
                </header>
                <section class="post-card-excerpt">
                    
                        <p>Splunk BOTS의 데이터셋은 3개입니다. BOTS란? BOTS v1 Write up(1) BOTS v1 Write up(2) - END BOTS v2 Write up(1) BOTS v2 Write up(2) BOTS v2 Write up(3) BOTS v2 Write up(4) BOTS v2</p>
                    
                </section>
            </a>
            <footer class="post-card-meta">
                
                    
                        
                        <img class="author-profile-image" src="/assets/images/profile.png" alt="Kim-Gunwoo" />
                        
                        <span class="post-card-author">
                            <a href="/author/wind-flow/">Kim-Gunwoo</a>
                        </span>
                    
                
                <span class="reading-time">
                    
                    
                      15 min read
                    
                </span>
            </footer>
        </div>
    </article>

            

        </div>
    </div>
</aside>

<!-- Floating header which appears on-scroll, included from includes/floating-header.hbs -->
<div class="floating-header">
    <div class="floating-header-logo">
        <a href="https://wind-flow.github.io/">
            
            <span>wind-flow Tech Blog</span>
        </a>
    </div>
    <span class="floating-header-divider">&mdash;</span>
    <div class="floating-header-title">splunk-bots-v2 write up(3)</div>
    <div class="floating-header-share">
        <div class="floating-header-share-label">Share this <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
    <path d="M7.5 15.5V4a1.5 1.5 0 1 1 3 0v4.5h2a1 1 0 0 1 1 1h2a1 1 0 0 1 1 1H18a1.5 1.5 0 0 1 1.5 1.5v3.099c0 .929-.13 1.854-.385 2.748L17.5 23.5h-9c-1.5-2-5.417-8.673-5.417-8.673a1.2 1.2 0 0 1 1.76-1.605L7.5 15.5zm6-6v2m-3-3.5v3.5m6-1v2"/>
</svg>
</div>
        <a class="floating-header-share-tw" href="https://twitter.com/share?text=splunk-bots-v2+write+up%283%29&amp;url=https://wind-flow.github.io/splunk-BOTS-v2-part3"
            onclick="window.open(this.href, 'share-twitter', 'width=550,height=235');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M30.063 7.313c-.813 1.125-1.75 2.125-2.875 2.938v.75c0 1.563-.188 3.125-.688 4.625a15.088 15.088 0 0 1-2.063 4.438c-.875 1.438-2 2.688-3.25 3.813a15.015 15.015 0 0 1-4.625 2.563c-1.813.688-3.75 1-5.75 1-3.25 0-6.188-.875-8.875-2.625.438.063.875.125 1.375.125 2.688 0 5.063-.875 7.188-2.5-1.25 0-2.375-.375-3.375-1.125s-1.688-1.688-2.063-2.875c.438.063.813.125 1.125.125.5 0 1-.063 1.5-.25-1.313-.25-2.438-.938-3.313-1.938a5.673 5.673 0 0 1-1.313-3.688v-.063c.813.438 1.688.688 2.625.688a5.228 5.228 0 0 1-1.875-2c-.5-.875-.688-1.813-.688-2.75 0-1.063.25-2.063.75-2.938 1.438 1.75 3.188 3.188 5.25 4.25s4.313 1.688 6.688 1.813a5.579 5.579 0 0 1 1.5-5.438c1.125-1.125 2.5-1.688 4.125-1.688s3.063.625 4.188 1.813a11.48 11.48 0 0 0 3.688-1.375c-.438 1.375-1.313 2.438-2.563 3.188 1.125-.125 2.188-.438 3.313-.875z"/></svg>

        </a>
        <a class="floating-header-share-fb" href="https://www.facebook.com/sharer/sharer.php?u=https://wind-flow.github.io/splunk-BOTS-v2-part3"
            onclick="window.open(this.href, 'share-facebook','width=580,height=296');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M19 6h5V0h-5c-3.86 0-7 3.14-7 7v3H8v6h4v16h6V16h5l1-6h-6V7c0-.542.458-1 1-1z"/></svg>

        </a>
    </div>
    <progress class="progress" value="0">
        <div class="progress-container">
            <span class="progress-bar"></span>
        </div>
    </progress>
</div>


<!-- /post -->

<!-- The #contentFor helper here will send everything inside it up to the matching #block helper found in default.hbs -->


        <!-- Previous/next page links - displayed on every page -->
        

        <!-- The footer at the very bottom of the screen -->
        <footer class="site-footer outer">
            <div class="site-footer-content inner">
                <section class="copyright"><a href="https://wind-flow.github.io/">wind-flow Tech Blog</a> &copy; 2022</section>
                <section class="poweredby">Proudly published with <a href="https://jekyllrb.com/">Jekyll</a> &
                    <a href="https://pages.github.com/" target="_blank" rel="noopener">GitHub Pages</a> using
                    <a href="https://github.com/jekyllt/jasper2" target="_blank" rel="noopener">Jasper2</a></section>
                <nav class="site-footer-nav">
                    <a href="/">Latest Posts</a>
                    
                    
                    <a href="https://ghost.org" target="_blank" rel="noopener">Ghost</a>
                </nav>
            </div>
        </footer>

    </div>

    <!-- The big email subscribe modal content -->
    
    <div id="subscribe" class="subscribe-overlay">
        <a class="subscribe-overlay-close" href="#"></a>
        <div class="subscribe-overlay-content">
            
            <h1 class="subscribe-overlay-title">Search wind-flow Tech Blog</h1>
            <p class="subscribe-overlay-description">
            lunr.js를 이용한 posts 검색 </p>
            <span id="searchform" method="post" action="/subscribe/" class="">
    <input class="confirm" type="hidden" name="confirm"  />
    <input class="location" type="hidden" name="location"  />
    <input class="referrer" type="hidden" name="referrer"  />

    <div class="form-group">
        <input class="subscribe-email" onkeyup="myFunc()" 
               id="searchtext" type="text" name="searchtext"  
               placeholder="Search..." />
    </div>
    <script type="text/javascript">
        function myFunc() {
            if(event.keyCode == 13) {
                var url = encodeURIComponent($("#searchtext").val());
                location.href = "/search.html?query=" + url;
            }
        }
    </script>
</span>
        </div>
    </div>
    

    <!-- highlight.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.10.0/components/prism-abap.min.js"></script>
    <script>$(document).ready(function() {
      $('pre code').each(function(i, block) {
        hljs.highlightBlock(block);
      });
    });</script>

    <!-- jQuery + Fitvids, which makes all video embeds responsive -->
    <script
        src="https://code.jquery.com/jquery-3.2.1.min.js"
        integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
        crossorigin="anonymous">
    </script>
    <script type="text/javascript" src="/assets/js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="https://demo.ghost.io/assets/js/jquery.fitvids.js?v=724281a32e"></script>


    <!-- Paginator increased to "infinit" in _config.yml -->
    <!-- if paginator.posts  -->
    <!-- <script>
        var maxPages = parseInt('');
    </script>
    <script src="/assets/js/infinitescroll.js"></script> -->
    <!-- /endif -->

    


    <!-- Add Google Analytics  -->
    <!-- Google Analytics Tracking code -->
 <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-xxxxxxxx-x', 'auto');
  ga('send', 'pageview');

 </script>


    <!-- The #block helper will pull in data from the #contentFor other template files. In this case, there's some JavaScript which we only want to use in post.hbs, but it needs to be included down here, after jQuery has already loaded. -->
    
        <script>

// NOTE: Scroll performance is poor in Safari
// - this appears to be due to the events firing much more slowly in Safari.
//   Dropping the scroll event and using only a raf loop results in smoother
//   scrolling but continuous processing even when not scrolling
$(document).ready(function () {
    // Start fitVids
    var $postContent = $(".post-full-content");
    $postContent.fitVids();
    // End fitVids

    var progressBar = document.querySelector('progress');
    var header = document.querySelector('.floating-header');
    var title = document.querySelector('.post-full-title');

    var lastScrollY = window.scrollY;
    var lastWindowHeight = window.innerHeight;
    var lastDocumentHeight = $(document).height();
    var ticking = false;

    function onScroll() {
        lastScrollY = window.scrollY;
        requestTick();
    }

    function onResize() {
        lastWindowHeight = window.innerHeight;
        lastDocumentHeight = $(document).height();
        requestTick();
    }

    function requestTick() {
        if (!ticking) {
            requestAnimationFrame(update);
        }
        ticking = true;
    }

    function update() {
        var trigger = title.getBoundingClientRect().top + window.scrollY;
        var triggerOffset = title.offsetHeight + 35;
        var progressMax = lastDocumentHeight - lastWindowHeight;

        // show/hide floating header
        if (lastScrollY >= trigger + triggerOffset) {
            header.classList.add('floating-active');
        } else {
            header.classList.remove('floating-active');
        }

        progressBar.setAttribute('max', progressMax);
        progressBar.setAttribute('value', lastScrollY);

        ticking = false;
    }

    window.addEventListener('scroll', onScroll, {passive: true});
    window.addEventListener('resize', onResize, false);

    update();
});
</script>

    

    <!-- Ghost outputs important scripts and data with this tag - it should always be the very last thing before the closing body tag -->
    <!-- ghost_foot -->

</body>
</html>
