<!DOCTYPE html>
<html>
<head>

    <!-- Document Settings -->
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <!-- Base Meta -->
    <!-- dynamically fixing the title for tag/author pages -->



    <title>splunk-bots-v2 write up(1)</title>
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- Styles'n'Scripts -->
    <link rel="stylesheet" type="text/css" href="/assets/built/screen.css" />
    <link rel="stylesheet" type="text/css" href="/assets/built/screen.edited.css" />
    <link rel="stylesheet" type="text/css" href="/assets/built/syntax.css" />

    <!-- custom.css -->
    <link rel="stylesheet" type="text/css" href="/assets/built/custom.css" />

    <!-- 웹 폰트 설정 -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/earlyaccess/nanumgothic.css">

    <!-- awesome icon -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

    <!-- syntax.css -->
    <link rel="stylesheet" href="/assets/built/syntax.css">

    <!-- highlight.js -->
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css">
    <style>.hljs { background: none; }</style>

    <!--[if IE]>
        <style>
            p, ol, ul{
                width: 100%;
            }
            blockquote{
                width: 100%;
            }
        </style>
    <![endif]-->
    
    <!-- This tag outputs SEO meta+structured data and other important settings -->
    <meta name="description" content="wind-flow Tech Blog" />
    <link rel="shortcut icon" href="https://wind-flow.github.io/assets/built/images/wind-flow.png" type="image/png" />
    <link rel="canonical" href="https://wind-flow.github.io/assets/built/images/splunk/bots/v2/2021-10-04-splunk-BOTS-v2-part1" />
    <meta name="referrer" content="no-referrer-when-downgrade" />

     <!--title below is coming from _includes/dynamic_title-->
    <meta property="og:site_name" content="wind-flow Tech Blog" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="splunk-bots-v2 write up(1)" />
    <meta property="og:description" content="{% include bots-table-of-contents.html %} APT Scenarios: In this hands-on exercise, you assume the persona of Alice Bluebird, the analyst who successfully assisted Wayne Enterprises and was recommended to Grace Hoppy at Frothly to assist them with their recent issues. 이 실습에서는 Wayne Enterprises를 성공적으로 지원하고 Frothly의 Grace Hoppy에게 최근 문제를" />
    <meta property="og:url" content="https://wind-flow.github.io/assets/built/images/splunk/bots/v2/2021-10-04-splunk-BOTS-v2-part1" />
    <meta property="og:image" content="https://wind-flow.github.io/assets/built/images/splunk/bots/v2/bots-v2.jpg" />
    <meta property="article:publisher" content="https://www.facebook.com/" />
    <meta property="article:author" content="https://www.facebook.com/" />
    <meta property="article:published_time" content="2021-10-04T23:34:36+09:00" />
    <meta property="article:modified_time" content="2021-10-04T23:34:36+09:00" />
    <meta property="article:tag" content="Splunk" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="splunk-bots-v2 write up(1)" />
    <meta name="twitter:description" content="{% include bots-table-of-contents.html %} APT Scenarios: In this hands-on exercise, you assume the persona of Alice Bluebird, the analyst who successfully assisted Wayne Enterprises and was recommended to Grace Hoppy at Frothly to assist them with their recent issues. 이 실습에서는 Wayne Enterprises를 성공적으로 지원하고 Frothly의 Grace Hoppy에게 최근 문제를" />
    <meta name="twitter:url" content="https://wind-flow.github.io/" />
    <meta name="twitter:image" content="https://wind-flow.github.io/assets/built/images/splunk/bots/v2/bots-v2.jpg" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="wind-flow Tech Blog" />
    <meta name="twitter:label2" content="Filed under" />
    <meta name="twitter:data2" content="Splunk" />
    <meta name="twitter:site" content="@" />
    <meta name="twitter:creator" content="@" />
    <meta property="og:image:width" content="1400" />
    <meta property="og:image:height" content="933" />

    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Website",
    "publisher": {
        "@type": "Organization",
        "name": "wind-flow Tech Blog",
        "logo": "https://wind-flow.github.io/"
    },
    "url": "https://wind-flow.github.io/assets/built/images/splunk/bots/v2/2021-10-04-splunk-BOTS-v2-part1",
    "image": {
        "@type": "ImageObject",
        "url": "https://wind-flow.github.io/assets/built/images/splunk/bots/v2/bots-v2.jpg",
        "width": 2000,
        "height": 666
    },
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://wind-flow.github.io/assets/built/images/splunk/bots/v2/2021-10-04-splunk-BOTS-v2-part1"
    },
    "description": "{% include bots-table-of-contents.html %} APT Scenarios: In this hands-on exercise, you assume the persona of Alice Bluebird, the analyst who successfully assisted Wayne Enterprises and was recommended to Grace Hoppy at Frothly to assist them with their recent issues. 이 실습에서는 Wayne Enterprises를 성공적으로 지원하고 Frothly의 Grace Hoppy에게 최근 문제를"
}
    </script>

    <!-- <script type="text/javascript" src="https://demo.ghost.io/public/ghost-sdk.min.js?v=724281a32e"></script>
    <script type="text/javascript">
    ghost.init({
    	clientId: "ghost-frontend",
    	clientSecret: "f84a07a72b17"
    });
    </script> -->

    <meta name="generator" content="Jekyll 3.6.2" />
    <link rel="alternate" type="application/rss+xml" title="splunk-bots-v2 write up(1)" href="/feed.xml" />


</head>
<body class="post-template">

    <div class="site-wrapper">
        <!-- All the main content gets inserted here, index.hbs, post.hbs, etc -->
        <!-- default -->

<!-- The tag above means: insert everything in this file
into the {body} of the default.hbs template -->

<header class="site-header outer">
    <div class="inner">
        <nav class="site-nav">
    <div class="site-nav-left">
        
            
                <a class="site-nav-logo" href="https://wind-flow.github.io/">wind-flow Tech Blog</a>
            
        
        
            <ul class="nav" role="menu">
  <li class="nav-home" role="menuitem"><a href="/">Home</a></li>
  <li class="nav-about" role="menuitem">
    <a href="/about/">About</a>
  </li>
  <li class="nav-splunk" role="menuitem">
    <a href="/tag/splunk/">splunk</a>
  </li>
  <!-- <li class="nav-python" role="menuitem"><a href="/tag/python/">Python</a></li> -->
  <li class="nav-archive" role="menuitem">
    <a href="/archive.html">All Posts</a>
  </li>
  <li class="nav-archive" role="menuitem">
    <a href="/author_archive.html">Tag별 Posts</a>
  </li>
</ul>

        
    </div>
    <div class="site-nav-right">
        <div class="social-links">
            
            
        </div>
        
            <a class="subscribe-button" href="#subscribe">search</a>
        
    </div>
</nav>

    </div>
</header>

<!-- Everything inside the #post tags pulls data from the post -->
<!-- #post -->

<main id="site-main" class="site-main outer" role="main">
    <div class="inner">

        <article class="post-full  tag-splunk post tag-splunk ">

            <header class="post-full-header">
                <section class="post-full-meta">
                    <time class="post-full-meta-date" datetime=" 4 October 2021"> 4 October 2021</time>
                    
                        <span class="date-divider">/</span>
                        
                            
                               <a href='/tag/splunk/'>SPLUNK</a>
                            
                        
                    
                </section>
                <h1 class="post-full-title">splunk-bots-v2 write up(1)</h1>
            </header>

            <!-- 
            <figure class="post-full-image" style="background-image: url(/assets/built/images/splunk/bots/v2/bots-v2.jpg)">
            </figure>
             -->

            <section class="post-full-content">
                <div class="kg-card-markdown">
                    <p><span class="table-of-contents-list">Splunk BOTS의 데이터셋은 3개입니다.</span></p>
<ul class="table-of-contents-list">
  <li><a href="./splunk-BOTS-overview">BOTS란? </a></li>
  <li><a href="./splunk-BOTS-v1-part1">BOTS v1 Write up(1)</a></li>
  <li><a href="./splunk-BOTS-v1-part2">BOTS v1 Write up(2) - END</a></li>
  <li><a href="./splunk-BOTS-v2-part1">BOTS v2 Write up(1) </a></li>
  <li><a href="./splunk-BOTS-v2-part2">BOTS v2 Write up(2) </a></li>
  <li><a href="./splunk-BOTS-v2-part3">BOTS v2 Write up(3) </a></li>
  <li><a href="./splunk-BOTS-v2-part4">BOTS v2 Write up(4) </a></li>
  <li><a href="./splunk-BOTS-v2-part5">BOTS v2 Write up(5) - END</a></li>
  <li><a href="./splunk-BOTS-v3-part1">BOTS v3 Write up(1)</a></li>
  <li><a href="./splunk-BOTS-v3-part2">BOTS v3 Write up(2)</a></li>
  <li><a href="./splunk-BOTS-v3-part3">BOTS v3 Write up(3)</a></li>
  <li><a href="./splunk-BOTS-v3-part4">BOTS v3 Write up(4) - END</a></li>
  <li><a href="./splunk-2021-BOTS-END">BOTS v4 결과</a></li>
</ul>

<p>APT Scenarios:</p>

<p>In this hands-on exercise, you assume the persona of Alice Bluebird, the analyst who successfully assisted Wayne Enterprises and was recommended to Grace Hoppy at Frothly to assist them with their recent issues.<br />
이 실습에서는 Wayne Enterprises를 성공적으로 지원하고 Frothly의 Grace Hoppy에게 최근 문제를 지원하도록 추천된 분석가 Alice Bluebird의 페르소나를 가정합니다.</p>

<p>Hunting Scenarios:</p>

<p>PowerShell: Adversaries will use PowerShell Empire to establish a foothold and carry out attacks.<br />
PowerShell: 적들은 PowerShell Empire를 사용하여 거점을 구축하고 공격을 수행합니다.<br />
Exfiltration Over Alternative Protocol - FTP: Data Exfiltration may occur using common network protocols, principally FTP<br />
Exfiltration Over Alternative Protocol - FTP: 데이터 유출은 주로 FTP와 같은 일반적인 네트워크 프로토콜을 사용하여 발생할 수 있습니다.<br />
Exfiltration Over Alternative Protocol - DNS: Data Exfiltration may occur using common network protocols, specifically DNS<br />
Exfiltration Over Alternative Protocol - DNS: 데이터 유출은 일반적인 네트워크 프로토콜, 특히 DNS를 사용하여 발생할 수 있습니다.<br />
Adversary Infrastructure: The adversary has established multiple components of infrastructure beyond what we have already uncovered.<br />
Adversary Infrastructure: 적군은 우리가 이미 밝혀낸 것 이상의 기반 시설의 여러 구성 요소를 구축했습니다.<br />
Spearphishing Attachment: Adversaries will attempt to establish a foothold within Froth.ly using Phishing.<br />
Spearphishing Attachment: 적들은 피싱을 사용하여 Froth.ly 내에 거점을 구축하려고 시도합니다.<br />
User Execution: Adversaries will attempt to establish a foothold within Froth.ly by enticing a user to execute an action on a file.<br />
User Execution: 공격자는 사용자가 파일에 대해 작업을 실행하도록 유인하여 Froth.ly 내에서 거점을 설정하려고 시도합니다.<br />
Persistence - Create Account: An adversary will look to maintain persistence across an enterprise by creating user accounts.<br />
Persistence - Create Account: 공격자는 사용자 계정을 생성하여 기업 전체에서 지속성을 유지하려고 합니다.<br />
Persistence - Scheduled Task: An adversary will look to maintain persistence across reboots by using a task scheduler.<br />
Persistence - Scheduled Task: 공격자는 작업 스케줄러를 사용하여 재부팅 시 지속성을 유지하려고 합니다.<br />
Indicator Removal On Host: Clearing of audit / event logs could indicate an adversary attempting to cover their tracks.<br />
Indicator Removal On Host: 감사/이벤트 로그를 지우면 공격자가 자신의 흔적을 덮으려는 것을 나타낼 수 있습니다.<br />
Reconaissance: User Agent Strings may provide insight into an adversary that they may not have intended to show.<br />
Reconaissance: 사용자 에이전트 문자열은 의도하지 않은 적에 대한 통찰력을 제공할 수 있습니다.
OSINT: Identifying publicly available company information and who is accessing it may provide insight into the adversary.<br />
OSINT: 공개적으로 사용 가능한 회사 정보와 해당 정보에 액세스하는 사람을 식별하면 적에 대한 통찰력을 제공할 수 있습니다.<br />
Lateral Movement: Adversaries will look to move laterally to other systems using Windows Management Instrumentation (WMI).<br />
Lateral Movement: 공격자는 WMI(Windows Management Instrumentation)를 사용하여 측면으로 다른 시스템으로 이동합니다.<br />
Data Staging: Adversaries will stage data prior to exfiltration to make it easier to extract data at a time of their choosing as well as have a central place to place information as it is identified.<br />
Data Staging: 공격자는 데이터 유출 전에 데이터를 준비하여 원하는 시간에 데이터를 쉽게 추출할 수 있을 뿐만 아니라 식별된 정보를 배치할 중앙 위치를 확보합니다.</p>

<p><img src="https://wind-flow.github.io/assets/built/images/splunk/bots/v2/b21.jpg" alt="Scenario 1" /></p>

<p>The data included in this app was generated in August of 2017 by members of Splunk’s Security Specialist team - Dave Herrald, Ryan Kovar, Steve Brant, Jim Apger, John Stoner, Ken Westin, David Veuve and James Brodsky. They stood up a few lab environments connected to the Internet. Within the environment they had a few Windows endpoints instrumented with the Splunk Universal Forwarder and Splunk Stream. The forwarders were configured with best practices for Windows endpoint monitoring, including a full Microsoft Sysmon deployment and best practices for Windows Event logging. The environment included a Palo Alto Networks next-generation firewall to capture traffic and provide web proxy services, and Suricata to provide network-based IDS. This resulted in the dataset below.<br />
이 앱에 포함된 데이터는 2017년 8월 Splunk의 보안 전문가 팀(Dave Herrald, Ryan Kovar, Steve Brant, Jim Apger, John Stoner, Ken Westin, David Veuve 및 James Brodsky)이 생성한 것입니다. 그들은 인터넷에 연결된 몇 개의 실험 환경을 구축했습니다. 환경 내에는 Splunk Universal Forwarder 및 Splunk Stream으로 계측된 몇 개의 Windows 엔드포인트가 있었습니다. Forwarder는 전체 Microsoft Sysmon 배포 및 Windows 이벤트 로깅을 위한 모범 사례를 포함하여 Windows endpoint 모니터링을 위한 모범 사례로 구성되었습니다. 이 데이터셋은 트래픽을 캡처하고 웹 프록시 서비스를 제공하는 Palo Alto Networks 차세대 방화벽과 네트워크 기반 IDS를 제공하는 Suricata가 포함되었습니다. 그 결과 아래 데이터세트가 생성되었습니다.</p>

<p><img src="https://wind-flow.github.io/assets/built/images/splunk/bots/v2/b22.jpg" alt="Scenario 2" /></p>

<p>100	Amber Turing was hoping for Frothly to be acquired by a potential competitor which fell through, but visited their website to find contact information for their executive team. What is the website domain that she visited? Answer guidance: Do not provide the FQDN. Answer example: google.com<br />
Amber Turing은 Frothly가 잠재적인 경쟁업체에 인수되기를 바랐지만, 웹사이트를 방문하여 경영진의 연락처를 찾았습니다. 그녀가 방문한 웹사이트 도메인은 무엇입니까? 주의 : 답은 FQDN형태가 아닙니다. 답변 예시: google.com</p>

<details>
  <summary>hint#1</summary>
    Look at Amber's web traffic.<br />
    Amber의 웹 트래픽을 보십시오.
</details>

<details>
  <summary>hint#2</summary>
    Find Amber's hostname and find the IP address that she was most likely using. Then look at the stream:http sourcetype.<br />
    Amber의 호스트 이름을 찾고 그녀가 사용했을 가능성이 가장 높은 IP 주소를 찾습니다. 그런 다음 stream:http 소스 유형을 보십시오.
</details>

<details>
  <summary>hint#3</summary>
    Take a look at src_ip=10.0.2.101 and the stream:http sourcetype. Look at the websites that Amber visited over the month of August.<br />
    src_ip=10.0.2.101 및 stream:http 소스 유형을 살펴보십시오. Amber가 8월 한 달 동안 방문한 웹사이트를 보십시오
</details>

<p>Amber Turing의 IP를 파악하고, stream:http에서 해당 IP가 src인 url을 확인해보면 될것입니다.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Amber Turing
</code></pre></div></div>

<p>src칼럼을 보면 10.0.4.4와 10.0.2.101의 이벤트 수가 가장 많습니다.</p>

<p>두가지 모두 src필드로 검색해보면, 10.0.4.4는 stream:smb에서 찾을 수 있는데, amber의 이름이 filename에 포함되어있습니다.
한편, 10.0.2.101는 sourcetype pan:traffic에서 출발지가 frothly\amber.turing인 데이터를 보아, amber turing의 IP는 10.0.2.101입니다.</p>

<p>frothly의 경쟁회사라고 했으니, 해당 기업의 산업을 찾아봅니다.
<img src="https://wind-flow.github.io/assets/built/images/splunk/bots/v2/2021-10-21-09-54-13.png" alt="frothly" />
frothly는 맥주제조회사임을 알 수 있습니다.</p>

<p>src=10.0.2.101를 두고, http로그를 조사해봅니다. 추가로, 방문한 웹사이트니 method를 GET으로 두어 탐색범위를 줄입시다.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>src=10.0.2.101 sourcetype=stream:http http_method=GET
| stats count by site
</code></pre></div></div>

<table>
  <thead>
    <tr>
      <th>site</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>uranus.frothly.local:8014</td>
      <td>593</td>
    </tr>
    <tr>
      <td>img-s-msn-com.akamaized.net</td>
      <td>353</td>
    </tr>
    <tr>
      <td>crl.microsoft.com</td>
      <td>86</td>
    </tr>
    <tr>
      <td>clienttemplates.content.office.net</td>
      <td>69</td>
    </tr>
    <tr>
      <td>redirector.gvt1.com</td>
      <td>39</td>
    </tr>
    <tr>
      <td>www.finnegan.com</td>
      <td>24</td>
    </tr>
    <tr>
      <td>ping.chartbeat.net</td>
      <td>18</td>
    </tr>
    <tr>
      <td>www1.folha.uol.com.br</td>
      <td>18</td>
    </tr>
    <tr>
      <td>classificados1.folha.uol.com.br</td>
      <td>13</td>
    </tr>
    <tr>
      <td>static-hp-wus-s-msn-com.akamaized.net</td>
      <td>12</td>
    </tr>
    <tr>
      <td>www.berkbeer.com</td>
      <td>12</td>
    </tr>
    <tr>
      <td>www.bing.com</td>
      <td>12</td>
    </tr>
    <tr>
      <td>ocsp.digicert.com</td>
      <td>11</td>
    </tr>
  </tbody>
</table>

<p>site 중 berkbeer.com가 눈에 보입니다. forthly도 맥주회사니, berkbeer가 Ambur가 방문한 경쟁회사의 사이트는 berkbeer.com입니다.</p>

<p>답 : berkbeer.com</p>

<p>101	Amber found the executive contact information and sent him an email. What is the CEO’s name? Provide the first and last name.<br />
Amber는 임원 연락처 정보를 찾아 이메일을 보냈습니다. CEO의 이름은 무엇입니까? 이름과 성을 제공하십시오.</p>

<details>
  <summary>hint#1</summary>
    Look for emails to Amber Turing.<br />
    Amber Turing에게 보내는 이메일주소를 찾으세요.
</details>

<details>
  <summary>hint#2</summary>
    Find emails from aturing that were sent to the domain from question 100.<br />
    문제 100번에서 도메인으로 보낸 aturing의 이메일 찾아보세요.
</details>
<details>
  <summary>hint#3</summary>
    Look at the sourcetype=stream:smtp and filter on the sender=aturing@froth.ly and/or recipient=aturing@froth.ly. Look at the content and body of emails that have something to do with competitors. The name of the CEO should be in the email.<br />
    sourcetype=stream:smtp를 보고 sender=aturing@froth.ly 및/또는 recipient=aturing@froth.ly를 필터링합니다. 경쟁자와 관련이 있는 이메일의 내용과 본문을 살펴보십시오. CEO의 이름은 이메일에 있어야 합니다.
</details>

<p>이메일 관련 데이터는 sourcetype stream:smtp에 있을것입니다.
송수신자의 도메인이 forthly.ly, berkbeer.com인 데이터를 찾아봅시다.</p>

<p>우선 amber turing의 이메일주소를 찾아봅니다.</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sourcetype=stream:smtp amber turing
</code></pre></div></div>
<p>sender필드를 보면 Amber Turing <a href="mailto:aturing@froth.ly">aturing@froth.ly</a>인것으로 보아 amber의 이메일주소는 
aturing@froth.ly 입니다.</p>

<p>receiver의 도메인주소가 @berkbeer.com를 찾고, 메일 본문에 CEO란 단어가 있을것입니다.
키워드에 CEO를 추가합시다.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sourcetype=stream:smtp aturing@froth.ly @berkbeer.com ceo
| reverse
</code></pre></div></div>

<p>위 쿼리로 검색하면, content필드에 아래의 내용을 볼 수 있다.<br />
 Hello Amber,=C2=A0=0A=0AGreat to hear from you, yes it is unfortunate th=
e way things turned=0Aout. It would be great to speak with you directly,=
 I would also like=0Ato have Bernhard on the call as I think he might ha=
ve some questions=0Afor you. =C2=A0Give me a call this afternoon if you=
 are free.=C2=A0=0A=0A<strong>Martin Berk=0ACEO</strong>=0A777.222.8765=0Amberk@berkbeer.=
com=0A=0A—– Original Message —–=0AFrom: “Amber Turing” &lt;aturing@fr=
oth.ly&gt;=0ATo:”mberk@berkbeer.com” <a href="mailto:mberk@berkbeer.com">mberk@berkbeer.com</a>=0ACc:=0ASent:Fri,=
 11 Aug 2017 15:49:01 +0000=0ASubject:Amber from Froth.ly=0A=0A=09Mr. Be=
rnhard,=0A=0A=09=C2=A0=C2=A0 I was very sorry to hear about the acquisit=
ion falling through.=0AI was very excited to work with you in the future=
.. I have to admit, I=0Aam a little worried about my future here. I=E2=80=
=99d love to talk to you=0Aabout some information I have regarding my wo=
rk.=0A=0A Amber Turing=0A Principal Scientist=0A 867.322.1123=0A Froth.l=
y=0A=0A=09</p>

<p>smtp의 데이터는 base64로 인코딩되는 경우가 많습니다.
5번째줄을 보면 Martin Berk CEO의 내용이 있습니다.</p>

<p>답 : Martin Berk</p>

<p>102	After the initial contact with the CEO, Amber contacted another employee at this competitor. What is that employee’s email address?<br />
CEO와 처음 연락한 후 Amber는 이 경쟁업체의 다른 직원에게 연락했습니다. 그 직원의 이메일 주소는 무엇입니까?</p>

<details>
  <summary>hint#1</summary>
  Look at Amber's email traffic.<br />
  Amber의 이메일 트래픽을 보세요.
</details>

<details>
  <summary>hint#2</summary>
  Find the last email from the domain in question 100.<br />
  100번 문제의 도메인에서 보낸 마지막 이메일을 찾습니다.
</details>

<p>Martin Berk의 이메일 주소는 mberk@berkbeer.com입니다.<br />
mberk의 이메일 대화를 파악하면 다른직원의 이메일 주소를 알 수 있을것입니다.</p>

<p>전 문제에서 파악한 메일의 내용을 다시 봅시다.</p>

<p>Hello Amber,=C2=A0=0A=0AGreat to hear from you, yes it is unfortunate th=
e way things turned=0Aout. It would be great to speak with you directly,=
 I would also like=0Ato have Bernhard on the call as I think he might ha=
ve some questions=0Afor you. =C2=A0Give me a call this afternoon if you=
 are free.=C2=A0=0A=0AMartin Berk=0ACEO=0A777.222.8765=0Amberk@berkbeer.=
com=0A=0A—– Original Message —–=0AFrom: “Amber Turing” &lt;aturing@fr=
oth.ly&gt;=0ATo:”mberk@berkbeer.com” <a href="mailto:mberk@berkbeer.com">mberk@berkbeer.com</a>=0ACc:=0ASent:Fri,=
 11 Aug 2017 15:49:01 +0000=0ASubject:Amber from Froth.ly=0A=0A=09<strong>Mr. Be=
rnhard</strong>,=0A=0A=09=C2=A0=C2=A0 I was very sorry to hear about the acquisit=
ion falling through.=0AI was very excited to work with you in the future=
.. I have to admit, I=0Aam a little worried about my future here. I=E2=80=
=99d love to talk to you=0Aabout some information I have regarding my wo=
rk.=0A=0A Amber Turing=0A Principal Scientist=0A 867.322.1123=0A Froth.l=
y=0A=0A=09</p>

<p>언뜻 지나가기 쉽지만 Mr. Bernhard에게 질문하라는 내용이 있습니다.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sourcetype=stream:smtp amber bernhard
</code></pre></div></div>

<p>위 쿼리 결과에서 메일을 읽기전에 receiver 필드에 어떤 내용이 있는지 파악해봅시다.</p>

<p><img src="https://wind-flow.github.io/assets/built/images/splunk/bots/v2/2021-10-21-15-35-13.png" alt="receiver" /></p>

<p>bernhard의 이메일을 찾을 수 있습니다.</p>

<p>답 : hbernhard@berkbeer.com</p>

<p>103	What is the name of the file attachment that Amber sent to a contact at the competitor?<br />
Amber가 경쟁업체 연락처에 보낸 첨부 파일 이름은 무엇입니까?</p>
<details>
  <summary>hint#1</summary>
  Look for emails sent from Amber Turing.<br />
  Amber Turing이 보낸 이메일을 찾습니다.
</details>

<details>
  <summary>hint#2</summary>
  Look for aturing@froth.ly sending email to the address listed in question 102.<br />
  문제 102에 나열된 주소로 이메일을 보내는 aturing@froth.ly를 찾으십시오.
</details>

<details>
  <summary>hint#3</summary>
  Search sourcetype=stream:smtp sender=aturing@froth.ly and find the attachment she sent.<br />
  sourcetype=stream:smtp sender=aturing@froth.ly를 검색하고 그녀가 보낸 첨부 파일을 찾습니다.
</details>

<p>sender가 aturing@froth.ly이고, receiver의 도메인이 berkbeer.com인 데이터 중 attach_file관련 필드의 값을 확인해 봅시다.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sourcetype=stream:smtp sender_email=aturing@froth.ly receiver_email{}=*@berkbeer.com
</code></pre></div></div>
<p>해당 결과의 attach_filename{}이라는 필드에 값이 한개만 존재하는걸 알 수 있습니다.</p>

<p><img src="https://wind-flow.github.io/assets/built/images/splunk/bots/v2/2021-10-21-15-55-05.png" alt="attach_filename" /></p>

<p>답 : Saccharomyces_cerevisiae_patent.docx</p>

<p>104	What is Amber’s personal email address?<br />
Amber의 개인 이메일주소는 무엇입니까 ?</p>

<details>
  <summary>hint#1</summary>
  Look for emails sent from Amber Turing.
  Amber Turing이 보낸 이메일을 찾습니다.
</details>
<details>
  <summary>hint#2</summary>
  Review the body of emails that Amber has sent.
  Amber가 보낸 이메일 본문을 검토합니다.
</details>
<details>
  <summary>hint#3</summary>
  Review the email with base64-encoded text for body (or content) and decode the base64.
  본문(또는 콘텐츠)에 대해 base64로 인코딩된 텍스트가 포함된 이메일을 검토하고 base64를 디코딩합니다.
</details>

<p>계속해서 amber와 bern의 대화를 파악해 봅시다.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sourcetype=stream:smtp aturing@froth.ly hbernhard@berkbeer.com
</code></pre></div></div>

<p>둘이 나눈 마지막 content의 내용을 보면 base64코드로 보이는 내용을 발견할 수 있습니다. 이것을 decode 해보면 Amber의 개인 이메일주소를 파악할 수 있습니다.</p>

<ul>
  <li>
    <p>base64 인코딩<br />
VGhhbmtzIGZvciB0YWtpbmcgdGhlIHRpbWUgdG9kYXksIEFzIGRpc2N1c3NlZCBoZXJlIGlzIHRo
ZSBkb2N1bWVudCBJIHdhcyByZWZlcnJpbmcgdG8uICBQcm9iYWJseSBiZXR0ZXIgdG8gdGFrZSB0
aGlzIG9mZmxpbmUuIEVtYWlsIG1lIGZyb20gbm93IG9uIGF0IGFtYmVyc3RoZWJlc3RAeWVhc3Rp
ZWJlYXN0aWUuY29tPG1haWx0bzphbWJlcnN0aGViZXN0QHllYXN0aWViZWFzdGllLmNvbT4NCg0K
RnJvbTogaGJlcm5oYXJkQGJlcmtiZWVyLmNvbTxtYWlsdG86aGJlcm5oYXJkQGJlcmtiZWVyLmNv
bT4gW21haWx0bzpoYmVybmhhcmRAYmVya2JlZXIuY29tXQ0KU2VudDogRnJpZGF5LCBBdWd1c3Qg
MTEsIDIwMTcgOTowOCBBTQ0KVG86IEFtYmVyIFR1cmluZyA8YXR1cmluZ0Bmcm90aC5seTxtYWls
dG86YXR1cmluZ0Bmcm90aC5seT4+DQpTdWJqZWN0OiBIZWlueiBCZXJuaGFyZCBDb250YWN0IElu
Zm9ybWF0aW9uDQoNCkhlbGxvIEFtYmVyLA0KDQpHcmVhdCB0YWxraW5nIHdpdGggeW91IHRvZGF5
LCBoZXJlIGlzIG15IGNvbnRhY3QgaW5mb3JtYXRpb24uIERvIHlvdSBoYXZlIGEgcGVyc29uYWwg
ZW1haWwgSSBjYW4gcmVhY2ggeW91IGF0IGFzIHdlbGw/DQoNClRoYW5rIFlvdQ0KDQpIZWlueiBC
ZXJuaGFyZA0KaGVybmhhcmRAYmVya2JlZXIuY29tPG1haWx0bzpoZXJuaGFyZEBiZXJrYmVlci5j
b20+DQo4NjUuODg4Ljc1NjMNCg0K</p>
  </li>
  <li>
    <p>base64 디코딩<br />
Thanks for taking the time today, As discussed here is the document I was referring to.  Probably better to take this offline. Email me from now on at ambersthebest@yeastiebeastie.com&lt;mailto:ambersthebest@yeastiebeastie.com&gt;</p>
  </li>
</ul>

<p>From: hbernhard@berkbeer.com<a href="mailto:hbernhard@berkbeer.com">hbernhard@berkbeer.com</a> [mailto:hbernhard@berkbeer.com]<br />
Sent: Friday, August 11, 2017 9:08 AM<br />
To: Amber Turing &lt;aturing@froth.ly<a href="mailto:aturing@froth.ly">aturing@froth.ly</a>&gt;<br />
Subject: Heinz Bernhard Contact Information</p>

<p>Hello Amber,</p>

<p>Great talking with you today, here is my contact information. Do you have a personal email I can reach you at as well?</p>

<p>Thank You</p>

<p>Heinz Bernhard<br />
hernhard@berkbeer.com<a href="mailto:hernhard@berkbeer.com">hernhard@berkbeer.com</a><br />
865.888.7563</p>

<p>디코딩 내용에 amber의 개인 이메일주소를 발견할 수 있습니다.</p>

<p>답 : ambersthebest@yeastiebeastie.com</p>

<p>105	What version of TOR did Amber install to obfuscate her web browsing? Answer guidance: Numeric with one or more delimiter.<br />
Amber는 웹 브라우징을 난독화하기 위해 어떤 버전의 TOR를 설치했습니까? 답변 안내: 하나 이상의 구분 기호가 있는 숫자.</p>

<p>TOR 설치관련 이벤트는 sysmon에 있을것입니다.
keyword를 amber와 tor를 두고 검색해 봅시다.
(ParentCommandLine과 Commandline에 tor가 포함될것으로 예상됩니다.)</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sourcetype="XmlWinEventLog:Microsoft-Windows-Sysmon/Operational" CommandLine=*tor* ParentCommandLine=*tor* Amber
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;Event xmlns='http://schemas.microsoft.com/win/2004/08/events/event'&gt;&lt;System&gt;&lt;Provider Name='Microsoft-Windows-Sysmon' Guid='{5770385F-C22A-43E0-BF4C-06F5698FFBD9}'/&gt;&lt;EventID&gt;1&lt;/EventID&gt;&lt;Version&gt;5&lt;/Version&gt;&lt;Level&gt;4&lt;/Level&gt;&lt;Task&gt;1&lt;/Task&gt;&lt;Opcode&gt;0&lt;/Opcode&gt;&lt;Keywords&gt;0x8000000000000000&lt;/Keywords&gt;&lt;TimeCreated SystemTime='2017-08-24T04:20:44.276520600Z'/&gt;&lt;EventRecordID&gt;118559&lt;/EventRecordID&gt;&lt;Correlation/&gt;&lt;Execution ProcessID='900' ThreadID='1824'/&gt;&lt;Channel&gt;Microsoft-Windows-Sysmon/Operational&lt;/Channel&gt;&lt;Computer&gt;wrk-aturing.frothly.local&lt;/Computer&gt;&lt;Security UserID='S-1-5-18'/&gt;&lt;/System&gt;&lt;EventData&gt;&lt;Data Name='UtcTime'&gt;2017-08-24 04:20:44.260&lt;/Data&gt;&lt;Data Name='ProcessGuid'&gt;{B2E0DF5E-9CF4-598C-0000-00103B38CC01}&lt;/Data&gt;&lt;Data Name='ProcessId'&gt;2252&lt;/Data&gt;&lt;Data Name='Image'&gt;C:\Users\amber.turing\Desktop\Tor Browser\Browser\firefox.exe&lt;/Data&gt;&lt;Data Name='CommandLine'&gt;"C:\Users\amber.turing\Desktop\Tor Browser\Browser\firefox.exe" &lt;/Data&gt;&lt;Data Name='CurrentDirectory'&gt;C:\Users\amber.turing\Desktop\Tor Browser\Browser\&lt;/Data&gt;&lt;Data Name='User'&gt;FROTHLY\amber.turing&lt;/Data&gt;&lt;Data Name='LogonGuid'&gt;{B2E0DF5E-B9C1-598B-0000-0020ED760900}&lt;/Data&gt;&lt;Data Name='LogonId'&gt;0x976ed&lt;/Data&gt;&lt;Data Name='TerminalSessionId'&gt;1&lt;/Data&gt;&lt;Data Name='IntegrityLevel'&gt;Medium&lt;/Data&gt;&lt;Data Name='Hashes'&gt;SHA1=82EEBDA7E828142E1FA55066D793D29FB81B48C5&lt;/Data&gt;&lt;Data Name='ParentProcessGuid'&gt;{B2E0DF5E-9CDF-598C-0000-00101AF3CB01}&lt;/Data&gt;&lt;Data Name='ParentProcessId'&gt;4536&lt;/Data&gt;&lt;Data Name='ParentImage'&gt;C:\Users\amber.turing\Downloads\torbrowser-install-7.0.4_en-US.exe&lt;/Data&gt;&lt;Data Name='ParentCommandLine'&gt;"C:\Users\amber.turing\Downloads\torbrowser-install-7.0.4_en-US.exe" &lt;/Data&gt;&lt;/EventData&gt;&lt;/Event&gt;
</code></pre></div></div>
<p>tor 설치파일의 이름과 경로를 찾을 수 있었습니다.
C:\Users\amber.turing\Downloads\torbrowser-install-7.0.4_en-US.exe</p>

<p>답 : 7.0.4</p>

                </div>
            </section>

            <!-- Email subscribe form at the bottom of the page -->
            <!-- 
                <section class="subscribe-form">
                    <h3 class="subscribe-form-title">Subscribe to wind-flow Tech Blog</h3>
                    <p>Get the latest posts delivered right to your inbox</p>
                    <span id="searchform" method="post" action="/subscribe/" class="">
    <input class="confirm" type="hidden" name="confirm"  />
    <input class="location" type="hidden" name="location"  />
    <input class="referrer" type="hidden" name="referrer"  />

    <div class="form-group">
        <input class="subscribe-email" onkeyup="myFunc()" 
               id="searchtext" type="text" name="searchtext"  
               placeholder="Search..." />
    </div>
    <script type="text/javascript">
        function myFunc() {
            if(event.keyCode == 13) {
                var url = encodeURIComponent($("#searchtext").val());
                location.href = "/search.html?query=" + url;
            }
        }
    </script>
</span>
                </section>
             -->

            <footer class="post-full-footer">
                <!-- Everything inside the #author tags pulls data from the author -->
                <!-- #author-->
                
                    
                        <section class="author-card">
                            
                                <img class="author-profile-image" src="/assets/images/profile.png" alt="wind-flow" />
                            
                            <section class="author-card-content">
                                <h4 class="author-card-name"><a href="/author/wind-flow">Kim-Gunwoo</a></h4>
                                
                                    <p>Finance Security IT Analyst</p>
                                
                            </section>
                        </section>
                        <div class="post-full-footer-right">
                            <a class="author-card-button" href="/author/wind-flow">Read More</a>
                        </div>
                    
                
                <!-- /author  -->
            </footer>

            <!-- If you use Disqus comments, just uncomment this block.
            The only thing you need to change is "test-apkdzgmqhj" - which
            should be replaced with your own Disqus site-id. -->
            
                <section class="post-full-comments">
                    <div id="disqus_thread"></div>
                    <script>
                        var disqus_config = function () {
                            var this_page_url = 'https://wind-flow.github.io/assets/built/images/splunk/bots/v2/2021-10-04-splunk-BOTS-v2-part1';
                            var this_page_identifier = '';
                            var this_page_title = 'splunk-bots-v2 write up(1)';
                        };
                        (function() {
                            var d = document, s = d.createElement('script');
                            s.src = 'https://xxxxxxxx.disqus.com/embed.js';
                            s.setAttribute('data-timestamp', +new Date());
                            (d.head || d.body).appendChild(s);
                        })();
                    </script>
                </section>
            

        </article>

    </div>
</main>

<!-- Links to Previous/Next posts -->
<aside class="read-next outer">
    <div class="inner">
        <div class="read-next-feed">
            
                
                
                
                
                    <article class="read-next-card"
                        
                            style="background-image: url(/assets/images/sevenpuzzle.jpg)"
                        
                    >
                        <header class="read-next-card-header">
                            <small class="read-next-card-header-sitetitle">&mdash; wind-flow Tech Blog &mdash;</small>
                            
                                <h3 class="read-next-card-header-title"><a href="/tag/splunk/">Splunk</a></h3>
                            
                        </header>
                        <div class="read-next-divider"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 14.5s2 3 5 3 5.5-2.463 5.5-5.5S21 6.5 18 6.5c-5 0-7 11-12 11C2.962 17.5.5 15.037.5 12S3 6.5 6 6.5s4.5 3.5 4.5 3.5"/></svg>
</div>
                        <div class="read-next-card-content">
                            <ul>
                                
                                
                                  
                                
                                  
                                    
                                        
                                        
                                            <li><a href="/splunk-2021-BOTS-END">splunk 2021 bots 결과</a></li>
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                            <li><a href="/splunk-2021-BOTS-END-copy">splunk 2021 bots 결과</a></li>
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                            <li><a href="/splunk-BOTS-v3-part4">splunk-bots-v3 write up(4) - END</a></li>
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                            </ul>
                        </div>
                        <footer class="read-next-card-footer">
                            <a href="/tag/splunk/">
                                
                                    See all 13 posts  →
                                
                            </a>
                        </footer>
                    </article>
                
            

            <!-- If there's a next post, display it using the same markup included from - partials/post-card.hbs -->
            

            <!-- If there's a previous post, display it using the same markup included from - partials/post-card.hbs -->
            

        </div>
    </div>
</aside>

<!-- Floating header which appears on-scroll, included from includes/floating-header.hbs -->
<div class="floating-header">
    <div class="floating-header-logo">
        <a href="https://wind-flow.github.io/">
            
            <span>wind-flow Tech Blog</span>
        </a>
    </div>
    <span class="floating-header-divider">&mdash;</span>
    <div class="floating-header-title">splunk-bots-v2 write up(1)</div>
    <div class="floating-header-share">
        <div class="floating-header-share-label">Share this <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
    <path d="M7.5 15.5V4a1.5 1.5 0 1 1 3 0v4.5h2a1 1 0 0 1 1 1h2a1 1 0 0 1 1 1H18a1.5 1.5 0 0 1 1.5 1.5v3.099c0 .929-.13 1.854-.385 2.748L17.5 23.5h-9c-1.5-2-5.417-8.673-5.417-8.673a1.2 1.2 0 0 1 1.76-1.605L7.5 15.5zm6-6v2m-3-3.5v3.5m6-1v2"/>
</svg>
</div>
        <a class="floating-header-share-tw" href="https://twitter.com/share?text=splunk-bots-v2+write+up%281%29&amp;url=https://wind-flow.github.io/assets/built/images/splunk/bots/v2/2021-10-04-splunk-BOTS-v2-part1"
            onclick="window.open(this.href, 'share-twitter', 'width=550,height=235');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M30.063 7.313c-.813 1.125-1.75 2.125-2.875 2.938v.75c0 1.563-.188 3.125-.688 4.625a15.088 15.088 0 0 1-2.063 4.438c-.875 1.438-2 2.688-3.25 3.813a15.015 15.015 0 0 1-4.625 2.563c-1.813.688-3.75 1-5.75 1-3.25 0-6.188-.875-8.875-2.625.438.063.875.125 1.375.125 2.688 0 5.063-.875 7.188-2.5-1.25 0-2.375-.375-3.375-1.125s-1.688-1.688-2.063-2.875c.438.063.813.125 1.125.125.5 0 1-.063 1.5-.25-1.313-.25-2.438-.938-3.313-1.938a5.673 5.673 0 0 1-1.313-3.688v-.063c.813.438 1.688.688 2.625.688a5.228 5.228 0 0 1-1.875-2c-.5-.875-.688-1.813-.688-2.75 0-1.063.25-2.063.75-2.938 1.438 1.75 3.188 3.188 5.25 4.25s4.313 1.688 6.688 1.813a5.579 5.579 0 0 1 1.5-5.438c1.125-1.125 2.5-1.688 4.125-1.688s3.063.625 4.188 1.813a11.48 11.48 0 0 0 3.688-1.375c-.438 1.375-1.313 2.438-2.563 3.188 1.125-.125 2.188-.438 3.313-.875z"/></svg>

        </a>
        <a class="floating-header-share-fb" href="https://www.facebook.com/sharer/sharer.php?u=https://wind-flow.github.io/assets/built/images/splunk/bots/v2/2021-10-04-splunk-BOTS-v2-part1"
            onclick="window.open(this.href, 'share-facebook','width=580,height=296');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M19 6h5V0h-5c-3.86 0-7 3.14-7 7v3H8v6h4v16h6V16h5l1-6h-6V7c0-.542.458-1 1-1z"/></svg>

        </a>
    </div>
    <progress class="progress" value="0">
        <div class="progress-container">
            <span class="progress-bar"></span>
        </div>
    </progress>
</div>


<!-- /post -->

<!-- The #contentFor helper here will send everything inside it up to the matching #block helper found in default.hbs -->


        <!-- Previous/next page links - displayed on every page -->
        

        <!-- The footer at the very bottom of the screen -->
        <footer class="site-footer outer">
            <div class="site-footer-content inner">
                <section class="copyright"><a href="https://wind-flow.github.io/">wind-flow Tech Blog</a> &copy; 2022</section>
                <section class="poweredby">Proudly published with <a href="https://jekyllrb.com/">Jekyll</a> &
                    <a href="https://pages.github.com/" target="_blank" rel="noopener">GitHub Pages</a> using
                    <a href="https://github.com/jekyllt/jasper2" target="_blank" rel="noopener">Jasper2</a></section>
                <nav class="site-footer-nav">
                    <a href="/">Latest Posts</a>
                    
                    
                    <a href="https://ghost.org" target="_blank" rel="noopener">Ghost</a>
                </nav>
            </div>
        </footer>

    </div>

    <!-- The big email subscribe modal content -->
    
    <div id="subscribe" class="subscribe-overlay">
        <a class="subscribe-overlay-close" href="#"></a>
        <div class="subscribe-overlay-content">
            
            <h1 class="subscribe-overlay-title">Search wind-flow Tech Blog</h1>
            <p class="subscribe-overlay-description">
            lunr.js를 이용한 posts 검색 </p>
            <span id="searchform" method="post" action="/subscribe/" class="">
    <input class="confirm" type="hidden" name="confirm"  />
    <input class="location" type="hidden" name="location"  />
    <input class="referrer" type="hidden" name="referrer"  />

    <div class="form-group">
        <input class="subscribe-email" onkeyup="myFunc()" 
               id="searchtext" type="text" name="searchtext"  
               placeholder="Search..." />
    </div>
    <script type="text/javascript">
        function myFunc() {
            if(event.keyCode == 13) {
                var url = encodeURIComponent($("#searchtext").val());
                location.href = "/search.html?query=" + url;
            }
        }
    </script>
</span>
        </div>
    </div>
    

    <!-- highlight.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.10.0/components/prism-abap.min.js"></script>
    <script>$(document).ready(function() {
      $('pre code').each(function(i, block) {
        hljs.highlightBlock(block);
      });
    });</script>

    <!-- jQuery + Fitvids, which makes all video embeds responsive -->
    <script
        src="https://code.jquery.com/jquery-3.2.1.min.js"
        integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
        crossorigin="anonymous">
    </script>
    <script type="text/javascript" src="/assets/js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="https://demo.ghost.io/assets/js/jquery.fitvids.js?v=724281a32e"></script>


    <!-- Paginator increased to "infinit" in _config.yml -->
    <!-- if paginator.posts  -->
    <!-- <script>
        var maxPages = parseInt('');
    </script>
    <script src="/assets/js/infinitescroll.js"></script> -->
    <!-- /endif -->

    


    <!-- Add Google Analytics  -->
    <!-- Google Analytics Tracking code -->
 <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-xxxxxxxx-x', 'auto');
  ga('send', 'pageview');

 </script>


    <!-- The #block helper will pull in data from the #contentFor other template files. In this case, there's some JavaScript which we only want to use in post.hbs, but it needs to be included down here, after jQuery has already loaded. -->
    
        <script>

// NOTE: Scroll performance is poor in Safari
// - this appears to be due to the events firing much more slowly in Safari.
//   Dropping the scroll event and using only a raf loop results in smoother
//   scrolling but continuous processing even when not scrolling
$(document).ready(function () {
    // Start fitVids
    var $postContent = $(".post-full-content");
    $postContent.fitVids();
    // End fitVids

    var progressBar = document.querySelector('progress');
    var header = document.querySelector('.floating-header');
    var title = document.querySelector('.post-full-title');

    var lastScrollY = window.scrollY;
    var lastWindowHeight = window.innerHeight;
    var lastDocumentHeight = $(document).height();
    var ticking = false;

    function onScroll() {
        lastScrollY = window.scrollY;
        requestTick();
    }

    function onResize() {
        lastWindowHeight = window.innerHeight;
        lastDocumentHeight = $(document).height();
        requestTick();
    }

    function requestTick() {
        if (!ticking) {
            requestAnimationFrame(update);
        }
        ticking = true;
    }

    function update() {
        var trigger = title.getBoundingClientRect().top + window.scrollY;
        var triggerOffset = title.offsetHeight + 35;
        var progressMax = lastDocumentHeight - lastWindowHeight;

        // show/hide floating header
        if (lastScrollY >= trigger + triggerOffset) {
            header.classList.add('floating-active');
        } else {
            header.classList.remove('floating-active');
        }

        progressBar.setAttribute('max', progressMax);
        progressBar.setAttribute('value', lastScrollY);

        ticking = false;
    }

    window.addEventListener('scroll', onScroll, {passive: true});
    window.addEventListener('resize', onResize, false);

    update();
});
</script>

    

    <!-- Ghost outputs important scripts and data with this tag - it should always be the very last thing before the closing body tag -->
    <!-- ghost_foot -->

</body>
</html>
